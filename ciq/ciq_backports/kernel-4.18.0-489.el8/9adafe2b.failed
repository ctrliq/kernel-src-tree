net/sched: move struct tc_mqprio_qopt_offload from pkt_cls.h to pkt_sched.h

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-489.el8
commit-author Vladimir Oltean <vladimir.oltean@nxp.com>
commit 9adafe2b85460be5b9bed9b6f6597526e7d4f7c5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-489.el8/9adafe2b.failed

Since mqprio is a scheduler and not a classifier, move its offload
structure to pkt_sched.h, where struct tc_taprio_qopt_offload also lies.

Also update some header inclusions in drivers that access this
structure, to the best of my abilities.

	Cc: Igor Russkikh <irusskikh@marvell.com>
	Cc: Yisen Zhuang <yisen.zhuang@huawei.com>
	Cc: Salil Mehta <salil.mehta@huawei.com>
	Cc: Jesse Brandeburg <jesse.brandeburg@intel.com>
	Cc: Tony Nguyen <anthony.l.nguyen@intel.com>
	Cc: Thomas Petazzoni <thomas.petazzoni@bootlin.com>
	Cc: Saeed Mahameed <saeedm@nvidia.com>
	Cc: Leon Romanovsky <leon@kernel.org>
	Cc: Horatiu Vultur <horatiu.vultur@microchip.com>
	Cc: Lars Povlsen <lars.povlsen@microchip.com>
	Cc: Steen Hegelund <Steen.Hegelund@microchip.com>
	Cc: Daniel Machon <daniel.machon@microchip.com>
	Cc: UNGLinuxDriver@microchip.com
	Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
	Reviewed-by: Simon Horman <simon.horman@corigine.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 9adafe2b85460be5b9bed9b6f6597526e7d4f7c5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/aquantia/atlantic/aq_main.c
#	drivers/net/ethernet/hisilicon/hns3/hnae3.h
#	drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
#	drivers/net/ethernet/marvell/mvneta.c
#	drivers/net/ethernet/microchip/lan966x/lan966x_tc.c
#	drivers/net/ethernet/microchip/sparx5/sparx5_tc.c
#	drivers/net/ethernet/ti/cpsw_priv.c
#	include/net/pkt_sched.h
diff --cc drivers/net/ethernet/aquantia/atlantic/aq_main.c
index b12547be4c25,0b2a52199914..000000000000
--- a/drivers/net/ethernet/aquantia/atlantic/aq_main.c
+++ b/drivers/net/ethernet/aquantia/atlantic/aq_main.c
@@@ -20,6 -21,8 +20,11 @@@
  #include <linux/ip.h>
  #include <linux/udp.h>
  #include <net/pkt_cls.h>
++<<<<<<< HEAD
++=======
+ #include <net/pkt_sched.h>
+ #include <linux/filter.h>
++>>>>>>> 9adafe2b8546 (net/sched: move struct tc_mqprio_qopt_offload from pkt_cls.h to pkt_sched.h)
  
  MODULE_LICENSE("GPL v2");
  MODULE_AUTHOR(AQ_CFG_DRV_AUTHOR);
diff --cc drivers/net/ethernet/hisilicon/hns3/hnae3.h
index bc3d111a2ba9,40f4306449eb..000000000000
--- a/drivers/net/ethernet/hisilicon/hns3/hnae3.h
+++ b/drivers/net/ethernet/hisilicon/hns3/hnae3.h
@@@ -34,7 -28,11 +34,12 @@@
  #include <linux/module.h>
  #include <linux/netdevice.h>
  #include <linux/pci.h>
 -#include <linux/pkt_sched.h>
  #include <linux/types.h>
++<<<<<<< HEAD
++=======
+ #include <net/pkt_cls.h>
+ #include <net/pkt_sched.h>
++>>>>>>> 9adafe2b8546 (net/sched: move struct tc_mqprio_qopt_offload from pkt_cls.h to pkt_sched.h)
  
  #define HNAE3_MOD_VERSION "1.0"
  
diff --cc drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
index 1bcb15016986,25be7f8ac7cd..000000000000
--- a/drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
+++ b/drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
@@@ -15,12 -13,17 +15,17 @@@
  #include <linux/ipv6.h>
  #include <linux/module.h>
  #include <linux/pci.h>
 -#include <linux/aer.h>
  #include <linux/skbuff.h>
  #include <linux/sctp.h>
 +#include <linux/vermagic.h>
  #include <net/gre.h>
 -#include <net/gro.h>
 -#include <net/ip6_checksum.h>
  #include <net/pkt_cls.h>
++<<<<<<< HEAD
++=======
+ #include <net/pkt_sched.h>
+ #include <net/tcp.h>
++>>>>>>> 9adafe2b8546 (net/sched: move struct tc_mqprio_qopt_offload from pkt_cls.h to pkt_sched.h)
  #include <net/vxlan.h>
 -#include <net/geneve.h>
  
  #include "hnae3.h"
  #include "hns3_enet.h"
diff --cc drivers/net/ethernet/marvell/mvneta.c
index 5584fb3d2e1d,a48588c80317..000000000000
--- a/drivers/net/ethernet/marvell/mvneta.c
+++ b/drivers/net/ethernet/marvell/mvneta.c
@@@ -36,6 -37,9 +36,12 @@@
  #include <net/ip.h>
  #include <net/ipv6.h>
  #include <net/tso.h>
++<<<<<<< HEAD
++=======
+ #include <net/page_pool.h>
+ #include <net/pkt_sched.h>
+ #include <linux/bpf_trace.h>
++>>>>>>> 9adafe2b8546 (net/sched: move struct tc_mqprio_qopt_offload from pkt_cls.h to pkt_sched.h)
  
  /* Registers */
  #define MVNETA_RXQ_CONFIG_REG(q)                (0x1400 + ((q) << 2))
diff --cc include/net/pkt_sched.h
index 99db7ffeb471,6c5e64e0a0bb..000000000000
--- a/include/net/pkt_sched.h
+++ b/include/net/pkt_sched.h
@@@ -150,6 -160,20 +150,23 @@@ struct tc_etf_qopt_offload 
  	s32 queue;
  };
  
++<<<<<<< HEAD
++=======
+ struct tc_mqprio_qopt_offload {
+ 	/* struct tc_mqprio_qopt must always be the first element */
+ 	struct tc_mqprio_qopt qopt;
+ 	u16 mode;
+ 	u16 shaper;
+ 	u32 flags;
+ 	u64 min_rate[TC_QOPT_MAX_QUEUE];
+ 	u64 max_rate[TC_QOPT_MAX_QUEUE];
+ };
+ 
+ struct tc_taprio_caps {
+ 	bool supports_queue_max_sdu:1;
+ };
+ 
++>>>>>>> 9adafe2b8546 (net/sched: move struct tc_mqprio_qopt_offload from pkt_cls.h to pkt_sched.h)
  struct tc_taprio_sched_entry {
  	u8 command; /* TC_TAPRIO_CMD_* */
  
* Unmerged path drivers/net/ethernet/microchip/lan966x/lan966x_tc.c
* Unmerged path drivers/net/ethernet/microchip/sparx5/sparx5_tc.c
* Unmerged path drivers/net/ethernet/ti/cpsw_priv.c
* Unmerged path drivers/net/ethernet/aquantia/atlantic/aq_main.c
diff --git a/drivers/net/ethernet/chelsio/cxgb4/cxgb4_tc_mqprio.h b/drivers/net/ethernet/chelsio/cxgb4/cxgb4_tc_mqprio.h
index be96f1dc0372..d4a862a9fd7d 100644
--- a/drivers/net/ethernet/chelsio/cxgb4/cxgb4_tc_mqprio.h
+++ b/drivers/net/ethernet/chelsio/cxgb4/cxgb4_tc_mqprio.h
@@ -4,7 +4,7 @@
 #ifndef __CXGB4_TC_MQPRIO_H__
 #define __CXGB4_TC_MQPRIO_H__
 
-#include <net/pkt_cls.h>
+#include <net/pkt_sched.h>
 
 #define CXGB4_EOSW_TXQ_DEFAULT_DESC_NUM 128
 
* Unmerged path drivers/net/ethernet/hisilicon/hns3/hnae3.h
* Unmerged path drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
diff --git a/drivers/net/ethernet/intel/i40e/i40e.h b/drivers/net/ethernet/intel/i40e/i40e.h
index 60e351665c70..38c341b9f368 100644
--- a/drivers/net/ethernet/intel/i40e/i40e.h
+++ b/drivers/net/ethernet/intel/i40e/i40e.h
@@ -33,6 +33,7 @@
 #include <linux/net_tstamp.h>
 #include <linux/ptp_clock_kernel.h>
 #include <net/pkt_cls.h>
+#include <net/pkt_sched.h>
 #include <net/tc_act/tc_gact.h>
 #include <net/tc_act/tc_mirred.h>
 #include <net/udp_tunnel.h>
diff --git a/drivers/net/ethernet/intel/iavf/iavf.h b/drivers/net/ethernet/intel/iavf/iavf.h
index 23bc000e77b8..232bc61d9eee 100644
--- a/drivers/net/ethernet/intel/iavf/iavf.h
+++ b/drivers/net/ethernet/intel/iavf/iavf.h
@@ -30,6 +30,7 @@
 #include <linux/jiffies.h>
 #include <net/ip6_checksum.h>
 #include <net/pkt_cls.h>
+#include <net/pkt_sched.h>
 #include <net/udp.h>
 #include <net/tc_act/tc_gact.h>
 #include <net/tc_act/tc_mirred.h>
diff --git a/drivers/net/ethernet/intel/ice/ice.h b/drivers/net/ethernet/intel/ice/ice.h
index a556792d4223..5a1c38345094 100644
--- a/drivers/net/ethernet/intel/ice/ice.h
+++ b/drivers/net/ethernet/intel/ice/ice.h
@@ -40,6 +40,7 @@
 #include <linux/cpu_rmap.h>
 #include <linux/dim.h>
 #include <net/pkt_cls.h>
+#include <net/pkt_sched.h>
 #include <net/tc_act/tc_mirred.h>
 #include <net/tc_act/tc_gact.h>
 #include <net/ip.h>
* Unmerged path drivers/net/ethernet/marvell/mvneta.c
diff --git a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index 4aa25b8de879..387a2d1312ee 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@ -38,6 +38,7 @@
 #include <linux/if_bridge.h>
 #include <linux/filter.h>
 #include <net/page_pool.h>
+#include <net/pkt_sched.h>
 #include <net/xdp_sock_drv.h>
 #include "eswitch.h"
 #include "en.h"
* Unmerged path drivers/net/ethernet/microchip/lan966x/lan966x_tc.c
* Unmerged path drivers/net/ethernet/microchip/sparx5/sparx5_tc.c
* Unmerged path drivers/net/ethernet/ti/cpsw_priv.c
diff --git a/include/net/pkt_cls.h b/include/net/pkt_cls.h
index f8f471cb3608..d2ed754d596a 100644
--- a/include/net/pkt_cls.h
+++ b/include/net/pkt_cls.h
@@ -757,16 +757,6 @@ struct tc_cls_bpf_offload {
 	bool exts_integrated;
 };
 
-struct tc_mqprio_qopt_offload {
-	/* struct tc_mqprio_qopt must always be the first element */
-	struct tc_mqprio_qopt qopt;
-	u16 mode;
-	u16 shaper;
-	u32 flags;
-	u64 min_rate[TC_QOPT_MAX_QUEUE];
-	u64 max_rate[TC_QOPT_MAX_QUEUE];
-};
-
 /* This structure holds cookie structure that is passed from user
  * to the kernel for actions and classifiers
  */
* Unmerged path include/net/pkt_sched.h
