ata: libata-core: Do not try to set sleeping devices to standby

jira LE-2157
Rebuild_History Non-Buildable kernel-5.14.0-503.14.1.el9_5
commit-author Damien Le Moal <dlemoal@kernel.org>
commit 4b085736e44dbbe69b5eea1a8a294f404678a1f4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-5.14.0-503.14.1.el9_5/4b085736.failed

In ata ata_dev_power_set_standby(), check that the target device is not
sleeping. If it is, there is no need to do anything.

Fixes: aa3998dbeb3a ("ata: libata-scsi: Disable scsi device manage_system_start_stop")
	Cc: stable@vger.kernel.org
	Signed-off-by: Damien Le Moal <dlemoal@kernel.org>
	Signed-off-by: Niklas Cassel <cassel@kernel.org>
(cherry picked from commit 4b085736e44dbbe69b5eea1a8a294f404678a1f4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/ata/libata-core.c
diff --cc drivers/ata/libata-core.c
index a2f2ba6b5019,d9f80f4f70f5..000000000000
--- a/drivers/ata/libata-core.c
+++ b/drivers/ata/libata-core.c
@@@ -1993,8 -2017,8 +1993,13 @@@ void ata_dev_power_set_standby(struct a
  	struct ata_taskfile tf;
  	unsigned int err_mask;
  
++<<<<<<< HEAD
 +	/* Issue STANDBY IMMEDIATE command only if supported by the device */
 +	if (dev->class != ATA_DEV_ATA && dev->class != ATA_DEV_ZAC)
++=======
+ 	/* If the device is already sleeping, do nothing. */
+ 	if (dev->flags & ATA_DFLAG_SLEEPING)
++>>>>>>> 4b085736e44d (ata: libata-core: Do not try to set sleeping devices to standby)
  		return;
  
  	/*
* Unmerged path drivers/ata/libata-core.c
