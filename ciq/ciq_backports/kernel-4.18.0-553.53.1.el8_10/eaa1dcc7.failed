platform/x86: dell-wmi-sysman: Cleanup sysman_init() error-exit handling

jira LE-3064
Rebuild_History Non-Buildable kernel-4.18.0-553.53.1.el8_10
commit-author Hans de Goede <hdegoede@redhat.com>
commit eaa1dcc79694674494620ee62098b937ef758df8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.53.1.el8_10/eaa1dcc7.failed

Cleanup sysman_init() error-exit handling:

1. There is no need for the fail_reset_bios and fail_authentication_kset
   eror-exit cases, these can be handled by release_attributes_data()

2. Rename all the labels from fail_what_failed, to err_what_to_cleanup
   this is the usual way to name these and avoids the need to rename
   them when extra steps are added.

Fixes: e8a60aa7404b ("platform/x86: Introduce support for Systems Management Driver over WMI for Dell Systems")
	Cc: Divya Bharathi <Divya_Bharathi@dell.com>
	Cc: Mario Limonciello <mario.limonciello@dell.com>
	Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Link: https://lore.kernel.org/r/20210321115901.35072-6-hdegoede@redhat.com
(cherry picked from commit eaa1dcc79694674494620ee62098b937ef758df8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/platform/x86/dell-wmi-sysman/sysman.c
diff --cc drivers/platform/x86/dell-wmi-sysman/sysman.c
index 641f87850439,99dc2f3bdf49..000000000000
--- a/drivers/platform/x86/dell-wmi-sysman/sysman.c
+++ b/drivers/platform/x86/dell-wmi-sysman/sysman.c
@@@ -512,14 -514,14 +512,14 @@@ static int __init sysman_init(void
  	ret = init_bios_attr_pass_interface();
  	if (ret || !wmi_priv.password_attr_wdev) {
  		pr_debug("failed to initialize pass interface\n");
- 		goto fail_pass_interface;
+ 		goto err_exit_bios_attr_set_interface;
  	}
  
 -	ret = class_register(&firmware_attributes_class);
 +	ret = fw_attributes_class_get(&fw_attr_class);
  	if (ret)
- 		goto fail_class;
+ 		goto err_exit_bios_attr_pass_interface;
  
 -	wmi_priv.class_dev = device_create(&firmware_attributes_class, NULL, MKDEV(0, 0),
 +	wmi_priv.class_dev = device_create(fw_attr_class, NULL, MKDEV(0, 0),
  				  NULL, "%s", DRIVER_NAME);
  	if (IS_ERR(wmi_priv.class_dev)) {
  		ret = PTR_ERR(wmi_priv.class_dev);
@@@ -572,34 -574,21 +572,41 @@@
  
  	return 0;
  
- fail_create_group:
+ err_release_attributes_data:
  	release_attributes_data();
  
++<<<<<<< HEAD:drivers/platform/x86/dell-wmi-sysman/sysman.c
 +fail_reset_bios:
 +	if (wmi_priv.authentication_dir_kset) {
 +		kset_unregister(wmi_priv.authentication_dir_kset);
 +		wmi_priv.authentication_dir_kset = NULL;
 +	}
 +
 +fail_authentication_kset:
 +	if (wmi_priv.main_dir_kset) {
 +		kset_unregister(wmi_priv.main_dir_kset);
 +		wmi_priv.main_dir_kset = NULL;
 +	}
 +
 +fail_main_kset:
 +	device_destroy(fw_attr_class, MKDEV(0, 0));
 +
 +fail_classdev:
 +	fw_attributes_class_put();
++=======
+ err_destroy_classdev:
+ 	device_destroy(&firmware_attributes_class, MKDEV(0, 0));
+ 
+ err_unregister_class:
+ 	class_unregister(&firmware_attributes_class);
++>>>>>>> eaa1dcc79694 (platform/x86: dell-wmi-sysman: Cleanup sysman_init() error-exit handling):drivers/platform/x86/dell/dell-wmi-sysman/sysman.c
  
- fail_class:
+ err_exit_bios_attr_pass_interface:
  	exit_bios_attr_pass_interface();
  
- fail_pass_interface:
+ err_exit_bios_attr_set_interface:
  	exit_bios_attr_set_interface();
  
- fail_set_interface:
  	return ret;
  }
  
* Unmerged path drivers/platform/x86/dell-wmi-sysman/sysman.c
