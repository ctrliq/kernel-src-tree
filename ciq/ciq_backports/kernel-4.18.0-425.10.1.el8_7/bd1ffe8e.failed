ice: return ENOSPC when exceeding ICE_MAX_CHAIN_WORDS

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-425.10.1.el8_7
commit-author Wojciech Drewek <wojciech.drewek@intel.com>
commit bd1ffe8e5df4e24fc637d85b01f40e282c29856d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-425.10.1.el8_7/bd1ffe8e.failed

When number of words exceeds ICE_MAX_CHAIN_WORDS, -ENOSPC
should be returned not -EINVAL. Do not overwrite this
error code in ice_add_tc_flower_adv_fltr.

	Signed-off-by: Wojciech Drewek <wojciech.drewek@intel.com>
	Suggested-by: Marcin Szycik <marcin.szycik@linux.intel.com>
	Acked-by: Maciej Fijalkowski <maciej.fijalkowski@intel.com>
	Tested-by: Sandeep Penigalapati <sandeep.penigalapati@intel.com>
	Signed-off-by: Tony Nguyen <anthony.l.nguyen@intel.com>
(cherry picked from commit bd1ffe8e5df4e24fc637d85b01f40e282c29856d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/ice/ice_switch.c
diff --cc drivers/net/ethernet/intel/ice/ice_switch.c
index 309bf07c29ba,9f0a4dfb4818..000000000000
--- a/drivers/net/ethernet/intel/ice/ice_switch.c
+++ b/drivers/net/ethernet/intel/ice/ice_switch.c
@@@ -5508,16 -5992,14 +5508,24 @@@ ice_add_adv_rule(struct ice_hw *hw, str
  				word_cnt++;
  	}
  
- 	if (!word_cnt || word_cnt > ICE_MAX_CHAIN_WORDS)
+ 	if (!word_cnt)
  		return -EINVAL;
  
++<<<<<<< HEAD
 +	/* make sure that we can locate a dummy packet */
 +	ice_find_dummy_packet(lkups, lkups_cnt, rinfo->tun_type, &pkt, &pkt_len,
 +			      &pkt_offsets);
 +	if (!pkt) {
 +		status = -EINVAL;
 +		goto err_ice_add_adv_rule;
 +	}
++=======
+ 	if (word_cnt > ICE_MAX_CHAIN_WORDS)
+ 		return -ENOSPC;
+ 
+ 	/* locate a dummy packet */
+ 	profile = ice_find_dummy_packet(lkups, lkups_cnt, rinfo->tun_type);
++>>>>>>> bd1ffe8e5df4 (ice: return ENOSPC when exceeding ICE_MAX_CHAIN_WORDS)
  
  	if (!(rinfo->sw_act.fltr_act == ICE_FWD_TO_VSI ||
  	      rinfo->sw_act.fltr_act == ICE_FWD_TO_Q ||
* Unmerged path drivers/net/ethernet/intel/ice/ice_switch.c
diff --git a/drivers/net/ethernet/intel/ice/ice_tc_lib.c b/drivers/net/ethernet/intel/ice/ice_tc_lib.c
index fedc310c376c..fb4128434a95 100644
--- a/drivers/net/ethernet/intel/ice/ice_tc_lib.c
+++ b/drivers/net/ethernet/intel/ice/ice_tc_lib.c
@@ -578,7 +578,6 @@ ice_add_tc_flower_adv_fltr(struct ice_vsi *vsi,
 	} else if (ret) {
 		NL_SET_ERR_MSG_MOD(tc_fltr->extack,
 				   "Unable to add filter due to error");
-		ret = -EIO;
 		goto exit;
 	}
 
