net/mlx5e: Claim TC hw offloads support only under a proper build config

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-80.el8
commit-author Or Gerlitz <ogerlitz@mellanox.com>
commit 077ecd785d90c6cbba08d719faa4be8561aa0a1e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-80.el8/077ecd78.failed

Currently, we are only supporting tc hw offloads when the eswitch
support is compiled in, but we are not gating the adevertizment
of the NETIF_F_HW_TC feature on this config being set.

Fix it, and while doing that, also avoid dealing with the feature
on ethtool when the config is not set.

Fixes: e8f887ac6a45 ('net/mlx5e: Introduce tc offload support')
	Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com>
	Reviewed-by: Roi Dayan <roid@mellanox.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit 077ecd785d90c6cbba08d719faa4be8561aa0a1e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_main.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index 11fe75e05d5e,fb3b2d9c352b..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@@ -4673,8 -4682,10 +4677,14 @@@ static void mlx5e_build_nic_netdev(stru
  	    FT_CAP(modify_root) &&
  	    FT_CAP(identified_miss_table_mode) &&
  	    FT_CAP(flow_table_modify)) {
+ #ifdef CONFIG_MLX5_ESWITCH
  		netdev->hw_features      |= NETIF_F_HW_TC;
++<<<<<<< HEAD
 +#ifdef CONFIG_RFS_ACCEL
++=======
+ #endif
+ #ifdef CONFIG_MLX5_EN_ARFS
++>>>>>>> 077ecd785d90 (net/mlx5e: Claim TC hw offloads support only under a proper build config)
  		netdev->hw_features	 |= NETIF_F_NTUPLE;
  #endif
  	}
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_main.c
