net: stmmac: fix NPD with phylink_set_pcs if there is no MDIO bus

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-477.10.1.el8_8
commit-author Vladimir Oltean <vladimir.oltean@nxp.com>
commit b55b1d50b08ce3b79329f62da8104b25c607bf38
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-477.10.1.el8_8/b55b1d50.failed

priv->plat->mdio_bus_data is optional, some platforms may not set it,
however we proceed to look straight at priv->plat->mdio_bus_data->has_xpcs.

Since the xpcs is instantiated based on the has_xpcs property, we can
avoid looking at the priv->plat->mdio_bus_data structure altogether and
just check for the presence of the xpcs pointer.

Fixes: 11059740e616 ("net: pcs: xpcs: convert to phylink_pcs_ops")
	Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
	Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit b55b1d50b08ce3b79329f62da8104b25c607bf38)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
diff --cc drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
index 3ebd396e13f0,f2adff59b07d..000000000000
--- a/drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
+++ b/drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
@@@ -1210,6 -1238,9 +1210,12 @@@ static int stmmac_phy_setup(struct stmm
  	if (IS_ERR(phylink))
  		return PTR_ERR(phylink);
  
++<<<<<<< HEAD
++=======
+ 	if (priv->hw->xpcs)
+ 		phylink_set_pcs(phylink, &priv->hw->xpcs->pcs);
+ 
++>>>>>>> b55b1d50b08c (net: stmmac: fix NPD with phylink_set_pcs if there is no MDIO bus)
  	priv->phylink = phylink;
  	return 0;
  }
* Unmerged path drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
