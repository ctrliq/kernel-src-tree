cifs: fix wrong unlock before return from cifs_tree_connect()

jira LE-4669
Rebuild_History Non-Buildable kernel-4.18.0-553.82.1.el8_10
commit-author Yang Yingliang <yangyingliang@huawei.com>
commit aea02fc40a7fa6ac2c16e3c3a6f1d0fd7e6faaba
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.82.1.el8_10/aea02fc4.failed

It should unlock 'tcon->tc_lock' before return from cifs_tree_connect().

Fixes: fe67bd563ec2 ("cifs: avoid use of global locks for high contention data")
	Signed-off-by: Yang Yingliang <yangyingliang@huawei.com>
	Reviewed-by: Shyam Prasad N <sprasad@microsoft.com>
	Signed-off-by: Steve French <stfrench@microsoft.com>
(cherry picked from commit aea02fc40a7fa6ac2c16e3c3a6f1d0fd7e6faaba)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/cifs/connect.c
diff --cc fs/cifs/connect.c
index 48c43d43e1df,1362210f3ece..000000000000
--- a/fs/cifs/connect.c
+++ b/fs/cifs/connect.c
@@@ -4359,9 -4578,22 +4359,23 @@@ int cifs_tree_connect(const unsigned in
  	char *tree;
  	struct dfs_info3_param ref = {0};
  
++<<<<<<< HEAD
++=======
+ 	/* only send once per connect */
+ 	spin_lock(&tcon->tc_lock);
+ 	if (tcon->ses->ses_status != SES_GOOD ||
+ 	    (tcon->status != TID_NEW &&
+ 	    tcon->status != TID_NEED_TCON)) {
+ 		spin_unlock(&tcon->tc_lock);
+ 		return 0;
+ 	}
+ 	tcon->status = TID_IN_TCON;
+ 	spin_unlock(&tcon->tc_lock);
+ 
++>>>>>>> aea02fc40a7f (cifs: fix wrong unlock before return from cifs_tree_connect())
  	tree = kzalloc(MAX_TREE_SIZE, GFP_KERNEL);
 -	if (!tree) {
 -		rc = -ENOMEM;
 -		goto out;
 -	}
 +	if (!tree)
 +		return -ENOMEM;
  
  	if (tcon->ipc) {
  		scnprintf(tree, MAX_TREE_SIZE, "\\\\%s\\IPC$", server->hostname);
* Unmerged path fs/cifs/connect.c
