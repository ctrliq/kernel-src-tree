cifs: double lock in cifs_reconnect_tcon()

jira LE-4669
Rebuild_History Non-Buildable kernel-4.18.0-553.82.1.el8_10
commit-author Dan Carpenter <error27@gmail.com>
commit 4f5d5b33fc400911d6e1f49095522b361d9cbe13
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.82.1.el8_10/4f5d5b33.failed

This lock was supposed to be an unlock.

Fixes: 6cc041e90c17 ("cifs: avoid races in parallel reconnects in smb1")
	Signed-off-by: Dan Carpenter <error27@gmail.com>
	Reviewed-by: Paulo Alcantara (SUSE) <pc@manguebit.com>
	Signed-off-by: Steve French <stfrench@microsoft.com>
(cherry picked from commit 4f5d5b33fc400911d6e1f49095522b361d9cbe13)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/cifs/cifssmb.c
diff --cc fs/cifs/cifssmb.c
index 9d8d1d5da728,9d963caec35c..000000000000
--- a/fs/cifs/cifssmb.c
+++ b/fs/cifs/cifssmb.c
@@@ -189,6 -111,24 +189,27 @@@ cifs_reconnect_tcon(struct cifs_tcon *t
  	}
  	spin_unlock(&ses->chan_lock);
  
++<<<<<<< HEAD
++=======
+ 	mutex_lock(&ses->session_mutex);
+ 	/*
+ 	 * Recheck after acquire mutex. If another thread is negotiating
+ 	 * and the server never sends an answer the socket will be closed
+ 	 * and tcpStatus set to reconnect.
+ 	 */
+ 	spin_lock(&server->srv_lock);
+ 	if (server->tcpStatus == CifsNeedReconnect) {
+ 		spin_unlock(&server->srv_lock);
+ 		mutex_unlock(&ses->session_mutex);
+ 
+ 		if (tcon->retry)
+ 			goto again;
+ 		rc = -EHOSTDOWN;
+ 		goto out;
+ 	}
+ 	spin_unlock(&server->srv_lock);
+ 
++>>>>>>> 4f5d5b33fc40 (cifs: double lock in cifs_reconnect_tcon())
  	nls_codepage = load_nls_default();
  
  	/*
* Unmerged path fs/cifs/cifssmb.c
