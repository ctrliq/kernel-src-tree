net: rtnetlink: introduce helper to get net_device instance by ifname

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-408.el8
commit-author Jiri Pirko <jiri@mellanox.com>
commit cc6090e985d7d62bf2f1230c507d5fbe9899c9ec
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-408.el8/cc6090e9.failed

Introduce helper function rtnl_get_dev() that gets net_device structure
instance pointer according to passed ifname or ifname attribute.

	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit cc6090e985d7d62bf2f1230c507d5fbe9899c9ec)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/core/rtnetlink.c
diff --cc net/core/rtnetlink.c
index 5807383aa5e3,77d4719e5be0..000000000000
--- a/net/core/rtnetlink.c
+++ b/net/core/rtnetlink.c
@@@ -2922,9 -2910,6 +2938,12 @@@ static int rtnl_dellink(struct sk_buff 
  	if (err < 0)
  		return err;
  
++<<<<<<< HEAD
 +	if (tb[IFLA_IFNAME])
 +		nla_strscpy(ifname, tb[IFLA_IFNAME], IFNAMSIZ);
 +
++=======
++>>>>>>> cc6090e985d7 (net: rtnetlink: introduce helper to get net_device instance by ifname)
  	if (tb[IFLA_TARGET_NETNSID]) {
  		netnsid = nla_get_s32(tb[IFLA_TARGET_NETNSID]);
  		tgt_net = rtnl_get_net_ns_capable(NETLINK_CB(skb).sk, netnsid);
@@@ -3425,9 -3398,6 +3443,12 @@@ static int rtnl_getlink(struct sk_buff 
  			return PTR_ERR(tgt_net);
  	}
  
++<<<<<<< HEAD
 +	if (tb[IFLA_IFNAME])
 +		nla_strscpy(ifname, tb[IFLA_IFNAME], IFNAMSIZ);
 +
++=======
++>>>>>>> cc6090e985d7 (net: rtnetlink: introduce helper to get net_device instance by ifname)
  	if (tb[IFLA_EXT_MASK])
  		ext_filter_mask = nla_get_u32(tb[IFLA_EXT_MASK]);
  
@@@ -3517,16 -3489,12 +3538,21 @@@ static int rtnl_linkprop(int cmd, struc
  		return err;
  
  	ifm = nlmsg_data(nlh);
- 	if (ifm->ifi_index > 0) {
+ 	if (ifm->ifi_index > 0)
  		dev = __dev_get_by_index(net, ifm->ifi_index);
++<<<<<<< HEAD
 +	} else if (tb[IFLA_IFNAME]) {
 +		char ifname[IFNAMSIZ];
 +
 +		nla_strscpy(ifname, tb[IFLA_IFNAME], IFNAMSIZ);
 +		dev = __dev_get_by_name(net, ifname);
 +	} else {
++=======
+ 	else if (tb[IFLA_IFNAME])
+ 		dev = rtnl_dev_get(net, tb[IFLA_IFNAME], NULL);
+ 	else
++>>>>>>> cc6090e985d7 (net: rtnetlink: introduce helper to get net_device instance by ifname)
  		return -EINVAL;
- 	}
  
  	if (!dev)
  		return -ENODEV;
* Unmerged path net/core/rtnetlink.c
