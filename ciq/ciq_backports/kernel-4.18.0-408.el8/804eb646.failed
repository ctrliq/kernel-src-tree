selftests/x86/pkeys: move selftests to arch-neutral directory

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-408.el8
commit-author Ram Pai <linuxram@us.ibm.com>
commit 804eb64615a405b3765fb3618bc07d7d95809add
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-408.el8/804eb646.failed

Patch series "selftests, powerpc, x86: Memory Protection Keys", v19.

Memory protection keys enables an application to protect its address space
from inadvertent access by its own code.

This feature is now enabled on powerpc and has been available since
4.16-rc1.  The patches move the selftests to arch neutral directory and
enhance their test coverage.

Tested on powerpc64 and x86_64 (Skylake-SP).

This patch (of 24):

Move selftest files from tools/testing/selftests/x86/ to
tools/testing/selftests/vm/.

	Signed-off-by: Ram Pai <linuxram@us.ibm.com>
	Signed-off-by: Thiago Jung Bauermann <bauerman@linux.ibm.com>
	Signed-off-by: Sandipan Das <sandipan@linux.ibm.com>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
	Acked-by: Ingo Molnar <mingo@kernel.org>
	Acked-by: Dave Hansen <dave.hansen@intel.com>
	Cc: Dave Hansen <dave.hansen@intel.com>
	Cc: Florian Weimer <fweimer@redhat.com>
	Cc: "Desnes A. Nunes do Rosario" <desnesn@linux.vnet.ibm.com>
	Cc: Michal Hocko <mhocko@kernel.org>
	Cc: "Aneesh Kumar K.V" <aneesh.kumar@linux.ibm.com>
	Cc: Michal Suchanek <msuchanek@suse.de>
	Cc: Michael Ellerman <mpe@ellerman.id.au>
	Cc: Shuah Khan <shuah@kernel.org>
Link: http://lkml.kernel.org/r/14d25194c3e2e652e0047feec4487e269e76e8c9.1585646528.git.sandipan@linux.ibm.com
	Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
(cherry picked from commit 804eb64615a405b3765fb3618bc07d7d95809add)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/vm/Makefile
#	tools/testing/selftests/x86/Makefile
diff --cc tools/testing/selftests/vm/Makefile
index fd931bcaaa4a,c3b559ea97c5..000000000000
--- a/tools/testing/selftests/vm/Makefile
+++ b/tools/testing/selftests/vm/Makefile
@@@ -12,6 -15,8 +12,11 @@@ TEST_GEN_FILES += map_fixed_noreplac
  TEST_GEN_FILES += map_populate
  TEST_GEN_FILES += mlock-random-test
  TEST_GEN_FILES += mlock2-tests
++<<<<<<< HEAD
++=======
+ TEST_GEN_FILES += protection_keys
+ TEST_GEN_FILES += mremap_dontunmap
++>>>>>>> 804eb64615a4 (selftests/x86/pkeys: move selftests to arch-neutral directory)
  TEST_GEN_FILES += on-fault-limit
  TEST_GEN_FILES += thuge-gen
  TEST_GEN_FILES += transhuge-stress
diff --cc tools/testing/selftests/x86/Makefile
index 08d9b0f9fc87,5f16821c7f63..000000000000
--- a/tools/testing/selftests/x86/Makefile
+++ b/tools/testing/selftests/x86/Makefile
@@@ -11,14 -11,13 +11,21 @@@ CAN_BUILD_X86_64 := $(shell ./check_cc.
  CAN_BUILD_WITH_NOPIE := $(shell ./check_cc.sh $(CC) trivial_program.c -no-pie)
  
  TARGETS_C_BOTHBITS := single_step_syscall sysret_ss_attrs syscall_nt test_mremap_vdso \
++<<<<<<< HEAD
 +			check_initial_reg_state sigreturn iopl mpx-mini-test ioperm \
 +			protection_keys test_vdso test_vsyscall mov_ss_trap \
 +			fsgsbase_restore sigaltstack
 +TARGETS_C_32BIT_ONLY := entry_from_vm86 syscall_arg_fault test_syscall_vdso unwind_vdso \
++=======
+ 			check_initial_reg_state sigreturn iopl ioperm \
+ 			test_vdso test_vsyscall mov_ss_trap \
+ 			syscall_arg_fault
+ TARGETS_C_32BIT_ONLY := entry_from_vm86 test_syscall_vdso unwind_vdso \
++>>>>>>> 804eb64615a4 (selftests/x86/pkeys: move selftests to arch-neutral directory)
  			test_FCMOV test_FCOMI test_FISTTP \
  			vdso_restorer
 -TARGETS_C_64BIT_ONLY := fsgsbase sysret_rip syscall_numbering
 +TARGETS_C_64BIT_ONLY := fsgsbase sysret_rip \
 +			corrupt_xstate_header amx
  # Some selftests require 32bit support enabled also on 64bit systems
  TARGETS_C_32BIT_NEEDED := ldt_gdt ptrace_syscall
  
diff --git a/tools/testing/selftests/vm/.gitignore b/tools/testing/selftests/vm/.gitignore
index 2f0218365e42..34a1d644299f 100644
--- a/tools/testing/selftests/vm/.gitignore
+++ b/tools/testing/selftests/vm/.gitignore
@@ -8,6 +8,7 @@ mlock2-tests
 mremap_dontunmap
 on-fault-limit
 transhuge-stress
+protection_keys
 userfaultfd
 mlock-intersect-test
 mlock-random-test
* Unmerged path tools/testing/selftests/vm/Makefile
diff --git a/tools/testing/selftests/x86/pkey-helpers.h b/tools/testing/selftests/vm/pkey-helpers.h
similarity index 100%
rename from tools/testing/selftests/x86/pkey-helpers.h
rename to tools/testing/selftests/vm/pkey-helpers.h
diff --git a/tools/testing/selftests/x86/protection_keys.c b/tools/testing/selftests/vm/protection_keys.c
similarity index 100%
rename from tools/testing/selftests/x86/protection_keys.c
rename to tools/testing/selftests/vm/protection_keys.c
diff --git a/tools/testing/selftests/x86/.gitignore b/tools/testing/selftests/x86/.gitignore
index 7757f73ff9a3..eb30ffd83876 100644
--- a/tools/testing/selftests/x86/.gitignore
+++ b/tools/testing/selftests/x86/.gitignore
@@ -11,5 +11,4 @@ ldt_gdt
 iopl
 mpx-mini-test
 ioperm
-protection_keys
 test_vdso
* Unmerged path tools/testing/selftests/x86/Makefile
