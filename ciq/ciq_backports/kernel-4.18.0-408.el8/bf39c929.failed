PCI: PM: Rearrange pci_target_state()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-408.el8
commit-author Rafael J. Wysocki <rafael.j.wysocki@intel.com>
commit bf39c929f9053cd840155a1c39494c9a9946836b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-408.el8/bf39c929.failed

Make pci_target_state() return D3cold or D0 without checking PME
support if the current power state of the device is D3cold or if it
does not support the standard PCI PM, respectively.

Next, drop the tergat_state local variable that has become redundant
from it.

	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
	Tested-by: Ferry Toth <fntoth@gmail.com>
(cherry picked from commit bf39c929f9053cd840155a1c39494c9a9946836b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/pci/pci.c
diff --cc drivers/pci/pci.c
index 81152d3b6e4d,121d9deea58a..000000000000
--- a/drivers/pci/pci.c
+++ b/drivers/pci/pci.c
@@@ -2540,18 -2597,12 +2539,19 @@@ static pci_power_t pci_target_state(str
  		case PCI_D1:
  		case PCI_D2:
  			if (pci_no_d1d2(dev))
++<<<<<<< HEAD
 +				break;
 +			/* else, fall through */
 +		default:
 +			target_state = state;
++=======
+ 				return PCI_D3hot;
++>>>>>>> bf39c929f905 (PCI: PM: Rearrange pci_target_state())
  		}
  
- 		return target_state;
+ 		return state;
  	}
  
- 	if (!dev->pm_cap)
- 		target_state = PCI_D0;
- 
  	/*
  	 * If the device is in D3cold even though it's not power-manageable by
  	 * the platform, it may have been powered down by non-standard means.
* Unmerged path drivers/pci/pci.c
