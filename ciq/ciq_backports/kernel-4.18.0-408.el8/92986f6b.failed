dm: use bio_clone_fast in alloc_io/alloc_tio

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-408.el8
commit-author Christoph Hellwig <hch@lst.de>
commit 92986f6b4c8a2c24d3a36b80140624f80fd93de4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-408.el8/92986f6b.failed

Replace open coded bio_clone_fast implementations with the actual helper.
Note that the bio allocated as part of the dm_io structure in alloc_io
will only actually be used later in alloc_tio, making this earlier
cloning of the information safe.

	Signed-off-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Mike Snitzer <snitzer@redhat.com>
Link: https://lore.kernel.org/r/20220202160109.108149-12-hch@lst.de
	Signed-off-by: Jens Axboe <axboe@kernel.dk>
(cherry picked from commit 92986f6b4c8a2c24d3a36b80140624f80fd93de4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/dm.c
diff --cc drivers/md/dm.c
index d626b645f571,862564a5df74..000000000000
--- a/drivers/md/dm.c
+++ b/drivers/md/dm.c
@@@ -601,11 -520,9 +601,15 @@@ static struct dm_io *alloc_io(struct ma
  	struct dm_target_io *tio;
  	struct bio *clone;
  
++<<<<<<< HEAD
 +	clone = bio_alloc_bioset(GFP_NOIO, 0, &md->io_bs);
 +	if (!clone)
 +		return NULL;
++=======
+ 	clone = bio_clone_fast(bio, GFP_NOIO, &md->io_bs);
++>>>>>>> 92986f6b4c8a (dm: use bio_clone_fast in alloc_io/alloc_tio)
  
 -	tio = clone_to_tio(clone);
 +	tio = container_of(clone, struct dm_target_io, clone);
  	tio->inside_dm_io = true;
  	tio->io = NULL;
  
@@@ -639,7 -553,8 +643,12 @@@ static struct dm_target_io *alloc_tio(s
  		/* the dm_target_io embedded in ci->io is available */
  		tio = &ci->io->tio;
  	} else {
++<<<<<<< HEAD
 +		struct bio *clone = bio_alloc_bioset(gfp_mask, 0, &ci->io->md->bs);
++=======
+ 		struct bio *clone = bio_clone_fast(ci->bio, gfp_mask,
+ 						   &ci->io->md->bs);
++>>>>>>> 92986f6b4c8a (dm: use bio_clone_fast in alloc_io/alloc_tio)
  		if (!clone)
  			return NULL;
  
* Unmerged path drivers/md/dm.c
