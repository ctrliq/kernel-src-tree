dm: use bio_sectors in dm_aceept_partial_bio

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-408.el8
commit-author Mike Snitzer <snitzer@kernel.org>
commit bdb34759a0dbc89c134c60d282b5f100bed1365f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-408.el8/bdb34759.failed

Rename 'bi_size' to 'bio_sectors' given bi_size is being stored in
sectors.  Also, use bio_sectors() rather than open-coding it.

	Signed-off-by: Mike Snitzer <snitzer@kernel.org>
(cherry picked from commit bdb34759a0dbc89c134c60d282b5f100bed1365f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/dm.c
diff --cc drivers/md/dm.c
index e7cb1b8972bd,69535e021c92..000000000000
--- a/drivers/md/dm.c
+++ b/drivers/md/dm.c
@@@ -1242,12 -1210,16 +1242,25 @@@ static int dm_dax_zero_page_range(struc
   */
  void dm_accept_partial_bio(struct bio *bio, unsigned n_sectors)
  {
++<<<<<<< HEAD
 +	struct dm_target_io *tio = container_of(bio, struct dm_target_io, clone);
 +	unsigned bi_size = bio->bi_iter.bi_size >> SECTOR_SHIFT;
 +	BUG_ON(bio->bi_opf & REQ_PREFLUSH);
 +	BUG_ON(bi_size > *tio->len_ptr);
 +	BUG_ON(n_sectors > bi_size);
 +	*tio->len_ptr -= bi_size - n_sectors;
++=======
+ 	struct dm_target_io *tio = clone_to_tio(bio);
+ 	unsigned bio_sectors = bio_sectors(bio);
+ 
+ 	BUG_ON(dm_tio_flagged(tio, DM_TIO_IS_DUPLICATE_BIO));
+ 	BUG_ON(op_is_zone_mgmt(bio_op(bio)));
+ 	BUG_ON(bio_op(bio) == REQ_OP_ZONE_APPEND);
+ 	BUG_ON(bio_sectors > *tio->len_ptr);
+ 	BUG_ON(n_sectors > bio_sectors);
+ 
+ 	*tio->len_ptr -= bio_sectors - n_sectors;
++>>>>>>> bdb34759a0db (dm: use bio_sectors in dm_aceept_partial_bio)
  	bio->bi_iter.bi_size = n_sectors << SECTOR_SHIFT;
  }
  EXPORT_SYMBOL_GPL(dm_accept_partial_bio);
* Unmerged path drivers/md/dm.c
