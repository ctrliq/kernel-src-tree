cfg80211: Support configuration of station EHT capabilities

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-408.el8
commit-author Ilan Peer <ilan.peer@intel.com>
commit ea05fd3581d32a0f1098657005c7a9b763798fe8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-408.el8/ea05fd35.failed

Add attributes and some code bits to support userspace passing
in EHT capabilities of stations.

	Signed-off-by: Ilan Peer <ilan.peer@intel.com>
Link: https://lore.kernel.org/r/20220214173004.ecf0b3ff9627.Icb4a5f2ec7b41d9008ac4cfc16c59baeb84793d3@changeid
	Signed-off-by: Johannes Berg <johannes.berg@intel.com>
(cherry picked from commit ea05fd3581d32a0f1098657005c7a9b763798fe8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/uapi/linux/nl80211.h
#	net/wireless/nl80211.c
diff --cc include/uapi/linux/nl80211.h
index 71b5c784d58f,98ed52663d6b..000000000000
--- a/include/uapi/linux/nl80211.h
+++ b/include/uapi/linux/nl80211.h
@@@ -2643,6 -2655,14 +2643,17 @@@ enum nl80211_commands 
   *	switching on a different channel during CAC detection on the selected
   *	radar channel.
   *
++<<<<<<< HEAD
++=======
+  * @NL80211_ATTR_AP_SETTINGS_FLAGS: u32 attribute contains ap settings flags,
+  *	enumerated in &enum nl80211_ap_settings_flags. This attribute shall be
+  *	used with %NL80211_CMD_START_AP request.
+  *
+  * @NL80211_ATTR_EHT_CAPABILITY: EHT Capability information element (from
+  *	association request when used with NL80211_CMD_NEW_STATION). Can be set
+  *	only if %NL80211_STA_FLAG_WME is set.
+  *
++>>>>>>> ea05fd3581d3 (cfg80211: Support configuration of station EHT capabilities)
   * @NUM_NL80211_ATTR: total number of nl80211_attrs available
   * @NL80211_ATTR_MAX: highest attribute number currently defined
   * @__NL80211_ATTR_AFTER_LAST: internal use
@@@ -3149,8 -3169,12 +3160,10 @@@ enum nl80211_attrs 
  	NL80211_ATTR_MBSSID_CONFIG,
  	NL80211_ATTR_MBSSID_ELEMS,
  
 -	NL80211_ATTR_RADAR_BACKGROUND,
 -
 -	NL80211_ATTR_AP_SETTINGS_FLAGS,
 +	NL80211_ATTR_RADAR_OFFCHAN,
  
+ 	NL80211_ATTR_EHT_CAPABILITY,
+ 
  	/* add attributes here, update the policy in nl80211.c */
  
  	__NL80211_ATTR_AFTER_LAST,
diff --cc net/wireless/nl80211.c
index 4783bf89ba07,7543c73a3f1d..000000000000
--- a/net/wireless/nl80211.c
+++ b/net/wireless/nl80211.c
@@@ -784,7 -784,12 +784,16 @@@ static const struct nla_policy nl80211_
  	[NL80211_ATTR_MBSSID_CONFIG] =
  			NLA_POLICY_NESTED(nl80211_mbssid_config_policy),
  	[NL80211_ATTR_MBSSID_ELEMS] = { .type = NLA_NESTED },
++<<<<<<< HEAD
 +	[NL80211_ATTR_RADAR_OFFCHAN] = { .type = NLA_FLAG },
++=======
+ 	[NL80211_ATTR_RADAR_BACKGROUND] = { .type = NLA_FLAG },
+ 	[NL80211_ATTR_AP_SETTINGS_FLAGS] = { .type = NLA_U32 },
+ 	[NL80211_ATTR_EHT_CAPABILITY] =
+ 		NLA_POLICY_RANGE(NLA_BINARY,
+ 				 NL80211_EHT_MIN_CAPABILITY_LEN,
+ 				 NL80211_EHT_MAX_CAPABILITY_LEN),
++>>>>>>> ea05fd3581d3 (cfg80211: Support configuration of station EHT capabilities)
  };
  
  /* policy for the key attributes */
diff --git a/include/net/cfg80211.h b/include/net/cfg80211.h
index e66be77d17e2..74d2c74fb856 100644
--- a/include/net/cfg80211.h
+++ b/include/net/cfg80211.h
@@ -1497,6 +1497,8 @@ struct sta_txpwr {
  * @airtime_weight: airtime scheduler weight for this station
  * @txpwr: transmit power for an associated station
  * @he_6ghz_capa: HE 6 GHz Band capabilities of station
+ * @eht_capa: EHT capabilities of station
+ * @eht_capa_len: the length of the EHT capabilities
  */
 struct station_parameters {
 	const u8 *supported_rates;
@@ -1530,6 +1532,8 @@ struct station_parameters {
 	u16 airtime_weight;
 	struct sta_txpwr txpwr;
 	const struct ieee80211_he_6ghz_capa *he_6ghz_capa;
+	const struct ieee80211_eht_cap_elem *eht_capa;
+	u8 eht_capa_len;
 };
 
 /**
* Unmerged path include/uapi/linux/nl80211.h
* Unmerged path net/wireless/nl80211.c
