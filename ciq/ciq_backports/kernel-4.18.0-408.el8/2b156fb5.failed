bnxt_en: Initiallize bp->ptp_lock first before using it

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-408.el8
commit-author Michael Chan <michael.chan@broadcom.com>
commit 2b156fb57d8f0d28f2207edc646751f4717cf20d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-408.el8/2b156fb5.failed

bnxt_ptp_init() calls bnxt_ptp_init_rtc() which will acquire the ptp_lock
spinlock.  The spinlock is not initialized until later.  Move the
bnxt_ptp_init_rtc() call after the spinlock is initialized.

Fixes: 24ac1ecd5240 ("bnxt_en: Add driver support to use Real Time Counter for PTP")
	Reviewed-by: Pavan Chebbi <pavan.chebbi@broadcom.com>
	Reviewed-by: Saravanan Vajravel <saravanan.vajravel@broadcom.com>
	Reviewed-by: Andy Gospodarek <andrew.gospodarek@broadcom.com>
	Reviewed-by: Somnath Kotur <somnath.kotur@broadcom.com>
	Reviewed-by: Damodharam Ammepalli <damodharam.ammepalli@broadcom.com>
	Signed-off-by: Michael Chan <michael.chan@broadcom.com>
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 2b156fb57d8f0d28f2207edc646751f4717cf20d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c
diff --cc drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c
index 5935cd0d479e,00f2f80c0073..000000000000
--- a/drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c
+++ b/drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c
@@@ -802,7 -854,14 +802,18 @@@ int bnxt_ptp_init(struct bnxt *bp
  	atomic_set(&ptp->tx_avail, BNXT_MAX_TX_TS);
  	spin_lock_init(&ptp->ptp_lock);
  
++<<<<<<< HEAD
 +	bnxt_ptp_timecounter_init(bp, true);
++=======
+ 	if (bp->fw_cap & BNXT_FW_CAP_PTP_RTC) {
+ 		bnxt_ptp_timecounter_init(bp, false);
+ 		rc = bnxt_ptp_init_rtc(bp, phc_cfg);
+ 		if (rc)
+ 			goto out;
+ 	} else {
+ 		bnxt_ptp_timecounter_init(bp, true);
+ 	}
++>>>>>>> 2b156fb57d8f (bnxt_en: Initiallize bp->ptp_lock first before using it)
  
  	ptp->ptp_info = bnxt_ptp_caps;
  	if ((bp->fw_cap & BNXT_FW_CAP_PTP_PPS)) {
* Unmerged path drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c
