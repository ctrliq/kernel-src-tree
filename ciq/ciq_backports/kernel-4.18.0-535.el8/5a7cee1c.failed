ice: fix pin assignment for E810-T without SMA control

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-535.el8
commit-author Jacob Keller <jacob.e.keller@intel.com>
commit 5a7cee1cb4b9ef99fe7acd571e1bd51b023b099a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-535.el8/5a7cee1c.failed

Since commit 43c4958a3ddb ("ice: Merge pin initialization of E810 and E810T
adapters"), the ice_ptp_setup_pins_e810() function has been used for both
E810 and E810-T devices. The new implementation only distinguishes between
whether the device has SMA control or not. It was assumed this is always
true for E810-T devices. In addition, it does not set the n_per_out value
appropriately when SMA control is enabled.

In some cases, the E810-T device may not have access to SMA control. In
that case, the E810-T device actually has access to fewer pins than a
standard E810 device.

Fix the implementation to correctly assign the appropriate pin counts for
E810-T devices both with and without SMA control. The mentioned commit
already includes the appropriate macro values for these pin counts but they
were unused.

Instead of assigning the default E810 values and then overwriting them,
handle the cases separately in order of E810-T with SMA, E810-T without
SMA, and then standard E810. This flow makes following the logic easier.

Fixes: 43c4958a3ddb ("ice: Merge pin initialization of E810 and E810T adapters")
	Signed-off-by: Jacob Keller <jacob.e.keller@intel.com>
	Tested-by: Sunitha Mekala <sunithax.d.mekala@intel.com> (A Contingent worker at Intel)
	Signed-off-by: Tony Nguyen <anthony.l.nguyen@intel.com>
(cherry picked from commit 5a7cee1cb4b9ef99fe7acd571e1bd51b023b099a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/ice/ice_ptp.c
diff --cc drivers/net/ethernet/intel/ice/ice_ptp.c
index ef0fc73589be,7ae1f1abe965..000000000000
--- a/drivers/net/ethernet/intel/ice/ice_ptp.c
+++ b/drivers/net/ethernet/intel/ice/ice_ptp.c
@@@ -2281,13 -2267,9 +2281,17 @@@ ice_ptp_setup_sma_pins_e810t(struct ice
  static void
  ice_ptp_setup_pins_e810(struct ice_pf *pf, struct ptp_clock_info *info)
  {
++<<<<<<< HEAD
 +	info->n_per_out = N_PER_OUT_E810;
 +
 +	if (ice_is_feature_supported(pf, ICE_F_PTP_EXTTS))
 +		info->n_ext_ts = N_EXT_TS_E810;
 +
++=======
++>>>>>>> 5a7cee1cb4b9 (ice: fix pin assignment for E810-T without SMA control)
  	if (ice_is_feature_supported(pf, ICE_F_SMA_CTRL)) {
  		info->n_ext_ts = N_EXT_TS_E810;
+ 		info->n_per_out = N_PER_OUT_E810T;
  		info->n_pins = NUM_PTP_PINS_E810T;
  		info->verify = ice_verify_pin_e810t;
  
* Unmerged path drivers/net/ethernet/intel/ice/ice_ptp.c
