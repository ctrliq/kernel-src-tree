SUNRPC: Record timeout value in xprt_retransmit tracepoint

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-394.el8
commit-author Chuck Lever <chuck.lever@oracle.com>
commit be17b8caf3a3a20c4d910265a6287b07ab444795
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-394.el8/be17b8ca.failed

The client can alter the timeout value after each retransmit. Record
the updated timeout value in the trace log.

	Suggested-by: Dai Ngo <dai.ngo@oracle.com>
	Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
	Signed-off-by: Anna Schumaker <Anna.Schumaker@Netapp.com>
(cherry picked from commit be17b8caf3a3a20c4d910265a6287b07ab444795)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/trace/events/sunrpc.h
diff --cc include/trace/events/sunrpc.h
index cdd0d463ba5e,18d552a17c19..000000000000
--- a/include/trace/events/sunrpc.h
+++ b/include/trace/events/sunrpc.h
@@@ -1071,10 -1061,10 +1071,11 @@@ TRACE_EVENT(xprt_retransmit
  		__field(u32, xid)
  		__field(int, ntrans)
  		__field(int, version)
+ 		__field(unsigned long, timeout)
  		__string(progname,
  			 rqst->rq_task->tk_client->cl_program->name)
 -		__string(procname, rpc_proc_name(rqst->rq_task))
 +		__string(procedure,
 +			 rqst->rq_task->tk_msg.rpc_proc->p_name)
  	),
  
  	TP_fast_assign(
@@@ -1085,17 -1075,19 +1086,24 @@@
  			task->tk_client->cl_clid : -1;
  		__entry->xid = be32_to_cpu(rqst->rq_xid);
  		__entry->ntrans = rqst->rq_ntrans;
+ 		__entry->timeout = task->tk_timeout;
  		__assign_str(progname,
 -			     task->tk_client->cl_program->name);
 +			     task->tk_client->cl_program->name)
  		__entry->version = task->tk_client->cl_vers;
 -		__assign_str(procname, rpc_proc_name(task));
 +		__assign_str(procedure, task->tk_msg.rpc_proc->p_name)
  	),
  
  	TP_printk(
- 		"task:%u@%u xid=0x%08x %sv%d %s ntrans=%d",
+ 		"task:%u@%u xid=0x%08x %sv%d %s ntrans=%d timeout=%lu",
  		__entry->task_id, __entry->client_id, __entry->xid,
++<<<<<<< HEAD
 +		__get_str(progname), __entry->version, __get_str(procedure),
 +		__entry->ntrans)
++=======
+ 		__get_str(progname), __entry->version, __get_str(procname),
+ 		__entry->ntrans, __entry->timeout
+ 	)
++>>>>>>> be17b8caf3a3 (SUNRPC: Record timeout value in xprt_retransmit tracepoint)
  );
  
  TRACE_EVENT(xprt_ping,
* Unmerged path include/trace/events/sunrpc.h
