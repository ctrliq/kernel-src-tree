xfs: merge _xfs_dic2xflags into xfs_ip2xflags

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-394.el8
commit-author Christoph Hellwig <hch@lst.de>
commit 4422501da6b3265c52af2740ba9925f15f08cc7d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-394.el8/4422501d.failed

Merge _xfs_dic2xflags into its only caller.

	Signed-off-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Darrick J. Wong <djwong@kernel.org>
	Signed-off-by: Darrick J. Wong <djwong@kernel.org>
(cherry picked from commit 4422501da6b3265c52af2740ba9925f15f08cc7d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/xfs/xfs_inode.c
diff --cc fs/xfs/xfs_inode.c
index d856a2225b9c,9100a9b7aa80..000000000000
--- a/fs/xfs/xfs_inode.c
+++ b/fs/xfs/xfs_inode.c
@@@ -598,42 -598,40 +598,45 @@@ xfs_lock_two_inodes
  	}
  }
  
- STATIC uint
- _xfs_dic2xflags(
- 	uint16_t		di_flags,
- 	uint64_t		di_flags2,
- 	bool			has_attr)
+ uint
+ xfs_ip2xflags(
+ 	struct xfs_inode	*ip)
  {
++<<<<<<< HEAD
++	struct xfs_icdinode	*dic = &ip->i_d;
++
++	return _xfs_dic2xflags(dic->di_flags, dic->di_flags2, XFS_IFORK_Q(ip));
++=======
  	uint			flags = 0;
  
- 	if (di_flags & XFS_DIFLAG_ANY) {
- 		if (di_flags & XFS_DIFLAG_REALTIME)
+ 	if (ip->i_diflags & XFS_DIFLAG_ANY) {
+ 		if (ip->i_diflags & XFS_DIFLAG_REALTIME)
  			flags |= FS_XFLAG_REALTIME;
- 		if (di_flags & XFS_DIFLAG_PREALLOC)
+ 		if (ip->i_diflags & XFS_DIFLAG_PREALLOC)
  			flags |= FS_XFLAG_PREALLOC;
- 		if (di_flags & XFS_DIFLAG_IMMUTABLE)
+ 		if (ip->i_diflags & XFS_DIFLAG_IMMUTABLE)
  			flags |= FS_XFLAG_IMMUTABLE;
- 		if (di_flags & XFS_DIFLAG_APPEND)
+ 		if (ip->i_diflags & XFS_DIFLAG_APPEND)
  			flags |= FS_XFLAG_APPEND;
- 		if (di_flags & XFS_DIFLAG_SYNC)
+ 		if (ip->i_diflags & XFS_DIFLAG_SYNC)
  			flags |= FS_XFLAG_SYNC;
- 		if (di_flags & XFS_DIFLAG_NOATIME)
+ 		if (ip->i_diflags & XFS_DIFLAG_NOATIME)
  			flags |= FS_XFLAG_NOATIME;
- 		if (di_flags & XFS_DIFLAG_NODUMP)
+ 		if (ip->i_diflags & XFS_DIFLAG_NODUMP)
  			flags |= FS_XFLAG_NODUMP;
- 		if (di_flags & XFS_DIFLAG_RTINHERIT)
+ 		if (ip->i_diflags & XFS_DIFLAG_RTINHERIT)
  			flags |= FS_XFLAG_RTINHERIT;
- 		if (di_flags & XFS_DIFLAG_PROJINHERIT)
+ 		if (ip->i_diflags & XFS_DIFLAG_PROJINHERIT)
  			flags |= FS_XFLAG_PROJINHERIT;
- 		if (di_flags & XFS_DIFLAG_NOSYMLINKS)
+ 		if (ip->i_diflags & XFS_DIFLAG_NOSYMLINKS)
  			flags |= FS_XFLAG_NOSYMLINKS;
- 		if (di_flags & XFS_DIFLAG_EXTSIZE)
+ 		if (ip->i_diflags & XFS_DIFLAG_EXTSIZE)
  			flags |= FS_XFLAG_EXTSIZE;
- 		if (di_flags & XFS_DIFLAG_EXTSZINHERIT)
+ 		if (ip->i_diflags & XFS_DIFLAG_EXTSZINHERIT)
  			flags |= FS_XFLAG_EXTSZINHERIT;
- 		if (di_flags & XFS_DIFLAG_NODEFRAG)
+ 		if (ip->i_diflags & XFS_DIFLAG_NODEFRAG)
  			flags |= FS_XFLAG_NODEFRAG;
- 		if (di_flags & XFS_DIFLAG_FILESTREAM)
+ 		if (ip->i_diflags & XFS_DIFLAG_FILESTREAM)
  			flags |= FS_XFLAG_FILESTREAM;
  	}
  
@@@ -644,19 -642,9 +647,10 @@@
  			flags |= FS_XFLAG_COWEXTSIZE;
  	}
  
- 	if (has_attr)
+ 	if (XFS_IFORK_Q(ip))
  		flags |= FS_XFLAG_HASATTR;
- 
  	return flags;
- }
- 
- uint
- xfs_ip2xflags(
- 	struct xfs_inode	*ip)
- {
- 	struct xfs_icdinode	*dic = &ip->i_d;
- 
- 	return _xfs_dic2xflags(dic->di_flags, dic->di_flags2, XFS_IFORK_Q(ip));
++>>>>>>> 4422501da6b3 (xfs: merge _xfs_dic2xflags into xfs_ip2xflags)
  }
  
  /*
* Unmerged path fs/xfs/xfs_inode.c
