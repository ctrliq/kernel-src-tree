NFSD: Update the NFSv2 READDIR argument decoder to use struct xdr_stream

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-394.el8
commit-author Chuck Lever <chuck.lever@oracle.com>
commit 8688361ae2edb8f7e61d926dc5000c9a44f29370
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-394.el8/8688361a.failed

As an additional clean up, move code not related to XDR decoding
into readdir's .pc_func call out.

	Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
(cherry picked from commit 8688361ae2edb8f7e61d926dc5000c9a44f29370)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfsd/nfsxdr.c
diff --cc fs/nfsd/nfsxdr.c
index 4d4de7551020,7b33093f8d8b..000000000000
--- a/fs/nfsd/nfsxdr.c
+++ b/fs/nfsd/nfsxdr.c
@@@ -379,17 -381,17 +379,24 @@@ nfssvc_decode_symlinkargs(struct svc_rq
  int
  nfssvc_decode_readdirargs(struct svc_rqst *rqstp, __be32 *p)
  {
+ 	struct xdr_stream *xdr = &rqstp->rq_arg_stream;
  	struct nfsd_readdirargs *args = rqstp->rq_argp;
  
- 	p = decode_fh(p, &args->fh);
- 	if (!p)
+ 	if (!svcxdr_decode_fhandle(xdr, &args->fh))
+ 		return 0;
+ 	if (xdr_stream_decode_u32(xdr, &args->cookie) < 0)
  		return 0;
+ 	if (xdr_stream_decode_u32(xdr, &args->count) < 0)
+ 		return 0;
++<<<<<<< HEAD
 +	args->cookie = ntohl(*p++);
 +	args->count  = ntohl(*p++);
 +	args->count  = min_t(u32, args->count, PAGE_SIZE);
 +	args->buffer = page_address(*(rqstp->rq_next_page++));
++=======
++>>>>>>> 8688361ae2ed (NFSD: Update the NFSv2 READDIR argument decoder to use struct xdr_stream)
  
- 	return xdr_argsize_check(rqstp, p);
+ 	return 1;
  }
  
  /*
* Unmerged path fs/nfsd/nfsxdr.c
