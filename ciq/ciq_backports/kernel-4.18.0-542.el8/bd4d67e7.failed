selftests/mm: merge default_huge_page_size() into one

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-542.el8
commit-author Peter Xu <peterx@redhat.com>
commit bd4d67e76f699688d15e6194f1505b8bdfee0dd7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-542.el8/bd4d67e7.failed

There're already 3 same definitions of the three functions.  Move it into
vm_util.[ch].

Link: https://lkml.kernel.org/r/20230412164223.328134-1-peterx@redhat.com
	Signed-off-by: Peter Xu <peterx@redhat.com>
	Reviewed-by: Axel Rasmussen <axelrasmussen@google.com>
	Reviewed-by: Mike Kravetz <mike.kravetz@oracle.com>
	Reviewed-by: David Hildenbrand <david@redhat.com>
	Reviewed-by: Mike Rapoport (IBM) <rppt@kernel.org>
	Cc: Dmitry Safonov <0x7f454c46@gmail.com>
	Cc: Zach O'Keefe <zokeefe@google.com>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
(cherry picked from commit bd4d67e76f699688d15e6194f1505b8bdfee0dd7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/mm/hugetlb-madvise.c
#	tools/testing/selftests/mm/userfaultfd.c
#	tools/testing/selftests/mm/vm_util.c
#	tools/testing/selftests/mm/vm_util.h
* Unmerged path tools/testing/selftests/mm/hugetlb-madvise.c
* Unmerged path tools/testing/selftests/mm/userfaultfd.c
* Unmerged path tools/testing/selftests/mm/vm_util.c
* Unmerged path tools/testing/selftests/mm/vm_util.h
* Unmerged path tools/testing/selftests/mm/hugetlb-madvise.c
* Unmerged path tools/testing/selftests/mm/userfaultfd.c
* Unmerged path tools/testing/selftests/mm/vm_util.c
* Unmerged path tools/testing/selftests/mm/vm_util.h
diff --git a/tools/testing/selftests/vm/thuge-gen.c b/tools/testing/selftests/vm/thuge-gen.c
index 361ef7192cc6..380ab5f0a534 100644
--- a/tools/testing/selftests/vm/thuge-gen.c
+++ b/tools/testing/selftests/vm/thuge-gen.c
@@ -24,6 +24,7 @@
 #include <unistd.h>
 #include <stdarg.h>
 #include <string.h>
+#include "vm_util.h"
 
 #define err(x) perror(x), exit(1)
 
@@ -74,24 +75,6 @@ void find_pagesizes(void)
 	globfree(&g);
 }
 
-unsigned long default_huge_page_size(void)
-{
-	unsigned long hps = 0;
-	char *line = NULL;
-	size_t linelen = 0;
-	FILE *f = fopen("/proc/meminfo", "r");
-	if (!f)
-		return 0;
-	while (getline(&line, &linelen, f) > 0) {
-		if (sscanf(line, "Hugepagesize:       %lu kB", &hps) == 1) {
-			hps <<= 10;
-			break;
-		}
-	}
-	free(line);
-	return hps;
-}
-
 void show(unsigned long ps)
 {
 	char buf[100];
