selftests/vm: rename selftests/vm to selftests/mm

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-542.el8
commit-author SeongJae Park <sj@kernel.org>
commit baa489fabd01596d5426d6e112b34ba5fb59ab82
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-542.el8/baa489fa.failed

Rename selftets/vm to selftests/mm for being more consistent with the
code, documentation, and tools directories, and won't be confused with
virtual machines.

[sj@kernel.org: convert missing vm->mm changes]
  Link: https://lkml.kernel.org/r/20230107230643.252273-1-sj@kernel.org
Link: https://lkml.kernel.org/r/20230103180754.129637-5-sj@kernel.org
	Signed-off-by: SeongJae Park <sj@kernel.org>
	Cc: Jonathan Corbet <corbet@lwn.net>
	Cc: Shuah Khan <shuah@kernel.org>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
(cherry picked from commit baa489fabd01596d5426d6e112b34ba5fb59ab82)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	MAINTAINERS
#	tools/testing/selftests/Makefile
#	tools/testing/selftests/mm/cow.c
#	tools/testing/selftests/mm/hugepage-mremap.c
#	tools/testing/selftests/mm/hugepage-vmemmap.c
#	tools/testing/selftests/mm/hugetlb-madvise.c
#	tools/testing/selftests/mm/ksm_functional_tests.c
#	tools/testing/selftests/mm/ksm_tests.c
#	tools/testing/selftests/mm/madv_populate.c
#	tools/testing/selftests/mm/memfd_secret.c
#	tools/testing/selftests/mm/migration.c
#	tools/testing/selftests/mm/mrelease_test.c
#	tools/testing/selftests/mm/mremap_dontunmap.c
#	tools/testing/selftests/mm/mremap_test.c
#	tools/testing/selftests/mm/soft-dirty.c
#	tools/testing/selftests/mm/split_huge_page_test.c
#	tools/testing/selftests/mm/util.h
#	tools/testing/selftests/mm/va_128TBswitch.sh
#	tools/testing/selftests/mm/vm_util.c
#	tools/testing/selftests/mm/vm_util.h
diff --cc MAINTAINERS
index bc370d66e28e,8ac1472bea34..000000000000
--- a/MAINTAINERS
+++ b/MAINTAINERS
@@@ -6754,9 -9462,11 +6754,13 @@@ HMM - Heterogeneous Memory Managemen
  M:	Jérôme Glisse <jglisse@redhat.com>
  L:	linux-mm@kvack.org
  S:	Maintained
 -F:	Documentation/mm/hmm.rst
 +F:	Documentation/vm/hmm.rst
  F:	include/linux/hmm*
 -F:	lib/test_hmm*
  F:	mm/hmm*
++<<<<<<< HEAD
++=======
+ F:	tools/testing/selftests/mm/*hmm*
++>>>>>>> baa489fabd01 (selftests/vm: rename selftests/vm to selftests/mm)
  
  HOST AP DRIVER
  M:	Jouni Malinen <j@w1.fi>
@@@ -9717,15 -13480,39 +9721,31 @@@ F:	include/linux/gfp.
  F:	include/linux/memory_hotplug.h
  F:	include/linux/mm.h
  F:	include/linux/mmzone.h
++<<<<<<< HEAD
++=======
+ F:	include/linux/pagewalk.h
+ F:	mm/
+ F:	tools/mm/
+ F:	tools/testing/selftests/mm/
+ 
+ VMALLOC
+ M:	Andrew Morton <akpm@linux-foundation.org>
+ R:	Uladzislau Rezki <urezki@gmail.com>
+ R:	Christoph Hellwig <hch@infradead.org>
+ L:	linux-mm@kvack.org
+ S:	Maintained
+ W:	http://www.linux-mm.org
+ T:	git git://git.kernel.org/pub/scm/linux/kernel/git/akpm/mm
++>>>>>>> baa489fabd01 (selftests/vm: rename selftests/vm to selftests/mm)
  F:	include/linux/vmalloc.h
 -F:	mm/vmalloc.c
 -
 -MEMORY HOT(UN)PLUG
 -M:	David Hildenbrand <david@redhat.com>
 -M:	Oscar Salvador <osalvador@suse.de>
 -L:	linux-mm@kvack.org
 -S:	Maintained
 -F:	Documentation/admin-guide/mm/memory-hotplug.rst
 -F:	Documentation/core-api/memory-hotplug.rst
 -F:	drivers/base/memory.c
 -F:	include/linux/memory_hotplug.h
 -F:	mm/memory_hotplug.c
 -F:	tools/testing/selftests/memory-hotplug/
 +F:	mm/
  
  MEMORY TECHNOLOGY DEVICES (MTD)
 -M:	Miquel Raynal <miquel.raynal@bootlin.com>
 +M:	David Woodhouse <dwmw2@infradead.org>
 +M:	Brian Norris <computersforpeace@gmail.com>
 +M:	Boris Brezillon <boris.brezillon@bootlin.com>
 +M:	Marek Vasut <marek.vasut@gmail.com>
  M:	Richard Weinberger <richard@nod.at>
 -M:	Vignesh Raghavendra <vigneshr@ti.com>
  L:	linux-mtd@lists.infradead.org
  S:	Maintained
  W:	http://www.linux-mtd.infradead.org/
diff --cc tools/testing/selftests/Makefile
index 82f2cdc71536,56a29f2de8e6..000000000000
--- a/tools/testing/selftests/Makefile
+++ b/tools/testing/selftests/Makefile
@@@ -55,9 -81,11 +55,14 @@@ TARGETS += timen
  ifneq (1, $(quicktest))
  TARGETS += timers
  endif
 -TARGETS += tmpfs
  TARGETS += tpm2
  TARGETS += user
++<<<<<<< HEAD
 +TARGETS += vm
++=======
+ TARGETS += vDSO
+ TARGETS += mm
++>>>>>>> baa489fabd01 (selftests/vm: rename selftests/vm to selftests/mm)
  TARGETS += x86
  TARGETS += zram
  #Please keep the TARGETS list alphabetically sorted
* Unmerged path tools/testing/selftests/mm/cow.c
* Unmerged path tools/testing/selftests/mm/hugepage-mremap.c
* Unmerged path tools/testing/selftests/mm/hugepage-vmemmap.c
* Unmerged path tools/testing/selftests/mm/hugetlb-madvise.c
* Unmerged path tools/testing/selftests/mm/ksm_functional_tests.c
* Unmerged path tools/testing/selftests/mm/ksm_tests.c
* Unmerged path tools/testing/selftests/mm/madv_populate.c
* Unmerged path tools/testing/selftests/mm/memfd_secret.c
* Unmerged path tools/testing/selftests/mm/migration.c
* Unmerged path tools/testing/selftests/mm/mrelease_test.c
* Unmerged path tools/testing/selftests/mm/mremap_dontunmap.c
* Unmerged path tools/testing/selftests/mm/mremap_test.c
* Unmerged path tools/testing/selftests/mm/soft-dirty.c
* Unmerged path tools/testing/selftests/mm/split_huge_page_test.c
* Unmerged path tools/testing/selftests/mm/util.h
* Unmerged path tools/testing/selftests/mm/va_128TBswitch.sh
* Unmerged path tools/testing/selftests/mm/vm_util.c
* Unmerged path tools/testing/selftests/mm/vm_util.h
diff --git a/Documentation/admin-guide/mm/hugetlbpage.rst b/Documentation/admin-guide/mm/hugetlbpage.rst
index 5026e58826e2..fe0583768021 100644
--- a/Documentation/admin-guide/mm/hugetlbpage.rst
+++ b/Documentation/admin-guide/mm/hugetlbpage.rst
@@ -403,13 +403,13 @@ Examples
 .. _map_hugetlb:
 
 ``map_hugetlb``
-	see tools/testing/selftests/vm/map_hugetlb.c
+	see tools/testing/selftests/mm/map_hugetlb.c
 
 ``hugepage-shm``
-	see tools/testing/selftests/vm/hugepage-shm.c
+	see tools/testing/selftests/mm/hugepage-shm.c
 
 ``hugepage-mmap``
-	see tools/testing/selftests/vm/hugepage-mmap.c
+	see tools/testing/selftests/mm/hugepage-mmap.c
 
 The `libhugetlbfs`_  library provides a wide range of userspace tools
 to help with huge page usability, environment setup, and control.
diff --git a/Documentation/core-api/pin_user_pages.rst b/Documentation/core-api/pin_user_pages.rst
index 71106bb65820..5a1ad87a02bf 100644
--- a/Documentation/core-api/pin_user_pages.rst
+++ b/Documentation/core-api/pin_user_pages.rst
@@ -221,7 +221,7 @@ Unit testing
 ============
 This file::
 
- tools/testing/selftests/vm/gup_test.c
+ tools/testing/selftests/mm/gup_test.c
 
 has the following new calls to exercise the new pin*() wrapper functions:
 
* Unmerged path MAINTAINERS
diff --git a/mm/Kconfig b/mm/Kconfig
index 31b7f4ca1d58..1e5274db4715 100644
--- a/mm/Kconfig
+++ b/mm/Kconfig
@@ -734,7 +734,7 @@ config GUP_TEST
 	  pin_user_pages*(), or pinned via get_user_pages*(), as specified
 	  by other command line arguments.
 
-	  See tools/testing/selftests/vm/gup_test.c
+	  See tools/testing/selftests/mm/gup_test.c
 
 config GUP_GET_PTE_LOW_HIGH
 	bool
* Unmerged path tools/testing/selftests/Makefile
diff --git a/tools/testing/selftests/kselftest_deps.sh b/tools/testing/selftests/kselftest_deps.sh
index bbc04646346b..e9e2c86e84f0 100755
--- a/tools/testing/selftests/kselftest_deps.sh
+++ b/tools/testing/selftests/kselftest_deps.sh
@@ -12,9 +12,9 @@ usage()
 
 echo -e "Usage: $0 -[p] <compiler> [test_name]\n"
 echo -e "\tkselftest_deps.sh [-p] gcc"
-echo -e "\tkselftest_deps.sh [-p] gcc vm"
+echo -e "\tkselftest_deps.sh [-p] gcc mm"
 echo -e "\tkselftest_deps.sh [-p] aarch64-linux-gnu-gcc"
-echo -e "\tkselftest_deps.sh [-p] aarch64-linux-gnu-gcc vm\n"
+echo -e "\tkselftest_deps.sh [-p] aarch64-linux-gnu-gcc mm\n"
 echo "- Should be run in selftests directory in the kernel repo."
 echo "- Checks if Kselftests can be built/cross-built on a system."
 echo "- Parses all test/sub-test Makefile to find library dependencies."
@@ -120,7 +120,7 @@ l1_tests=$(grep -r --include=Makefile "^LDLIBS" | \
 # Level 2
 # Some tests have multiple valid LDLIBS lines for individual sub-tests
 # that need dependency checks. Find them and append them to the tests
-# e.g: vm/Makefile:$(OUTPUT)/userfaultfd: LDLIBS += -lpthread
+# e.g: mm/Makefile:$(OUTPUT)/userfaultfd: LDLIBS += -lpthread
 # Filter out VAR_LDLIBS to discard the following:
 # 	memfd/Makefile:$(OUTPUT)/fuse_mnt: LDLIBS += $(VAR_LDLIBS)
 # Append space at the end of the list to append more tests.
diff --git a/tools/testing/selftests/vm/.gitignore b/tools/testing/selftests/mm/.gitignore
similarity index 100%
rename from tools/testing/selftests/vm/.gitignore
rename to tools/testing/selftests/mm/.gitignore
diff --git a/tools/testing/selftests/vm/Makefile b/tools/testing/selftests/mm/Makefile
similarity index 98%
rename from tools/testing/selftests/vm/Makefile
rename to tools/testing/selftests/mm/Makefile
index 7799278a1068..2c7e47836621 100644
--- a/tools/testing/selftests/vm/Makefile
+++ b/tools/testing/selftests/mm/Makefile
@@ -1,7 +1,7 @@
 # SPDX-License-Identifier: GPL-2.0
-# Makefile for vm selftests
+# Makefile for mm selftests
 
-LOCAL_HDRS += $(selfdir)/vm/local_config.h $(top_srcdir)/mm/gup_test.h
+LOCAL_HDRS += $(selfdir)/mm/local_config.h $(top_srcdir)/mm/gup_test.h
 
 include local_config.mk
 
diff --git a/tools/testing/selftests/vm/charge_reserved_hugetlb.sh b/tools/testing/selftests/mm/charge_reserved_hugetlb.sh
similarity index 100%
rename from tools/testing/selftests/vm/charge_reserved_hugetlb.sh
rename to tools/testing/selftests/mm/charge_reserved_hugetlb.sh
diff --git a/tools/testing/selftests/vm/check_config.sh b/tools/testing/selftests/mm/check_config.sh
similarity index 100%
rename from tools/testing/selftests/vm/check_config.sh
rename to tools/testing/selftests/mm/check_config.sh
diff --git a/tools/testing/selftests/vm/compaction_test.c b/tools/testing/selftests/mm/compaction_test.c
similarity index 100%
rename from tools/testing/selftests/vm/compaction_test.c
rename to tools/testing/selftests/mm/compaction_test.c
diff --git a/tools/testing/selftests/vm/config b/tools/testing/selftests/mm/config
similarity index 100%
rename from tools/testing/selftests/vm/config
rename to tools/testing/selftests/mm/config
* Unmerged path tools/testing/selftests/mm/cow.c
diff --git a/tools/testing/selftests/vm/gup_test.c b/tools/testing/selftests/mm/gup_test.c
similarity index 100%
rename from tools/testing/selftests/vm/gup_test.c
rename to tools/testing/selftests/mm/gup_test.c
diff --git a/tools/testing/selftests/vm/hmm-tests.c b/tools/testing/selftests/mm/hmm-tests.c
similarity index 100%
rename from tools/testing/selftests/vm/hmm-tests.c
rename to tools/testing/selftests/mm/hmm-tests.c
diff --git a/tools/testing/selftests/vm/hugepage-mmap.c b/tools/testing/selftests/mm/hugepage-mmap.c
similarity index 100%
rename from tools/testing/selftests/vm/hugepage-mmap.c
rename to tools/testing/selftests/mm/hugepage-mmap.c
* Unmerged path tools/testing/selftests/mm/hugepage-mremap.c
diff --git a/tools/testing/selftests/vm/hugepage-shm.c b/tools/testing/selftests/mm/hugepage-shm.c
similarity index 100%
rename from tools/testing/selftests/vm/hugepage-shm.c
rename to tools/testing/selftests/mm/hugepage-shm.c
* Unmerged path tools/testing/selftests/mm/hugepage-vmemmap.c
* Unmerged path tools/testing/selftests/mm/hugetlb-madvise.c
diff --git a/tools/testing/selftests/vm/hugetlb_reparenting_test.sh b/tools/testing/selftests/mm/hugetlb_reparenting_test.sh
similarity index 100%
rename from tools/testing/selftests/vm/hugetlb_reparenting_test.sh
rename to tools/testing/selftests/mm/hugetlb_reparenting_test.sh
diff --git a/tools/testing/selftests/vm/khugepaged.c b/tools/testing/selftests/mm/khugepaged.c
similarity index 100%
rename from tools/testing/selftests/vm/khugepaged.c
rename to tools/testing/selftests/mm/khugepaged.c
* Unmerged path tools/testing/selftests/mm/ksm_functional_tests.c
* Unmerged path tools/testing/selftests/mm/ksm_tests.c
* Unmerged path tools/testing/selftests/mm/madv_populate.c
diff --git a/tools/testing/selftests/vm/map_fixed_noreplace.c b/tools/testing/selftests/mm/map_fixed_noreplace.c
similarity index 100%
rename from tools/testing/selftests/vm/map_fixed_noreplace.c
rename to tools/testing/selftests/mm/map_fixed_noreplace.c
diff --git a/tools/testing/selftests/vm/map_hugetlb.c b/tools/testing/selftests/mm/map_hugetlb.c
similarity index 100%
rename from tools/testing/selftests/vm/map_hugetlb.c
rename to tools/testing/selftests/mm/map_hugetlb.c
diff --git a/tools/testing/selftests/vm/map_populate.c b/tools/testing/selftests/mm/map_populate.c
similarity index 100%
rename from tools/testing/selftests/vm/map_populate.c
rename to tools/testing/selftests/mm/map_populate.c
* Unmerged path tools/testing/selftests/mm/memfd_secret.c
* Unmerged path tools/testing/selftests/mm/migration.c
diff --git a/tools/testing/selftests/vm/mlock-random-test.c b/tools/testing/selftests/mm/mlock-random-test.c
similarity index 100%
rename from tools/testing/selftests/vm/mlock-random-test.c
rename to tools/testing/selftests/mm/mlock-random-test.c
diff --git a/tools/testing/selftests/vm/mlock2-tests.c b/tools/testing/selftests/mm/mlock2-tests.c
similarity index 100%
rename from tools/testing/selftests/vm/mlock2-tests.c
rename to tools/testing/selftests/mm/mlock2-tests.c
diff --git a/tools/testing/selftests/vm/mlock2.h b/tools/testing/selftests/mm/mlock2.h
similarity index 100%
rename from tools/testing/selftests/vm/mlock2.h
rename to tools/testing/selftests/mm/mlock2.h
* Unmerged path tools/testing/selftests/mm/mrelease_test.c
* Unmerged path tools/testing/selftests/mm/mremap_dontunmap.c
* Unmerged path tools/testing/selftests/mm/mremap_test.c
diff --git a/tools/testing/selftests/vm/on-fault-limit.c b/tools/testing/selftests/mm/on-fault-limit.c
similarity index 100%
rename from tools/testing/selftests/vm/on-fault-limit.c
rename to tools/testing/selftests/mm/on-fault-limit.c
diff --git a/tools/testing/selftests/vm/pkey-helpers.h b/tools/testing/selftests/mm/pkey-helpers.h
similarity index 100%
rename from tools/testing/selftests/vm/pkey-helpers.h
rename to tools/testing/selftests/mm/pkey-helpers.h
diff --git a/tools/testing/selftests/vm/pkey-powerpc.h b/tools/testing/selftests/mm/pkey-powerpc.h
similarity index 100%
rename from tools/testing/selftests/vm/pkey-powerpc.h
rename to tools/testing/selftests/mm/pkey-powerpc.h
diff --git a/tools/testing/selftests/vm/pkey-x86.h b/tools/testing/selftests/mm/pkey-x86.h
similarity index 100%
rename from tools/testing/selftests/vm/pkey-x86.h
rename to tools/testing/selftests/mm/pkey-x86.h
diff --git a/tools/testing/selftests/vm/protection_keys.c b/tools/testing/selftests/mm/protection_keys.c
similarity index 100%
rename from tools/testing/selftests/vm/protection_keys.c
rename to tools/testing/selftests/mm/protection_keys.c
diff --git a/tools/testing/selftests/vm/run_vmtests.sh b/tools/testing/selftests/mm/run_vmtests.sh
old mode 100755
new mode 100644
similarity index 100%
rename from tools/testing/selftests/vm/run_vmtests.sh
rename to tools/testing/selftests/mm/run_vmtests.sh
diff --git a/tools/testing/selftests/vm/settings b/tools/testing/selftests/mm/settings
similarity index 100%
rename from tools/testing/selftests/vm/settings
rename to tools/testing/selftests/mm/settings
* Unmerged path tools/testing/selftests/mm/soft-dirty.c
* Unmerged path tools/testing/selftests/mm/split_huge_page_test.c
diff --git a/tools/testing/selftests/vm/test_hmm.sh b/tools/testing/selftests/mm/test_hmm.sh
old mode 100755
new mode 100644
similarity index 100%
rename from tools/testing/selftests/vm/test_hmm.sh
rename to tools/testing/selftests/mm/test_hmm.sh
diff --git a/tools/testing/selftests/vm/test_vmalloc.sh b/tools/testing/selftests/mm/test_vmalloc.sh
old mode 100755
new mode 100644
similarity index 100%
rename from tools/testing/selftests/vm/test_vmalloc.sh
rename to tools/testing/selftests/mm/test_vmalloc.sh
diff --git a/tools/testing/selftests/vm/thuge-gen.c b/tools/testing/selftests/mm/thuge-gen.c
similarity index 100%
rename from tools/testing/selftests/vm/thuge-gen.c
rename to tools/testing/selftests/mm/thuge-gen.c
diff --git a/tools/testing/selftests/vm/transhuge-stress.c b/tools/testing/selftests/mm/transhuge-stress.c
similarity index 100%
rename from tools/testing/selftests/vm/transhuge-stress.c
rename to tools/testing/selftests/mm/transhuge-stress.c
diff --git a/tools/testing/selftests/vm/userfaultfd.c b/tools/testing/selftests/mm/userfaultfd.c
similarity index 100%
rename from tools/testing/selftests/vm/userfaultfd.c
rename to tools/testing/selftests/mm/userfaultfd.c
* Unmerged path tools/testing/selftests/mm/util.h
diff --git a/tools/testing/selftests/vm/va_128TBswitch.c b/tools/testing/selftests/mm/va_128TBswitch.c
similarity index 100%
rename from tools/testing/selftests/vm/va_128TBswitch.c
rename to tools/testing/selftests/mm/va_128TBswitch.c
* Unmerged path tools/testing/selftests/mm/va_128TBswitch.sh
diff --git a/tools/testing/selftests/vm/virtual_address_range.c b/tools/testing/selftests/mm/virtual_address_range.c
similarity index 100%
rename from tools/testing/selftests/vm/virtual_address_range.c
rename to tools/testing/selftests/mm/virtual_address_range.c
* Unmerged path tools/testing/selftests/mm/vm_util.c
* Unmerged path tools/testing/selftests/mm/vm_util.h
diff --git a/tools/testing/selftests/vm/write_hugetlb_memory.sh b/tools/testing/selftests/mm/write_hugetlb_memory.sh
similarity index 100%
rename from tools/testing/selftests/vm/write_hugetlb_memory.sh
rename to tools/testing/selftests/mm/write_hugetlb_memory.sh
diff --git a/tools/testing/selftests/vm/write_to_hugetlbfs.c b/tools/testing/selftests/mm/write_to_hugetlbfs.c
similarity index 100%
rename from tools/testing/selftests/vm/write_to_hugetlbfs.c
rename to tools/testing/selftests/mm/write_to_hugetlbfs.c
