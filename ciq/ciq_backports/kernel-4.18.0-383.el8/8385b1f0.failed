net: phy: marvell: enable downshift by default

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-383.el8
commit-author Maxim Kochetkov <fido_max@inbox.ru>
commit 8385b1f0ad0d86b99476de654623effdcb6ac2a2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-383.el8/8385b1f0.failed

A number of PHYs support the PHY tunable to set and get
downshift. However, only 88E1116R enables downshift by default. Extend
this default enabled to all the PHYs that support the downshift
tunable.

	Signed-off-by: Maxim Kochetkov <fido_max@inbox.ru>
	Reviewed-by: Andrew Lunn <andrew@lunn.ch>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 8385b1f0ad0d86b99476de654623effdcb6ac2a2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/phy/marvell.c
diff --cc drivers/net/phy/marvell.c
index d7e28949c5a3,e6721c1c26c2..000000000000
--- a/drivers/net/phy/marvell.c
+++ b/drivers/net/phy/marvell.c
@@@ -2820,9 -2814,10 +2858,14 @@@ static struct phy_driver marvell_driver
  		.phy_id = MARVELL_PHY_ID_88E1121R,
  		.phy_id_mask = MARVELL_PHY_ID_MASK,
  		.name = "Marvell 88E1121R",
 -		.driver_data = DEF_MARVELL_HWMON_OPS(m88e1121_hwmon_ops),
  		/* PHY_GBIT_FEATURES */
++<<<<<<< HEAD
 +		.probe = m88e1121_probe,
 +		.config_init = marvell_config_init,
++=======
+ 		.probe = marvell_probe,
+ 		.config_init = marvell_1011gbe_config_init,
++>>>>>>> 8385b1f0ad0d (net: phy: marvell: enable downshift by default)
  		.config_aneg = m88e1121_config_aneg,
  		.read_status = marvell_read_status,
  		.config_intr = marvell_config_intr,
@@@ -2967,10 -2963,11 +3010,15 @@@
  		.phy_id = MARVELL_PHY_ID_88E1540,
  		.phy_id_mask = MARVELL_PHY_ID_MASK,
  		.name = "Marvell 88E1540",
 -		.driver_data = DEF_MARVELL_HWMON_OPS(m88e1510_hwmon_ops),
  		/* PHY_GBIT_FEATURES */
  		.flags = PHY_POLL_CABLE_TEST,
++<<<<<<< HEAD
 +		.probe = m88e1510_probe,
 +		.config_init = marvell_config_init,
++=======
+ 		.probe = marvell_probe,
+ 		.config_init = marvell_1011gbe_config_init,
++>>>>>>> 8385b1f0ad0d (net: phy: marvell: enable downshift by default)
  		.config_aneg = m88e1510_config_aneg,
  		.read_status = marvell_read_status,
  		.config_intr = marvell_config_intr,
@@@ -2992,10 -2989,11 +3040,10 @@@
  		.phy_id = MARVELL_PHY_ID_88E1545,
  		.phy_id_mask = MARVELL_PHY_ID_MASK,
  		.name = "Marvell 88E1545",
 -		.driver_data = DEF_MARVELL_HWMON_OPS(m88e1510_hwmon_ops),
 -		.probe = marvell_probe,
 +		.probe = m88e1510_probe,
  		/* PHY_GBIT_FEATURES */
  		.flags = PHY_POLL_CABLE_TEST,
- 		.config_init = marvell_config_init,
+ 		.config_init = marvell_1011gbe_config_init,
  		.config_aneg = m88e1510_config_aneg,
  		.read_status = marvell_read_status,
  		.config_intr = marvell_config_intr,
@@@ -3033,13 -3031,40 +3081,46 @@@
  		.get_stats = marvell_get_stats,
  	},
  	{
 -		.phy_id = MARVELL_PHY_ID_88E6341_FAMILY,
 +		.phy_id = MARVELL_PHY_ID_88E6390,
  		.phy_id_mask = MARVELL_PHY_ID_MASK,
 -		.name = "Marvell 88E6341 Family",
 -		.driver_data = DEF_MARVELL_HWMON_OPS(m88e1510_hwmon_ops),
 +		.name = "Marvell 88E6390",
  		/* PHY_GBIT_FEATURES */
  		.flags = PHY_POLL_CABLE_TEST,
++<<<<<<< HEAD
 +		.probe = m88e6390_probe,
 +		.config_init = marvell_config_init,
++=======
+ 		.probe = marvell_probe,
+ 		.config_init = marvell_1011gbe_config_init,
++>>>>>>> 8385b1f0ad0d (net: phy: marvell: enable downshift by default)
+ 		.config_aneg = m88e6390_config_aneg,
+ 		.read_status = marvell_read_status,
+ 		.config_intr = marvell_config_intr,
+ 		.handle_interrupt = marvell_handle_interrupt,
+ 		.resume = genphy_resume,
+ 		.suspend = genphy_suspend,
+ 		.read_page = marvell_read_page,
+ 		.write_page = marvell_write_page,
+ 		.get_sset_count = marvell_get_sset_count,
+ 		.get_strings = marvell_get_strings,
+ 		.get_stats = marvell_get_stats,
+ 		.get_tunable = m88e1540_get_tunable,
+ 		.set_tunable = m88e1540_set_tunable,
+ 		.cable_test_start = marvell_vct7_cable_test_start,
+ 		.cable_test_tdr_start = marvell_vct5_cable_test_tdr_start,
+ 		.cable_test_get_status = marvell_vct7_cable_test_get_status,
+ 	},
+ 	{
++<<<<<<< HEAD
++=======
+ 		.phy_id = MARVELL_PHY_ID_88E6390_FAMILY,
+ 		.phy_id_mask = MARVELL_PHY_ID_MASK,
+ 		.name = "Marvell 88E6390 Family",
+ 		.driver_data = DEF_MARVELL_HWMON_OPS(m88e6390_hwmon_ops),
+ 		/* PHY_GBIT_FEATURES */
+ 		.flags = PHY_POLL_CABLE_TEST,
+ 		.probe = marvell_probe,
+ 		.config_init = marvell_1011gbe_config_init,
  		.config_aneg = m88e6390_config_aneg,
  		.read_status = marvell_read_status,
  		.config_intr = marvell_config_intr,
@@@ -3058,12 -3083,39 +3139,39 @@@
  		.cable_test_get_status = marvell_vct7_cable_test_get_status,
  	},
  	{
+ 		.phy_id = MARVELL_PHY_ID_88E6393_FAMILY,
+ 		.phy_id_mask = MARVELL_PHY_ID_MASK,
+ 		.name = "Marvell 88E6393 Family",
+ 		.driver_data = DEF_MARVELL_HWMON_OPS(m88e6393_hwmon_ops),
+ 		/* PHY_GBIT_FEATURES */
+ 		.flags = PHY_POLL_CABLE_TEST,
+ 		.probe = marvell_probe,
+ 		.config_init = marvell_1011gbe_config_init,
+ 		.config_aneg = m88e1510_config_aneg,
+ 		.read_status = marvell_read_status,
+ 		.config_intr = marvell_config_intr,
+ 		.handle_interrupt = marvell_handle_interrupt,
+ 		.resume = genphy_resume,
+ 		.suspend = genphy_suspend,
+ 		.read_page = marvell_read_page,
+ 		.write_page = marvell_write_page,
+ 		.get_sset_count = marvell_get_sset_count,
+ 		.get_strings = marvell_get_strings,
+ 		.get_stats = marvell_get_stats,
+ 		.get_tunable = m88e1540_get_tunable,
+ 		.set_tunable = m88e1540_set_tunable,
+ 		.cable_test_start = marvell_vct7_cable_test_start,
+ 		.cable_test_tdr_start = marvell_vct5_cable_test_tdr_start,
+ 		.cable_test_get_status = marvell_vct7_cable_test_get_status,
+ 	},
+ 	{
++>>>>>>> 8385b1f0ad0d (net: phy: marvell: enable downshift by default)
  		.phy_id = MARVELL_PHY_ID_88E1340S,
  		.phy_id_mask = MARVELL_PHY_ID_MASK,
  		.name = "Marvell 88E1340S",
 -		.driver_data = DEF_MARVELL_HWMON_OPS(m88e1510_hwmon_ops),
 -		.probe = marvell_probe,
 +		.probe = m88e1510_probe,
  		/* PHY_GBIT_FEATURES */
- 		.config_init = marvell_config_init,
+ 		.config_init = marvell_1011gbe_config_init,
  		.config_aneg = m88e1510_config_aneg,
  		.read_status = marvell_read_status,
  		.config_intr = marvell_config_intr,
@@@ -3082,9 -3134,10 +3190,9 @@@
  		.phy_id = MARVELL_PHY_ID_88E1548P,
  		.phy_id_mask = MARVELL_PHY_ID_MASK,
  		.name = "Marvell 88E1548P",
 -		.driver_data = DEF_MARVELL_HWMON_OPS(m88e1510_hwmon_ops),
 -		.probe = marvell_probe,
 +		.probe = m88e1510_probe,
  		.features = PHY_GBIT_FIBRE_FEATURES,
- 		.config_init = marvell_config_init,
+ 		.config_init = marvell_1011gbe_config_init,
  		.config_aneg = m88e1510_config_aneg,
  		.read_status = marvell_read_status,
  		.config_intr = marvell_config_intr,
* Unmerged path drivers/net/phy/marvell.c
