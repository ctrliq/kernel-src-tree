net: phy: marvell10g: support other MACTYPEs

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-383.el8
commit-author Marek Behún <kabel@kernel.org>
commit ccbf2891de9813fc35b6f35cee97731532e9d386
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-383.el8/ccbf2891.failed

Currently the only "changing" MACTYPE we support is when the PHY changes
between
  10gbase-r / 5gbase-r / 2500base-x / sgmii

Add support for
  usxgmii
  xaui / 5gbase-r / 2500base-x / sgmii
  rxaui / 5gbase-r / 2500base-x / sgmii
and also
  5gbase-r / 2500base-x / sgmii
for 88E2110.

	Signed-off-by: Marek Behún <kabel@kernel.org>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit ccbf2891de9813fc35b6f35cee97731532e9d386)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/phy/marvell10g.c
diff --cc drivers/net/phy/marvell10g.c
index 8ac850432ee4,2dc1317e601e..000000000000
--- a/drivers/net/phy/marvell10g.c
+++ b/drivers/net/phy/marvell10g.c
@@@ -680,30 -707,29 +704,56 @@@ static void mv3310_update_interface(str
  		return;
  	}
  
++<<<<<<< HEAD
 +	if ((phydev->interface == PHY_INTERFACE_MODE_SGMII ||
 +	     phydev->interface == PHY_INTERFACE_MODE_2500BASEX ||
 +	     phydev->interface == PHY_INTERFACE_MODE_10GKR) && phydev->link) {
 +		/* The PHY automatically switches its serdes interface (and
 +		 * active PHYXS instance) between Cisco SGMII, 10GBase-KR and
 +		 * 2500BaseX modes according to the speed.  Florian suggests
 +		 * setting phydev->interface to communicate this to the MAC.
 +		 * Only do this if we are already in one of the above modes.
 +		 */
 +		switch (phydev->speed) {
 +		case SPEED_10000:
 +			phydev->interface = PHY_INTERFACE_MODE_10GKR;
 +			break;
 +		case SPEED_2500:
 +			phydev->interface = PHY_INTERFACE_MODE_2500BASEX;
 +			break;
 +		case SPEED_1000:
 +		case SPEED_100:
 +		case SPEED_10:
 +			phydev->interface = PHY_INTERFACE_MODE_SGMII;
 +			break;
 +		default:
 +			break;
 +		}
++=======
+ 	/* The PHY automatically switches its serdes interface (and active PHYXS
+ 	 * instance) between Cisco SGMII, 2500BaseX, 5GBase-R and 10GBase-R /
+ 	 * xaui / rxaui modes according to the speed.
+ 	 * Florian suggests setting phydev->interface to communicate this to the
+ 	 * MAC. Only do this if we are already in one of the above modes.
+ 	 */
+ 	switch (phydev->speed) {
+ 	case SPEED_10000:
+ 		phydev->interface = priv->const_interface;
+ 		break;
+ 	case SPEED_5000:
+ 		phydev->interface = PHY_INTERFACE_MODE_5GBASER;
+ 		break;
+ 	case SPEED_2500:
+ 		phydev->interface = PHY_INTERFACE_MODE_2500BASEX;
+ 		break;
+ 	case SPEED_1000:
+ 	case SPEED_100:
+ 	case SPEED_10:
+ 		phydev->interface = PHY_INTERFACE_MODE_SGMII;
+ 		break;
+ 	default:
+ 		break;
++>>>>>>> ccbf2891de98 (net: phy: marvell10g: support other MACTYPEs)
  	}
  }
  
* Unmerged path drivers/net/phy/marvell10g.c
