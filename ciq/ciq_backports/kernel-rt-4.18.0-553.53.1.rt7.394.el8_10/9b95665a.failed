platform/x86: dell-wmi-sysman: Make sysman_init() return -ENODEV of the interfaces are not found

jira LE-3201
Rebuild_History Non-Buildable kernel-rt-4.18.0-553.53.1.rt7.394.el8_10
commit-author Hans de Goede <hdegoede@redhat.com>
commit 9b95665a83ec555f441f5681daa58f75828d0255
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-rt-4.18.0-553.53.1.rt7.394.el8_10/9b95665a.failed

When either the attributes or the password interface is not found, then
unregister the 2 wmi drivers again and return -ENODEV from sysman_init().

Fixes: e8a60aa7404b ("platform/x86: Introduce support for Systems Management Driver over WMI for Dell Systems")
	Cc: Divya Bharathi <Divya_Bharathi@dell.com>
	Cc: Mario Limonciello <mario.limonciello@dell.com>
	Reported-by: Alexander Naumann <alexandernaumann@gmx.de>
	Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Link: https://lore.kernel.org/r/20210321115901.35072-7-hdegoede@redhat.com
(cherry picked from commit 9b95665a83ec555f441f5681daa58f75828d0255)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/platform/x86/dell-wmi-sysman/sysman.c
diff --cc drivers/platform/x86/dell-wmi-sysman/sysman.c
index 641f87850439,5dd9b29d939c..000000000000
--- a/drivers/platform/x86/dell-wmi-sysman/sysman.c
+++ b/drivers/platform/x86/dell-wmi-sysman/sysman.c
@@@ -504,22 -506,24 +504,36 @@@ static int __init sysman_init(void
  	}
  
  	ret = init_bios_attr_set_interface();
++<<<<<<< HEAD:drivers/platform/x86/dell-wmi-sysman/sysman.c
 +	if (ret || !wmi_priv.bios_attr_wdev) {
 +		pr_debug("failed to initialize set interface\n");
 +		goto fail_set_interface;
 +	}
 +
 +	ret = init_bios_attr_pass_interface();
 +	if (ret || !wmi_priv.password_attr_wdev) {
 +		pr_debug("failed to initialize pass interface\n");
 +		goto fail_pass_interface;
++=======
+ 	if (ret)
+ 		return ret;
+ 
+ 	ret = init_bios_attr_pass_interface();
+ 	if (ret)
+ 		goto err_exit_bios_attr_set_interface;
+ 
+ 	if (!wmi_priv.bios_attr_wdev || !wmi_priv.password_attr_wdev) {
+ 		pr_debug("failed to find set or pass interface\n");
+ 		ret = -ENODEV;
+ 		goto err_exit_bios_attr_pass_interface;
++>>>>>>> 9b95665a83ec (platform/x86: dell-wmi-sysman: Make sysman_init() return -ENODEV of the interfaces are not found):drivers/platform/x86/dell/dell-wmi-sysman/sysman.c
  	}
  
 -	ret = class_register(&firmware_attributes_class);
 +	ret = fw_attributes_class_get(&fw_attr_class);
  	if (ret)
 -		goto err_exit_bios_attr_pass_interface;
 +		goto fail_class;
  
 -	wmi_priv.class_dev = device_create(&firmware_attributes_class, NULL, MKDEV(0, 0),
 +	wmi_priv.class_dev = device_create(fw_attr_class, NULL, MKDEV(0, 0),
  				  NULL, "%s", DRIVER_NAME);
  	if (IS_ERR(wmi_priv.class_dev)) {
  		ret = PTR_ERR(wmi_priv.class_dev);
* Unmerged path drivers/platform/x86/dell-wmi-sysman/sysman.c
