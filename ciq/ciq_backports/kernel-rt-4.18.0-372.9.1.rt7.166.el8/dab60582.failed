drm/amd/display: Fix OLED brightness control on eDP

jira LE-1907
Rebuild_History Non-Buildable kernel-rt-4.18.0-372.9.1.rt7.166.el8
commit-author Roman Li <Roman.Li@amd.com>
commit dab60582685aabdae2d4ff7ce716456bd0dc7a0f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-rt-4.18.0-372.9.1.rt7.166.el8/dab60582.failed

[Why]
After commit ("drm/amdgpu/display: add support for multiple backlights")
number of eDPs is defined while registering backlight device.
However the panel's extended caps get updated once before register call.
That leads to regression with extended caps like oled brightness control.

[How]
Update connector ext caps after register_backlight_device

Fixes: 7fd13baeb7a3a4 ("drm/amdgpu/display: add support for multiple backlights")
Link: https://www.reddit.com/r/AMDLaptops/comments/qst0fm/after_updating_to_linux_515_my_brightness/

	Signed-off-by: Roman Li <Roman.Li@amd.com>
	Tested-by: Samuel ÄŒavoj <samuel@cavoj.net>
	Acked-by: Alex Deucher <alexander.deucher@amd.com>
	Reviewed-by: Jasdeep Dhillon <Jasdeep.Dhillon@amd.com>
	Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
	Cc: stable@vger.kernel.org
(cherry picked from commit dab60582685aabdae2d4ff7ce716456bd0dc7a0f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
diff --cc drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
index be0d2c3f119d,c27cb47bc988..000000000000
--- a/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
+++ b/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
@@@ -3865,7 -4242,9 +3865,13 @@@ static int amdgpu_dm_initialize_drm_dev
  		} else if (dc_link_detect(link, DETECT_REASON_BOOT)) {
  			amdgpu_dm_update_connector_after_detect(aconnector);
  			register_backlight_device(dm, link);
++<<<<<<< HEAD
 +			if (amdgpu_dc_feature_mask & DC_PSR_MASK)
++=======
+ 			if (dm->num_of_edps)
+ 				update_connector_ext_caps(aconnector);
+ 			if (psr_feature_enabled)
++>>>>>>> dab60582685a (drm/amd/display: Fix OLED brightness control on eDP)
  				amdgpu_dm_set_psr_caps(link);
  		}
  
* Unmerged path drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
