net/mlx5e: Introduce abstraction of RSS context

jira LE-1907
Rebuild_History Non-Buildable kernel-rt-4.18.0-372.9.1.rt7.166.el8
commit-author Tariq Toukan <tariqt@nvidia.com>
commit 713ba5e5f6896cbdde7ddb339cd8b06eb7c7334a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-rt-4.18.0-372.9.1.rt7.166.el8/713ba5e5.failed

Bring all fields that define and maintain RSS behavior together
into a new structure.
Align all usages with this new structure. Keep it hidden within
rx_res.c.
This helps supporting multiple RSS contexts in downstream patch.

Use dynamic allocations for the RSS context.

	Signed-off-by: Tariq Toukan <tariqt@nvidia.com>
	Reviewed-by: Maxim Mikityanskiy <maximmi@nvidia.com>
	Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
(cherry picked from commit 713ba5e5f6896cbdde7ddb339cd8b06eb7c7334a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en/rx_res.c
#	drivers/net/ethernet/mellanox/mlx5/core/en/rx_res.h
#	drivers/net/ethernet/mellanox/mlx5/core/en_ethtool.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_ethtool.c
index f0d51e7c3d41,62eef3e7f993..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_ethtool.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_ethtool.c
@@@ -1218,20 -1198,12 +1218,29 @@@ int mlx5e_get_rxfh(struct net_device *n
  		   u8 *hfunc)
  {
  	struct mlx5e_priv *priv = netdev_priv(netdev);
++<<<<<<< HEAD
 +	struct mlx5e_rss_params *rss = &priv->rss_params;
 +
 +	if (indir)
 +		memcpy(indir, rss->indirection_rqt,
 +		       sizeof(rss->indirection_rqt));
 +
 +	if (key)
 +		memcpy(key, rss->toeplitz_hash_key,
 +		       sizeof(rss->toeplitz_hash_key));
 +
 +	if (hfunc)
 +		*hfunc = rss->hfunc;
 +
 +	return 0;
++=======
+ 	int err;
+ 
+ 	mutex_lock(&priv->state_lock);
+ 	err = mlx5e_rx_res_rss_get_rxfh(priv->rx_res, indir, key, hfunc);
+ 	mutex_unlock(&priv->state_lock);
+ 	return err;
++>>>>>>> 713ba5e5f689 (net/mlx5e: Introduce abstraction of RSS context)
  }
  
  int mlx5e_set_rxfh(struct net_device *dev, const u32 *indir,
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en/rx_res.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en/rx_res.h
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en/rx_res.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en/rx_res.h
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_ethtool.c
