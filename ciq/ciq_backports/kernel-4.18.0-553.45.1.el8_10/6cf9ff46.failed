net: smc: fix spurious error message from __sock_release()

jira LE-2741
Rebuild_History Non-Buildable kernel-4.18.0-553.45.1.el8_10
commit-author Dmitry Antipov <dmantipov@yandex.ru>
commit 6cf9ff463317217d95732a6cce6fbdd12508921a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.45.1.el8_10/6cf9ff46.failed

Commit 67f562e3e147 ("net/smc: transfer fasync_list in case of fallback")
leaves the socket's fasync list pointer within a container socket as well.
When the latter is destroyed, '__sock_release()' warns about its non-empty
fasync list, which is a dangling pointer to previously freed fasync list
of an underlying TCP socket. Fix this spurious warning by nullifying
fasync list of a container socket.

Fixes: 67f562e3e147 ("net/smc: transfer fasync_list in case of fallback")
	Signed-off-by: Dmitry Antipov <dmantipov@yandex.ru>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 6cf9ff463317217d95732a6cce6fbdd12508921a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/smc/af_smc.c
diff --cc net/smc/af_smc.c
index a13de560699d,0f53a5c6fd9d..000000000000
--- a/net/smc/af_smc.c
+++ b/net/smc/af_smc.c
@@@ -892,8 -922,9 +892,14 @@@ static int smc_switch_to_fallback(struc
  	if (smc->sk.sk_socket && smc->sk.sk_socket->file) {
  		smc->clcsock->file = smc->sk.sk_socket->file;
  		smc->clcsock->file->private_data = smc->clcsock;
++<<<<<<< HEAD
 +		smc->clcsock->wq->fasync_list =
 +			smc->sk.sk_socket->wq->fasync_list;
++=======
+ 		smc->clcsock->wq.fasync_list =
+ 			smc->sk.sk_socket->wq.fasync_list;
+ 		smc->sk.sk_socket->wq.fasync_list = NULL;
++>>>>>>> 6cf9ff463317 (net: smc: fix spurious error message from __sock_release())
  
  		/* There might be some wait entries remaining
  		 * in smc sk->sk_wq and they should be woken up
* Unmerged path net/smc/af_smc.c
