Revert "x86/hyperv: fix logical processor creation"

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-536.el8
commit-author Wei Liu <wei.liu@kernel.org>
commit f5a11c69b69923a4367d24365ad4dff6d4f3fc42
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-536.el8/f5a11c69.failed

This reverts commit 450605c28d571eddca39a65fdbc1338add44c6d9.

	Signed-off-by: Wei Liu <wei.liu@kernel.org>
(cherry picked from commit f5a11c69b69923a4367d24365ad4dff6d4f3fc42)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/cpu/mshyperv.c
diff --cc arch/x86/kernel/cpu/mshyperv.c
index 1189865ffc68,c890d67a64ad..000000000000
--- a/arch/x86/kernel/cpu/mshyperv.c
+++ b/arch/x86/kernel/cpu/mshyperv.c
@@@ -300,6 -223,32 +300,35 @@@ static void __init hv_smp_prepare_boot_
  	hv_init_spinlocks();
  #endif
  }
++<<<<<<< HEAD
++=======
+ 
+ static void __init hv_smp_prepare_cpus(unsigned int max_cpus)
+ {
+ #ifdef CONFIG_X86_64
+ 	int i;
+ 	int ret;
+ #endif
+ 
+ 	native_smp_prepare_cpus(max_cpus);
+ 
+ #ifdef CONFIG_X86_64
+ 	for_each_present_cpu(i) {
+ 		if (i == 0)
+ 			continue;
+ 		ret = hv_call_add_logical_proc(numa_cpu_node(i), i, cpu_physical_id(i));
+ 		BUG_ON(ret);
+ 	}
+ 
+ 	for_each_present_cpu(i) {
+ 		if (i == 0)
+ 			continue;
+ 		ret = hv_call_create_vp(numa_cpu_node(i), hv_current_partition_id, i, i);
+ 		BUG_ON(ret);
+ 	}
+ #endif
+ }
++>>>>>>> f5a11c69b699 (Revert "x86/hyperv: fix logical processor creation")
  #endif
  
  static void __init ms_hyperv_init_platform(void)
* Unmerged path arch/x86/kernel/cpu/mshyperv.c
