x86/microcode: Adjust late loading result reporting message

jira LE-1907
cve CVE-2023-20593
Rebuild_History Non-Buildable kernel-5.14.0-284.30.1.el9_2
commit-author Ashok Raj <ashok.raj@intel.com>
commit 6eab3abac7043226e5375e9ead0c7607ced6767b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-5.14.0-284.30.1.el9_2/6eab3aba.failed

During late microcode loading, the "Reload completed" message is issued
unconditionally, regardless of success or failure.

Adjust the message to report the result of the update.

  [ bp: Massage. ]

Fixes: 9bd681251b7c ("x86/microcode: Announce reload operation's completion")
	Suggested-by: Thomas Gleixner <tglx@linutronix.de>
	Signed-off-by: Ashok Raj <ashok.raj@intel.com>
	Signed-off-by: Borislav Petkov (AMD) <bp@alien8.de>
	Reviewed-by: Tony Luck <tony.luck@intel.com>
Link: https://lore.kernel.org/lkml/874judpqqd.ffs@tglx/
(cherry picked from commit 6eab3abac7043226e5375e9ead0c7607ced6767b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/cpu/microcode/core.c
diff --cc arch/x86/kernel/cpu/microcode/core.c
index 400602902006,61d57d9b93ee..000000000000
--- a/arch/x86/kernel/cpu/microcode/core.c
+++ b/arch/x86/kernel/cpu/microcode/core.c
@@@ -587,12 -446,21 +587,23 @@@ static int microcode_reload_late(void
  	atomic_set(&late_cpus_in,  0);
  	atomic_set(&late_cpus_out, 0);
  
 -	/*
 -	 * Take a snapshot before the microcode update in order to compare and
 -	 * check whether any bits changed after an update.
 -	 */
 -	store_cpu_caps(&prev_info);
 -
  	ret = stop_machine_cpuslocked(__reload_late, NULL, cpu_online_mask);
++<<<<<<< HEAD
 +	if (ret == 0)
 +		microcode_check();
 +
 +	pr_info("Reload completed, microcode revision: 0x%x -> 0x%x\n",
 +		old, boot_cpu_data.microcode);
++=======
+ 	if (!ret) {
+ 		pr_info("Reload succeeded, microcode revision: 0x%x -> 0x%x\n",
+ 			old, boot_cpu_data.microcode);
+ 		microcode_check(&prev_info);
+ 	} else {
+ 		pr_info("Reload failed, current microcode revision: 0x%x\n",
+ 			boot_cpu_data.microcode);
+ 	}
++>>>>>>> 6eab3abac704 (x86/microcode: Adjust late loading result reporting message)
  
  	return ret;
  }
* Unmerged path arch/x86/kernel/cpu/microcode/core.c
