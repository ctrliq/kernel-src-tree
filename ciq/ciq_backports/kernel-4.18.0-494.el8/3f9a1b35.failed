perf/x86/amd/lbr: Adjust LBR regardless of filtering

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-494.el8
commit-author Stephane Eranian <eranian@google.com>
commit 3f9a1b3591003b122a6ea2d69f89a0fd96ec58b9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-494.el8/3f9a1b35.failed

In case of fused compare and taken branch instructions, the AMD LBR points to
the compare instruction instead of the branch. Users of LBR usually expects
the from address to point to a branch instruction. The kernel has code to
adjust the from address via get_branch_type_fused(). However this correction
is only applied when a branch filter is applied. That means that if no
filter is present, the quality of the data is lower.

Fix the problem by applying the adjustment regardless of the filter setting,
bringing the AMD LBR to the same level as other LBR implementations.

Fixes: 245268c19f70 ("perf/x86/amd/lbr: Use fusion-aware branch classifier")
	Signed-off-by: Stephane Eranian <eranian@google.com>
	Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
	Reviewed-by: Sandipan Das <sandipan.das@amd.com>
Link: https://lore.kernel.org/r/20220928184043.408364-3-eranian@google.com
(cherry picked from commit 3f9a1b3591003b122a6ea2d69f89a0fd96ec58b9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/events/amd/lbr.c
* Unmerged path arch/x86/events/amd/lbr.c
* Unmerged path arch/x86/events/amd/lbr.c
