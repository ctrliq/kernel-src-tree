ipv4: prevent potential spectre v1 gadget in fib_metrics_match()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-494.el8
commit-author Eric Dumazet <edumazet@google.com>
commit 5e9398a26a92fc402d82ce1f97cc67d832527da0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-494.el8/5e9398a2.failed

if (!type)
        continue;
    if (type > RTAX_MAX)
        return false;
    ...
    fi_val = fi->fib_metrics->metrics[type - 1];

@type being used as an array index, we need to prevent
cpu speculation or risk leaking kernel memory content.

Fixes: 5f9ae3d9e7e4 ("ipv4: do metrics match when looking up and deleting a route")
	Signed-off-by: Eric Dumazet <edumazet@google.com>
Link: https://lore.kernel.org/r/20230120133140.3624204-1-edumazet@google.com
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 5e9398a26a92fc402d82ce1f97cc67d832527da0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv4/fib_semantics.c
diff --cc net/ipv4/fib_semantics.c
index 1600f4cbbd6c,3bb890a40ed7..000000000000
--- a/net/ipv4/fib_semantics.c
+++ b/net/ipv4/fib_semantics.c
@@@ -33,8 -29,11 +33,13 @@@
  #include <linux/init.h>
  #include <linux/slab.h>
  #include <linux/netlink.h>
++<<<<<<< HEAD
++=======
+ #include <linux/hash.h>
+ #include <linux/nospec.h>
++>>>>>>> 5e9398a26a92 (ipv4: prevent potential spectre v1 gadget in fib_metrics_match())
  
  #include <net/arp.h>
 -#include <net/inet_dscp.h>
  #include <net/ip.h>
  #include <net/protocol.h>
  #include <net/route.h>
* Unmerged path net/ipv4/fib_semantics.c
