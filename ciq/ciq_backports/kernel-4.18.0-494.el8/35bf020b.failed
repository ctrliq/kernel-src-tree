scsi: target: iscsi: Fix NULL pointer dereference in iscsi_conn_auth_required()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-494.el8
commit-author Yang Li <yang.lee@linux.alibaba.com>
commit 35bf020bd8ab41849871645d8fa83c86cddfe7eb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-494.el8/35bf020b.failed

Fix following coccicheck error:

./drivers/target/iscsi/iscsi_target_nego.c:831:13-26: ERROR: se_nacl is NULL but dereferenced.

Link: https://lore.kernel.org/r/20220613014321.107045-1-yang.lee@linux.alibaba.com
Fixes: a75fcb0912a5 ("scsi: target: iscsi: Extract auth functions")
	Reported-by: Abaci Robot <abaci@linux.alibaba.com>
	Reviewed-by: Mike Christie <michael.christie@oracle.com>
	Signed-off-by: Yang Li <yang.lee@linux.alibaba.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 35bf020bd8ab41849871645d8fa83c86cddfe7eb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/target/iscsi/iscsi_target_nego.c
diff --cc drivers/target/iscsi/iscsi_target_nego.c
index 5e35f8260dd3,fb93a1173954..000000000000
--- a/drivers/target/iscsi/iscsi_target_nego.c
+++ b/drivers/target/iscsi/iscsi_target_nego.c
@@@ -821,8 -811,44 +821,47 @@@ static int iscsi_target_do_authenticati
  	return 0;
  }
  
++<<<<<<< HEAD
++=======
+ static bool iscsi_conn_auth_required(struct iscsit_conn *conn)
+ {
+ 	struct iscsi_node_acl *nacl;
+ 	struct se_node_acl *se_nacl;
+ 
+ 	if (conn->sess->sess_ops->SessionType) {
+ 		/*
+ 		 * For SessionType=Discovery
+ 		 */
+ 		return conn->tpg->tpg_attrib.authentication;
+ 	}
+ 	/*
+ 	 * For SessionType=Normal
+ 	 */
+ 	se_nacl = conn->sess->se_sess->se_node_acl;
+ 	if (!se_nacl) {
+ 		pr_debug("Unknown ACL is trying to connect\n");
+ 		return true;
+ 	}
+ 
+ 	if (se_nacl->dynamic_node_acl) {
+ 		pr_debug("Dynamic ACL %s is trying to connect\n",
+ 			 se_nacl->initiatorname);
+ 		return conn->tpg->tpg_attrib.authentication;
+ 	}
+ 
+ 	pr_debug("Known ACL %s is trying to connect\n",
+ 		 se_nacl->initiatorname);
+ 
+ 	nacl = to_iscsi_nacl(se_nacl);
+ 	if (nacl->node_attrib.authentication == NA_AUTHENTICATION_INHERITED)
+ 		return conn->tpg->tpg_attrib.authentication;
+ 
+ 	return nacl->node_attrib.authentication;
+ }
+ 
++>>>>>>> 35bf020bd8ab (scsi: target: iscsi: Fix NULL pointer dereference in iscsi_conn_auth_required())
  static int iscsi_target_handle_csg_zero(
 -	struct iscsit_conn *conn,
 +	struct iscsi_conn *conn,
  	struct iscsi_login *login)
  {
  	int ret;
* Unmerged path drivers/target/iscsi/iscsi_target_nego.c
