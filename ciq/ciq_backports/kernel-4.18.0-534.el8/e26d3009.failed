netfilter: nf_tables: disallow timeout for anonymous sets

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-534.el8
commit-author Pablo Neira Ayuso <pablo@netfilter.org>
commit e26d3009efda338f19016df4175f354a9bd0a4ab
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-534.el8/e26d3009.failed

Never used from userspace, disallow these parameters.

	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit e26d3009efda338f19016df4175f354a9bd0a4ab)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/nf_tables_api.c
diff --cc net/netfilter/nf_tables_api.c
index 3cce3d33e39c,0d293eab310b..000000000000
--- a/net/netfilter/nf_tables_api.c
+++ b/net/netfilter/nf_tables_api.c
@@@ -4139,7 -4909,10 +4139,14 @@@ static int nf_tables_newset(struct net 
  		if (!(flags & NFT_SET_TIMEOUT))
  			return -EINVAL;
  
++<<<<<<< HEAD
 +		err = nf_msecs_to_jiffies64(nla[NFTA_SET_TIMEOUT], &timeout);
++=======
+ 		if (flags & NFT_SET_ANONYMOUS)
+ 			return -EOPNOTSUPP;
+ 
+ 		err = nf_msecs_to_jiffies64(nla[NFTA_SET_TIMEOUT], &desc.timeout);
++>>>>>>> e26d3009efda (netfilter: nf_tables: disallow timeout for anonymous sets)
  		if (err)
  			return err;
  	}
@@@ -4147,12 -4920,16 +4154,20 @@@
  	if (nla[NFTA_SET_GC_INTERVAL] != NULL) {
  		if (!(flags & NFT_SET_TIMEOUT))
  			return -EINVAL;
++<<<<<<< HEAD
 +		gc_int = ntohl(nla_get_be32(nla[NFTA_SET_GC_INTERVAL]));
++=======
+ 
+ 		if (flags & NFT_SET_ANONYMOUS)
+ 			return -EOPNOTSUPP;
+ 
+ 		desc.gc_int = ntohl(nla_get_be32(nla[NFTA_SET_GC_INTERVAL]));
++>>>>>>> e26d3009efda (netfilter: nf_tables: disallow timeout for anonymous sets)
  	}
  
 -	desc.policy = NFT_SET_POL_PERFORMANCE;
 +	policy = NFT_SET_POL_PERFORMANCE;
  	if (nla[NFTA_SET_POLICY] != NULL)
 -		desc.policy = ntohl(nla_get_be32(nla[NFTA_SET_POLICY]));
 +		policy = ntohl(nla_get_be32(nla[NFTA_SET_POLICY]));
  
  	if (nla[NFTA_SET_DESC] != NULL) {
  		err = nf_tables_set_desc_parse(&desc, nla[NFTA_SET_DESC]);
* Unmerged path net/netfilter/nf_tables_api.c
