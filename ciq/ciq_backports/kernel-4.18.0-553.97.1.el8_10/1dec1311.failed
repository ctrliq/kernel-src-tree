scsi: lpfc: Fix list_entry null check warning in lpfc_cmpl_els_plogi()

jira KERNEL-548
Rebuild_History Non-Buildable kernel-4.18.0-553.97.1.el8_10
commit-author Justin Tee <justin.tee@broadcom.com>
commit 1dec1311b9b6cc9c5fd26a77b936f542f03c51d1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.97.1.el8_10/1dec1311.failed

Smatch called out a warning for null checking a ptr that is assigned by
list_entry(). list_entry() does not return null and, if the list is empty,
can return an invalid ptr. Thus, the !psrp check does not execute properly.

 drivers/scsi/lpfc/lpfc_els.c:2133 lpfc_cmpl_els_plogi()
 warn: list_entry() does not return NULL 'prsp'

Replace list_entry() with list_get_first(), which does a list_empty() check
before returning the first entry.

Fixes: a3c3c0a806f1 ("scsi: lpfc: Validate ELS LS_ACC completion payload")
	Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Closes: https://lore.kernel.org/linux-scsi/01b7568f-4ab4-4d56-bfa6-9ecc5fc261fe@moroto.mountain/
	Signed-off-by: Justin Tee <justin.tee@broadcom.com>
Link: https://lore.kernel.org/r/20231031191224.150862-4-justintee8345@gmail.com
	Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 1dec1311b9b6cc9c5fd26a77b936f542f03c51d1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/lpfc/lpfc_els.c
diff --cc drivers/scsi/lpfc/lpfc_els.c
index 01c683279397,0829fe6ddff8..000000000000
--- a/drivers/scsi/lpfc/lpfc_els.c
+++ b/drivers/scsi/lpfc/lpfc_els.c
@@@ -2128,9 -2128,8 +2128,14 @@@ lpfc_cmpl_els_plogi(struct lpfc_hba *ph
  						NLP_EVT_DEVICE_RM);
  	} else {
  		/* Good status, call state machine */
++<<<<<<< HEAD
 +		prsp = list_entry(((struct lpfc_dmabuf *)
 +				   cmdiocb->context2)->list.next,
 +				  struct lpfc_dmabuf, list);
++=======
+ 		prsp = list_get_first(&cmdiocb->cmd_dmabuf->list,
+ 				      struct lpfc_dmabuf, list);
++>>>>>>> 1dec1311b9b6 (scsi: lpfc: Fix list_entry null check warning in lpfc_cmpl_els_plogi())
  		if (!prsp)
  			goto out;
  		if (!lpfc_is_els_acc_rsp(prsp))
* Unmerged path drivers/scsi/lpfc/lpfc_els.c
