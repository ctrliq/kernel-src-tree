ASoC: wm_adsp: Move check of dsp->running to better place

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Simon Trimmer <simont@opensource.cirrus.com>
commit edb1d6d7f03913b2b6ca299b1f6fd8dc96d511f5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/edb1d6d7.failed

In preparation for moving the generic DSP support out of ASoC, move
the check of dsp->running to a more appropriate place that will move
to the generic code.

	Signed-off-by: Simon Trimmer <simont@opensource.cirrus.com>
	Signed-off-by: Charles Keepax <ckeepax@opensource.cirrus.com>
Link: https://lore.kernel.org/r/20210913160057.103842-12-simont@opensource.cirrus.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit edb1d6d7f03913b2b6ca299b1f6fd8dc96d511f5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/codecs/wm_adsp.c
diff --cc sound/soc/codecs/wm_adsp.c
index c1b5ea3b5718,1c8bf818dab9..000000000000
--- a/sound/soc/codecs/wm_adsp.c
+++ b/sound/soc/codecs/wm_adsp.c
@@@ -979,7 -976,10 +979,14 @@@ static int wm_coeff_write_acked_control
  	unsigned int reg;
  	int i, ret;
  
++<<<<<<< HEAD
 +	ret = wm_coeff_base_reg(ctl, &reg);
++=======
+ 	if (!dsp->running)
+ 		return -EPERM;
+ 
+ 	ret = cs_dsp_coeff_base_reg(ctl, &reg);
++>>>>>>> edb1d6d7f039 (ASoC: wm_adsp: Move check of dsp->running to better place)
  	if (ret)
  		return ret;
  
@@@ -1127,10 -1130,10 +1134,15 @@@ static int wm_coeff_put_acked(struct sn
  	if (val == 0)
  		return 0;	/* 0 means no event */
  
 -	mutex_lock(&cs_ctl->dsp->pwr_lock);
 +	mutex_lock(&ctl->dsp->pwr_lock);
  
++<<<<<<< HEAD
 +	if (ctl->enabled && ctl->dsp->running)
 +		ret = wm_coeff_write_acked_control(ctl, val);
++=======
+ 	if (cs_ctl->enabled)
+ 		ret = cs_dsp_coeff_write_acked_control(cs_ctl, val);
++>>>>>>> edb1d6d7f039 (ASoC: wm_adsp: Move check of dsp->running to better place)
  	else
  		ret = -EPERM;
  
* Unmerged path sound/soc/codecs/wm_adsp.c
