ALSA: hda/realtek: Add quirk for Lenovo Yoga9 14IAP7

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Philipp Jungkamp <p.jungkamp@gmx.net>
commit 3790a3d6dbbc48e30586e9c3fc752a00e2e11946
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/3790a3d6.failed

The Lenovo Yoga 9 14IAP7 is set up similarly to the Thinkpad X1 7th and
8th Gen. It also has the speakers attached to NID 0x14 and the bass
speakers to NID 0x17, but here the codec misreports the NID 0x17 as
unconnected.

The pincfg and hda verbs connect and activate the bass speaker
amplifiers, but the generic driver will connect them to NID 0x06 which
has no volume control. Set connection list/preferred connections is
required to gain volume control.

BugLink: https://bugzilla.kernel.org/show_bug.cgi?id=208555
	Signed-off-by: Philipp Jungkamp <p.jungkamp@gmx.net>
	Cc: <stable@vger.kernel.org>
Link: https://lore.kernel.org/r/20220729162103.6062-1-p.jungkamp@gmx.net
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 3790a3d6dbbc48e30586e9c3fc752a00e2e11946)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/patch_realtek.c
diff --cc sound/pci/hda/patch_realtek.c
index 84b6257b318c,cca093cb643e..000000000000
--- a/sound/pci/hda/patch_realtek.c
+++ b/sound/pci/hda/patch_realtek.c
@@@ -7075,6 -7090,9 +7112,12 @@@ enum 
  	ALC245_FIXUP_CS35L41_SPI_4_HP_GPIO_LED,
  	ALC285_FIXUP_HP_SPEAKERS_MICMUTE_LED,
  	ALC295_FIXUP_FRAMEWORK_LAPTOP_MIC_NO_PRESENCE,
++<<<<<<< HEAD
++=======
+ 	ALC287_FIXUP_LEGION_16ITHG6,
+ 	ALC287_FIXUP_YOGA9_14IAP7_BASS_SPK,
+ 	ALC287_FIXUP_YOGA9_14IAP7_BASS_SPK_PIN,
++>>>>>>> 3790a3d6dbbc (ALSA: hda/realtek: Add quirk for Lenovo Yoga9 14IAP7)
  };
  
  /* A special fixup for Lenovo C940 and Yoga Duet 7;
@@@ -8917,6 -8935,78 +8960,81 @@@ static const struct hda_fixup alc269_fi
  		.chained = true,
  		.chain_id = ALC269_FIXUP_HEADSET_MODE_NO_HP_MIC
  	},
++<<<<<<< HEAD
++=======
+ 	[ALC287_FIXUP_LEGION_16ITHG6] = {
+ 		.type = HDA_FIXUP_FUNC,
+ 		.v.func = alc287_fixup_legion_16ithg6_speakers,
+ 	},
+ 	[ALC287_FIXUP_YOGA9_14IAP7_BASS_SPK] = {
+ 		.type = HDA_FIXUP_VERBS,
+ 		.v.verbs = (const struct hda_verb[]) {
+ 			// enable left speaker
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x24 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x41 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xc },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x1a },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xf },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x42 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x10 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x40 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x2 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			// enable right speaker
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x24 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x46 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xc },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x2a },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xf },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x46 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x10 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x44 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x26 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x2 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x0 },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0xb020 },
+ 
+ 			{ },
+ 		},
+ 	},
+ 	[ALC287_FIXUP_YOGA9_14IAP7_BASS_SPK_PIN] = {
+ 		.type = HDA_FIXUP_FUNC,
+ 		.v.func = alc287_fixup_yoga9_14iap7_bass_spk_pin,
+ 		.chained = true,
+ 		.chain_id = ALC287_FIXUP_YOGA9_14IAP7_BASS_SPK,
+ 	},
++>>>>>>> 3790a3d6dbbc (ALSA: hda/realtek: Add quirk for Lenovo Yoga9 14IAP7)
  };
  
  static const struct snd_pci_quirk alc269_fixup_tbl[] = {
* Unmerged path sound/pci/hda/patch_realtek.c
