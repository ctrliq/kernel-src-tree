ASoC: SOF: debug: Clarify the IPC timeout handling path

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Peter Ujfalusi <peter.ujfalusi@linux.intel.com>
commit 145cb4e7a9ee12326f99948d8980ad258462b6c4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/145cb4e7.failed

The dmesg log message of "Firmware exception" causes lots of confusion as
the snd_sof_handle_fw_exception() is only called in case of an IPC tx
timeout, where such a message does not make much sense.

To not limit the snd_sof_handle_fw_exception() handler to just one error
case, add a parameter to allow the caller to specify a meaningful message
to be printed.

	Signed-off-by: Peter Ujfalusi <peter.ujfalusi@linux.intel.com>
	Reviewed-by: Ranjani Sridharan <ranjani.sridharan@linux.intel.com>
	Reviewed-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
	Reviewed-by: Yaochun Hung <yc.hung@mediatek.com>
Link: https://lore.kernel.org/r/20220610080421.31453-1-peter.ujfalusi@linux.intel.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 145cb4e7a9ee12326f99948d8980ad258462b6c4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/sof/debug.c
#	sound/soc/sof/ipc3.c
#	sound/soc/sof/sof-priv.h
diff --cc sound/soc/sof/debug.c
index c576b602e51e,c5d797e97c02..000000000000
--- a/sound/soc/sof/debug.c
+++ b/sound/soc/sof/debug.c
@@@ -1017,8 -441,7 +1017,13 @@@ void snd_sof_handle_fw_exception(struc
  
  	/* dump vital information to the logs */
  	snd_sof_ipc_dump(sdev);
++<<<<<<< HEAD
 +	snd_sof_dsp_dbg_dump(sdev, "Firmware exception",
 +			     SOF_DBG_DUMP_REGS | SOF_DBG_DUMP_MBOX);
 +	snd_sof_trace_notify_for_error(sdev);
++=======
+ 	snd_sof_dsp_dbg_dump(sdev, msg, SOF_DBG_DUMP_REGS | SOF_DBG_DUMP_MBOX);
+ 	sof_fw_trace_fw_crashed(sdev);
++>>>>>>> 145cb4e7a9ee (ASoC: SOF: debug: Clarify the IPC timeout handling path)
  }
  EXPORT_SYMBOL(snd_sof_handle_fw_exception);
diff --cc sound/soc/sof/sof-priv.h
index 0972440dcebe,32c152528f1d..000000000000
--- a/sound/soc/sof/sof-priv.h
+++ b/sound/soc/sof/sof-priv.h
@@@ -597,9 -655,7 +597,13 @@@ void sof_print_oops_and_stack(struct sn
  			      u32 panic_code, u32 tracep_code, void *oops,
  			      struct sof_ipc_panic_info *panic_info,
  			      void *stack, size_t stack_words);
++<<<<<<< HEAD
 +void snd_sof_trace_suspend(struct snd_sof_dev *sdev, pm_message_t pm_state);
 +int snd_sof_trace_resume(struct snd_sof_dev *sdev);
 +void snd_sof_handle_fw_exception(struct snd_sof_dev *sdev);
++=======
+ void snd_sof_handle_fw_exception(struct snd_sof_dev *sdev, const char *msg);
++>>>>>>> 145cb4e7a9ee (ASoC: SOF: debug: Clarify the IPC timeout handling path)
  int snd_sof_dbg_memory_info_init(struct snd_sof_dev *sdev);
  int snd_sof_debugfs_add_region_item_iomem(struct snd_sof_dev *sdev,
  		enum snd_sof_fw_blk_type blk_type, u32 offset, size_t size,
* Unmerged path sound/soc/sof/ipc3.c
* Unmerged path sound/soc/sof/debug.c
* Unmerged path sound/soc/sof/ipc3.c
* Unmerged path sound/soc/sof/sof-priv.h
