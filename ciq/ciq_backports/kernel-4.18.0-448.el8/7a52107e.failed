wifi: mac80211_hwsim: split bss_info_changed to vif/link info_changed

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Shaul Triebitz <shaul.triebitz@intel.com>
commit 7a52107e441effadd850a7bf155c4719205ad6d7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/7a52107e.failed

Replace the bss_info_changed callback with vif_cfg_changed
and link_info_changed callbacks (for vif changes and link
changes).

	Signed-off-by: Shaul Triebitz <shaul.triebitz@intel.com>
	Signed-off-by: Johannes Berg <johannes.berg@intel.com>
(cherry picked from commit 7a52107e441effadd850a7bf155c4719205ad6d7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/mac80211_hwsim.c
diff --cc drivers/net/wireless/mac80211_hwsim.c
index bd7a5899132f,be83904c642b..000000000000
--- a/drivers/net/wireless/mac80211_hwsim.c
+++ b/drivers/net/wireless/mac80211_hwsim.c
@@@ -2097,31 -2097,44 +2097,49 @@@ static void mac80211_hwsim_bcn_en_iter(
  		(*count)++;
  }
  
- static void mac80211_hwsim_bss_info_changed(struct ieee80211_hw *hw,
+ static void mac80211_hwsim_vif_info_changed(struct ieee80211_hw *hw,
  					    struct ieee80211_vif *vif,
++<<<<<<< HEAD
 +					    struct ieee80211_bss_conf *info,
 +					    u32 changed)
++=======
+ 					    u64 changed)
++>>>>>>> 7a52107e441e (wifi: mac80211_hwsim: split bss_info_changed to vif/link info_changed)
  {
  	struct hwsim_vif_priv *vp = (void *)vif->drv_priv;
- 	struct mac80211_hwsim_data *data = hw->priv;
  
  	hwsim_check_magic(vif);
  
 -	wiphy_dbg(hw->wiphy, "%s(changed=0x%llx vif->addr=%pM)\n",
 +	wiphy_dbg(hw->wiphy, "%s(changed=0x%x vif->addr=%pM)\n",
  		  __func__, changed, vif->addr);
  
- 	if (changed & BSS_CHANGED_BSSID) {
- 		wiphy_dbg(hw->wiphy, "%s: BSSID changed: %pM\n",
- 			  __func__, info->bssid);
- 		memcpy(vp->bssid, info->bssid, ETH_ALEN);
- 	}
- 
  	if (changed & BSS_CHANGED_ASSOC) {
  		wiphy_dbg(hw->wiphy, "  ASSOC: assoc=%d aid=%d\n",
 -			  vif->cfg.assoc, vif->cfg.aid);
 -		vp->assoc = vif->cfg.assoc;
 -		vp->aid = vif->cfg.aid;
 +			  info->assoc, info->aid);
 +		vp->assoc = info->assoc;
 +		vp->aid = info->aid;
  	}
+ }
+ 
+ static void mac80211_hwsim_link_info_changed(struct ieee80211_hw *hw,
+ 					     struct ieee80211_vif *vif,
+ 					     u32 link_id,
+ 					     u64 changed)
+ {
+ 	struct hwsim_vif_priv *vp = (void *)vif->drv_priv;
+ 	struct mac80211_hwsim_data *data = hw->priv;
+ 	struct ieee80211_bss_conf *info = vif->link_conf[link_id];
+ 
+ 	hwsim_check_magic(vif);
+ 
+ 	wiphy_dbg(hw->wiphy, "%s(changed=0x%llx vif->addr=%pM)\n",
+ 		  __func__, (unsigned long long)changed, vif->addr);
+ 
+ 	if (changed & BSS_CHANGED_BSSID) {
+ 		wiphy_dbg(hw->wiphy, "%s: BSSID changed: %pM\n",
+ 			  __func__, info->bssid);
+ 		memcpy(vp->bssid, info->bssid, ETH_ALEN);
+ 	}
  
  	if (changed & BSS_CHANGED_BEACON_ENABLED) {
  		wiphy_dbg(hw->wiphy, "  BCN EN: %d (BI=%u)\n",
* Unmerged path drivers/net/wireless/mac80211_hwsim.c
