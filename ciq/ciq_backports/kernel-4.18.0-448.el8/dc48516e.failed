net/mlx5: Lag, add support to create definers for LAG

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Maor Gottlieb <maorg@nvidia.com>
commit dc48516ec7d369c6b80bf9f14d774287b6c428aa
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/dc48516e.failed

Every definer will consist of a flow table with a single hash group
with exactly two flow table entries, one for each device port.
The destination of these entries is the uplink vport according to the
port state and hash policy.

	Signed-off-by: Maor Gottlieb <maorg@nvidia.com>
	Reviewed-by: Mark Bloch <mbloch@nvidia.com>
	Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
(cherry picked from commit dc48516ec7d369c6b80bf9f14d774287b6c428aa)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/lag/port_sel.c
#	drivers/net/ethernet/mellanox/mlx5/core/lag/port_sel.h
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/lag/port_sel.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/lag/port_sel.h
diff --git a/drivers/net/ethernet/mellanox/mlx5/core/lag.c b/drivers/net/ethernet/mellanox/mlx5/core/lag.c
index ca594cc6ecb7..98f537afedc8 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/lag.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/lag.c
@@ -593,8 +593,10 @@ static int mlx5_handle_changeupper_event(struct mlx5_lag *ldev,
 	if (!(bond_status & 0x3))
 		return 0;
 
-	if (lag_upper_info)
+	if (lag_upper_info) {
 		tracker->tx_type = lag_upper_info->tx_type;
+		tracker->hash_type = lag_upper_info->hash_type;
+	}
 
 	/* Determine bonding status:
 	 * A device is considered bonded if both its physical ports are slaves
diff --git a/drivers/net/ethernet/mellanox/mlx5/core/lag.h b/drivers/net/ethernet/mellanox/mlx5/core/lag.h
index d4bae528954e..14a6d2934b5a 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/lag.h
+++ b/drivers/net/ethernet/mellanox/mlx5/core/lag.h
@@ -32,6 +32,7 @@ struct lag_tracker {
 	enum   netdev_lag_tx_type           tx_type;
 	struct netdev_lag_lower_state_info  netdev_state[MLX5_MAX_PORTS];
 	unsigned int is_bonded:1;
+	enum netdev_lag_hash hash_type;
 };
 
 /* LAG data of a ConnectX card.
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/lag/port_sel.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/lag/port_sel.h
