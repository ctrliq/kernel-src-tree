cpuidle: menu: Take negative "sleep length" values into account

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Rafael J. Wysocki <rafael.j.wysocki@intel.com>
commit 060e3535adf5c961b01421b9fdaddab8dd43ba85
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/060e3535.failed

Make the menu governor check the tick_nohz_get_next_hrtimer()
return value so as to avoid dealing with negative "sleep length"
values and make it use that value directly when the tick is stopped.

While at it, rename local variable delta_next in menu_select() to
delta_tick which better reflects its purpose.

	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit 060e3535adf5c961b01421b9fdaddab8dd43ba85)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/cpuidle/governors/menu.c
diff --cc drivers/cpuidle/governors/menu.c
index 7b2fe0840b2d,c3aa8d6ccee3..000000000000
--- a/drivers/cpuidle/governors/menu.c
+++ b/drivers/cpuidle/governors/menu.c
@@@ -272,8 -270,8 +272,13 @@@ static int menu_select(struct cpuidle_d
  	unsigned int predicted_us;
  	u64 predicted_ns;
  	u64 interactivity_req;
++<<<<<<< HEAD
 +	unsigned int nr_iowaiters;
 +	ktime_t delta_next;
++=======
+ 	unsigned long nr_iowaiters;
+ 	ktime_t delta, delta_tick;
++>>>>>>> 060e3535adf5 (cpuidle: menu: Take negative "sleep length" values into account)
  	int i, idx;
  
  	if (data->needs_update) {
* Unmerged path drivers/cpuidle/governors/menu.c
