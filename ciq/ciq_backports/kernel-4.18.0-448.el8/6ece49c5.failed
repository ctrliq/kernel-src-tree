spi: amd: Limit max transfer and message size

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Cristian Ciocaltea <cristian.ciocaltea@collabora.com>
commit 6ece49c56965544262523dae4a071ace3db63507
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/6ece49c5.failed

Enabling the SPI CS35L41 audio codec driver for Steam Deck [1]
revealed a problem with the current AMD SPI controller driver
implementation, consisting of an unrecoverable system hang.

The issue can be prevented if we ensure the max transfer size
and the max message size do not exceed the FIFO buffer size.

According to the implementation of the downstream driver, the
AMD SPI controller is not able to handle more than 70 bytes per
transfer, which corresponds to the size of the FIFO buffer.

Hence, let's fix this by setting the SPI limits mentioned above.

[1] https://lore.kernel.org/r/20220621213819.262537-1-cristian.ciocaltea@collabora.com

	Reported-by: Anastasios Vacharakis <vacharakis@o2mail.de>
Fixes: bbb336f39efc ("spi: spi-amd: Add AMD SPI controller driver support")
	Signed-off-by: Cristian Ciocaltea <cristian.ciocaltea@collabora.com>
Link: https://lore.kernel.org/r/20220706100626.1234731-2-cristian.ciocaltea@collabora.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 6ece49c56965544262523dae4a071ace3db63507)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/spi/spi-amd.c
* Unmerged path drivers/spi/spi-amd.c
* Unmerged path drivers/spi/spi-amd.c
