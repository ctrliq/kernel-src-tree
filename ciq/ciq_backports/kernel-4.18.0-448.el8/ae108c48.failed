selftests: net: Fix cross-tree inclusion of scripts

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Benjamin Poirier <bpoirier@nvidia.com>
commit ae108c48b5d2b34bcef3c4fb5076f42c922c426a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/ae108c48.failed

When exporting and running a subset of selftests via kselftest, files from
parts of the source tree which were not exported are not available. A few
tests are trying to source such files. Address the problem by using
symlinks.

The problem can be reproduced by running:
make -C tools/testing/selftests gen_tar TARGETS="drivers/net/bonding"
[... extract archive ...]
./run_kselftest.sh

or:
make kselftest KBUILD_OUTPUT=/tmp/kselftests TARGETS="drivers/net/bonding"

Fixes: bbb774d921e2 ("net: Add tests for bonding and team address list management")
Fixes: eccd0a80dc7f ("selftests: net: dsa: add a stress test for unlocked FDB operations")
Link: https://lore.kernel.org/netdev/40f04ded-0c86-8669-24b1-9a313ca21076@redhat.com/
	Reported-by: Jonathan Toppins <jtoppins@redhat.com>
	Signed-off-by: Benjamin Poirier <bpoirier@nvidia.com>
	Reviewed-by: Jonathan Toppins <jtoppins@redhat.com>
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit ae108c48b5d2b34bcef3c4fb5076f42c922c426a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/drivers/net/bonding/Makefile
#	tools/testing/selftests/drivers/net/bonding/dev_addr_lists.sh
#	tools/testing/selftests/drivers/net/dsa/test_bridge_fdb_stress.sh
#	tools/testing/selftests/drivers/net/team/Makefile
#	tools/testing/selftests/drivers/net/team/dev_addr_lists.sh
* Unmerged path tools/testing/selftests/drivers/net/bonding/Makefile
* Unmerged path tools/testing/selftests/drivers/net/bonding/dev_addr_lists.sh
* Unmerged path tools/testing/selftests/drivers/net/dsa/test_bridge_fdb_stress.sh
* Unmerged path tools/testing/selftests/drivers/net/team/Makefile
* Unmerged path tools/testing/selftests/drivers/net/team/dev_addr_lists.sh
* Unmerged path tools/testing/selftests/drivers/net/bonding/Makefile
* Unmerged path tools/testing/selftests/drivers/net/bonding/dev_addr_lists.sh
diff --git a/tools/testing/selftests/drivers/net/bonding/net_forwarding_lib.sh b/tools/testing/selftests/drivers/net/bonding/net_forwarding_lib.sh
new file mode 120000
index 000000000000..39c96828c5ef
--- /dev/null
+++ b/tools/testing/selftests/drivers/net/bonding/net_forwarding_lib.sh
@@ -0,0 +1 @@
+../../../net/forwarding/lib.sh
\ No newline at end of file
* Unmerged path tools/testing/selftests/drivers/net/dsa/test_bridge_fdb_stress.sh
* Unmerged path tools/testing/selftests/drivers/net/team/Makefile
* Unmerged path tools/testing/selftests/drivers/net/team/dev_addr_lists.sh
diff --git a/tools/testing/selftests/drivers/net/team/lag_lib.sh b/tools/testing/selftests/drivers/net/team/lag_lib.sh
new file mode 120000
index 000000000000..e1347a10afde
--- /dev/null
+++ b/tools/testing/selftests/drivers/net/team/lag_lib.sh
@@ -0,0 +1 @@
+../bonding/lag_lib.sh
\ No newline at end of file
diff --git a/tools/testing/selftests/drivers/net/team/net_forwarding_lib.sh b/tools/testing/selftests/drivers/net/team/net_forwarding_lib.sh
new file mode 120000
index 000000000000..39c96828c5ef
--- /dev/null
+++ b/tools/testing/selftests/drivers/net/team/net_forwarding_lib.sh
@@ -0,0 +1 @@
+../../../net/forwarding/lib.sh
\ No newline at end of file
diff --git a/tools/testing/selftests/lib.mk b/tools/testing/selftests/lib.mk
index 79910faab711..d3dc61e75b89 100644
--- a/tools/testing/selftests/lib.mk
+++ b/tools/testing/selftests/lib.mk
@@ -75,7 +75,7 @@ endef
 run_tests: all
 ifneq ($(KBUILD_SRC),)
 	@if [ "X$(TEST_PROGS)$(TEST_PROGS_EXTENDED)$(TEST_FILES)" != "X" ]; then \
-		rsync -aq $(TEST_PROGS) $(TEST_PROGS_EXTENDED) $(TEST_FILES) $(OUTPUT); \
+		rsync -aLq $(TEST_PROGS) $(TEST_PROGS_EXTENDED) $(TEST_FILES) $(OUTPUT); \
 	fi
 	@if [ "X$(TEST_PROGS)" != "X" ]; then \
 		$(call RUN_TESTS, $(TEST_GEN_PROGS) $(TEST_CUSTOM_PROGS) $(OUTPUT)/$(TEST_PROGS)) ; \
@@ -88,7 +88,7 @@ endif
 
 define INSTALL_SINGLE_RULE
 	$(if $(INSTALL_LIST),@mkdir -p $(INSTALL_PATH))
-	$(if $(INSTALL_LIST),rsync -a $(INSTALL_LIST) $(INSTALL_PATH)/)
+	$(if $(INSTALL_LIST),rsync -aL $(INSTALL_LIST) $(INSTALL_PATH)/)
 endef
 
 define INSTALL_RULE
