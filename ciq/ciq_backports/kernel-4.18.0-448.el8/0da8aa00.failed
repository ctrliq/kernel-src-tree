net: bonding: Add support for IPV6 ns/na to balance-alb/balance-tlb mode

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Sun Shouxin <sunshouxin@chinatelecom.cn>
commit 0da8aa00bfcfeb3f4e6537dd8e2001e0727ba549
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/0da8aa00.failed

Since ipv6 neighbor solicitation and advertisement messages
isn't handled gracefully in bond6 driver, we can see packet
drop due to inconsistency between mac address in the option
message and source MAC .

Another examples is ipv6 neighbor solicitation and advertisement
messages from VM via tap attached to host bridge, the src mac
might be changed through balance-alb mode, but it is not synced
with Link-layer address in the option message.

The patch implements bond6's tx handle for ipv6 neighbor
solicitation and advertisement messages.

	Suggested-by: Hu Yadi <huyd12@chinatelecom.cn>
	Acked-by: Jay Vosburgh <jay.vosburgh@canonical.com>
	Signed-off-by: Sun Shouxin <sunshouxin@chinatelecom.cn>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 0da8aa00bfcfeb3f4e6537dd8e2001e0727ba549)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/bonding/bond_alb.c
diff --cc drivers/net/bonding/bond_alb.c
index dd62244177c9,c98a4b0a8453..000000000000
--- a/drivers/net/bonding/bond_alb.c
+++ b/drivers/net/bonding/bond_alb.c
@@@ -1349,10 -1369,11 +1370,17 @@@ struct slave *bond_xmit_tlb_slave_get(s
  	/* Do not TX balance any multicast or broadcast */
  	if (!is_multicast_ether_addr(eth_data->h_dest)) {
  		switch (skb->protocol) {
++<<<<<<< HEAD
 +		case htons(ETH_P_IP):
 +		case htons(ETH_P_IPX):
 +		    /* In case of IPX, it will falback to L2 hash */
++=======
++>>>>>>> 0da8aa00bfcf (net: bonding: Add support for IPV6 ns/na to balance-alb/balance-tlb mode)
  		case htons(ETH_P_IPV6):
+ 			if (alb_determine_nd(skb, bond))
+ 				break;
+ 			fallthrough;
+ 		case htons(ETH_P_IP):
  			hash_index = bond_xmit_hash(bond, skb);
  			if (bond->params.tlb_dynamic_lb) {
  				tx_slave = tlb_choose_channel(bond,
* Unmerged path drivers/net/bonding/bond_alb.c
