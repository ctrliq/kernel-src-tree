arm64: entry: Move trampoline macros out of ifdef'd section

jira LE-1907
cve CVE-2022-23960
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author James Morse <james.morse@arm.com>
commit 13d7a08352a83ef2252aeb464a5e08dfc06b5dfd
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/13d7a083.failed

The macros for building the kpti trampoline are all behind
CONFIG_UNMAP_KERNEL_AT_EL0, and in a region that outputs to the
.entry.tramp.text section.

Move the macros out so they can be used to generate other kinds of
trampoline. Only the symbols need to be guarded by
CONFIG_UNMAP_KERNEL_AT_EL0 and appear in the .entry.tramp.text section.

	Reviewed-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>
	Reviewed-by: Catalin Marinas <catalin.marinas@arm.com>
	Signed-off-by: James Morse <james.morse@arm.com>
(cherry picked from commit 13d7a08352a83ef2252aeb464a5e08dfc06b5dfd)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/arm64/kernel/entry.S
diff --cc arch/arm64/kernel/entry.S
index ca2830a09872,2735c8941c2d..000000000000
--- a/arch/arm64/kernel/entry.S
+++ b/arch/arm64/kernel/entry.S
@@@ -758,15 -608,10 +758,19 @@@ SYM_CODE_END(ret_to_user
  
  	.popsection				// .entry.text
  
++<<<<<<< HEAD
 +#ifdef CONFIG_UNMAP_KERNEL_AT_EL0
 +/*
 + * Exception vectors trampoline.
 + */
 +	.pushsection ".entry.tramp.text", "ax"
 +
++=======
+ 	// Move from tramp_pg_dir to swapper_pg_dir
++>>>>>>> 13d7a08352a8 (arm64: entry: Move trampoline macros out of ifdef'd section)
  	.macro tramp_map_kernel, tmp
  	mrs	\tmp, ttbr1_el1
 -	add	\tmp, \tmp, #TRAMP_SWAPPER_OFFSET
 +	add	\tmp, \tmp, #(PAGE_SIZE + RESERVED_TTBR0_SIZE)
  	bic	\tmp, \tmp, #USER_ASID_FLAG
  	msr	ttbr1_el1, \tmp
  #ifdef CONFIG_QCOM_FALKOR_ERRATUM_1003
* Unmerged path arch/arm64/kernel/entry.S
