ACPI: battery: Make "not-charging" the default on no charging or full info

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-448.el8
commit-author Werner Sembach <wse@tuxedocomputers.com>
commit 185d20694a8aceb4eda9fc1314cbaad0df0aab07
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-448.el8/185d2069.failed

When the battery is neither charging or discharging and is not full,
"not-charging" is a useful status description for the case in general.
Currently this state is set as "unknown" by default, expect when this is
explicitly replaced with "not-charging" on a per device or per vendor
basis.

A lot of devices have this state without a BIOS specification available
explicitly describing it. e.g. some current Clevo barebones have a BIOS
setting to stop charging at a user defined battery level.

	Signed-off-by: Werner Sembach <wse@tuxedocomputers.com>
	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit 185d20694a8aceb4eda9fc1314cbaad0df0aab07)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/acpi/battery.c
diff --cc drivers/acpi/battery.c
index 4cda8ca22a91,306513fec1e1..000000000000
--- a/drivers/acpi/battery.c
+++ b/drivers/acpi/battery.c
@@@ -77,8 -52,6 +77,11 @@@ static bool battery_driver_registered
  static int battery_bix_broken_package;
  static int battery_notification_delay_ms;
  static int battery_ac_is_broken;
++<<<<<<< HEAD
 +static int battery_check_pmic = 1;
 +static int battery_quirk_notcharging;
++=======
++>>>>>>> 185d20694a8a (ACPI: battery: Make "not-charging" the default on no charging or full info)
  static unsigned int cache_time = 1000;
  module_param(cache_time, uint, 0644);
  MODULE_PARM_DESC(cache_time, "cache time in milliseconds");
@@@ -1355,19 -1102,6 +1356,22 @@@ battery_ac_is_broken_quirk(const struc
  	return 0;
  }
  
++<<<<<<< HEAD
 +static int __init
 +battery_do_not_check_pmic_quirk(const struct dmi_system_id *d)
 +{
 +	battery_check_pmic = 0;
 +	return 0;
 +}
 +
 +static int __init battery_quirk_not_charging(const struct dmi_system_id *d)
 +{
 +	battery_quirk_notcharging = 1;
 +	return 0;
 +}
 +
++=======
++>>>>>>> 185d20694a8a (ACPI: battery: Make "not-charging" the default on no charging or full info)
  static const struct dmi_system_id bat_dmi_table[] __initconst = {
  	{
  		/* NEC LZ750/LS */
@@@ -1397,35 -1131,6 +1401,38 @@@
  		},
  	},
  	{
++<<<<<<< HEAD
 +		/* ECS EF20EA, AXP288 PMIC but uses separate fuel-gauge */
 +		.callback = battery_do_not_check_pmic_quirk,
 +		.matches = {
 +			DMI_MATCH(DMI_PRODUCT_NAME, "EF20EA"),
 +		},
 +	},
 +	{
 +		/* Lenovo Ideapad Miix 320, AXP288 PMIC, separate fuel-gauge */
 +		.callback = battery_do_not_check_pmic_quirk,
 +		.matches = {
 +			DMI_MATCH(DMI_SYS_VENDOR, "LENOVO"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "80XF"),
 +			DMI_MATCH(DMI_PRODUCT_VERSION, "Lenovo MIIX 320-10ICR"),
 +		},
 +	},
 +	{
 +		/*
 +		 * On Lenovo ThinkPads the BIOS specification defines
 +		 * a state when the bits for charging and discharging
 +		 * are both set to 0. That state is "Not Charging".
 +		 */
 +		.callback = battery_quirk_not_charging,
 +		.ident = "Lenovo ThinkPad",
 +		.matches = {
 +			DMI_MATCH(DMI_SYS_VENDOR, "LENOVO"),
 +			DMI_MATCH(DMI_PRODUCT_VERSION, "ThinkPad"),
 +		},
 +	},
 +	{
++=======
++>>>>>>> 185d20694a8a (ACPI: battery: Make "not-charging" the default on no charging or full info)
  		/* Microsoft Surface Go 3 */
  		.callback = battery_notification_delay_quirk,
  		.matches = {
* Unmerged path drivers/acpi/battery.c
