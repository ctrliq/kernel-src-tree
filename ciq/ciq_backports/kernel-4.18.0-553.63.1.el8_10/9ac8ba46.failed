fs: dlm: handle -EINVAL as log_error()

jira LE-3629
Rebuild_History Non-Buildable kernel-4.18.0-553.63.1.el8_10
commit-author Alexander Aring <aahringo@redhat.com>
commit 9ac8ba46a701b863be3f197d7eece4c635d0afe4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.63.1.el8_10/9ac8ba46.failed

If the user generates -EINVAL it's probably because they are
using DLM incorrectly.  Change the log level to make these
errors more visible.

	Signed-off-by: Alexander Aring <aahringo@redhat.com>
	Signed-off-by: David Teigland <teigland@redhat.com>
(cherry picked from commit 9ac8ba46a701b863be3f197d7eece4c635d0afe4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/dlm/lock.c
diff --cc fs/dlm/lock.c
index 0733727c255c,354f79254d62..000000000000
--- a/fs/dlm/lock.c
+++ b/fs/dlm/lock.c
@@@ -2920,11 -2895,24 +2920,27 @@@ static int validate_lock_args(struct dl
  	lkb->lkb_lksb = args->lksb;
  	lkb->lkb_lvbptr = args->lksb->sb_lvbptr;
  	lkb->lkb_ownpid = (int) current->pid;
 -#ifdef CONFIG_DLM_DEPRECATED_API
  	lkb->lkb_timeout_cs = args->timeout;
 -#endif
  	rv = 0;
   out:
++<<<<<<< HEAD
 +	if (rv)
 +		log_debug(ls, "validate_lock_args %d %x %x %x %d %d %s",
++=======
+ 	switch (rv) {
+ 	case 0:
+ 		break;
+ 	case -EINVAL:
+ 		/* annoy the user because dlm usage is wrong */
+ 		WARN_ON(1);
+ 		log_error(ls, "%s %d %x %x %x %d %d %s", __func__,
+ 			  rv, lkb->lkb_id, lkb->lkb_flags, args->flags,
+ 			  lkb->lkb_status, lkb->lkb_wait_type,
+ 			  lkb->lkb_resource->res_name);
+ 		break;
+ 	default:
+ 		log_debug(ls, "%s %d %x %x %x %d %d %s", __func__,
++>>>>>>> 9ac8ba46a701 (fs: dlm: handle -EINVAL as log_error())
  			  rv, lkb->lkb_id, lkb->lkb_flags, args->flags,
  			  lkb->lkb_status, lkb->lkb_wait_type,
  			  lkb->lkb_resource->res_name);
@@@ -3060,8 -3051,19 +3079,24 @@@ static int validate_unlock_args(struct 
  	lkb->lkb_astparam = args->astparam;
  	rv = 0;
   out:
++<<<<<<< HEAD
 +	if (rv)
 +		log_debug(ls, "validate_unlock_args %d %x %x %x %x %d %s", rv,
++=======
+ 	switch (rv) {
+ 	case 0:
+ 		break;
+ 	case -EINVAL:
+ 		/* annoy the user because dlm usage is wrong */
+ 		WARN_ON(1);
+ 		log_error(ls, "%s %d %x %x %x %x %d %s", __func__, rv,
+ 			  lkb->lkb_id, lkb->lkb_flags, lkb->lkb_exflags,
+ 			  args->flags, lkb->lkb_wait_type,
+ 			  lkb->lkb_resource->res_name);
+ 		break;
+ 	default:
+ 		log_debug(ls, "%s %d %x %x %x %x %d %s", __func__, rv,
++>>>>>>> 9ac8ba46a701 (fs: dlm: handle -EINVAL as log_error())
  			  lkb->lkb_id, lkb->lkb_flags, lkb->lkb_exflags,
  			  args->flags, lkb->lkb_wait_type,
  			  lkb->lkb_resource->res_name);
* Unmerged path fs/dlm/lock.c
