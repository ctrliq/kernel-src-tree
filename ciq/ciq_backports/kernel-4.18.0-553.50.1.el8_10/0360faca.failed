gfs2: Remove more dead code in add_to_queue

jira LE-2815
Rebuild_History Non-Buildable kernel-4.18.0-553.50.1.el8_10
commit-author Andreas Gruenbacher <agruenba@redhat.com>
commit 0360faca5d4dfc18d06644c7661cea1dc2b44dcf
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.50.1.el8_10/0360faca.failed

Remove some more dead code in add_to_queue() that commit 0b93bac2271e
("gfs2: Remove LM_FLAG_PRIORITY flag") has rendered obsolete.  This is a
continuation of commit 3302764610057 ("gfs2: remove dead code in
add_to_queue"); no functional change.

	Signed-off-by: Andreas Gruenbacher <agruenba@redhat.com>
(cherry picked from commit 0360faca5d4dfc18d06644c7661cea1dc2b44dcf)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/gfs2/glock.c
diff --cc fs/gfs2/glock.c
index 5dc035ea3dca,dd82bc27c27a..000000000000
--- a/fs/gfs2/glock.c
+++ b/fs/gfs2/glock.c
@@@ -1503,29 -1518,11 +1502,36 @@@ fail
  			gfs2_holder_wake(gh);
  			return;
  		}
++<<<<<<< HEAD
 +		if (test_bit(HIF_HOLDER, &gh2->gh_iflags))
 +			continue;
 +		if (unlikely((gh->gh_flags & LM_FLAG_PRIORITY) && !insert_pt))
 +			insert_pt = &gh2->gh_list;
++=======
++>>>>>>> 0360faca5d4d (gfs2: Remove more dead code in add_to_queue)
  	}
  	trace_gfs2_glock_queue(gh, 1);
  	gfs2_glstats_inc(gl, GFS2_LKS_QCOUNT);
  	gfs2_sbstats_inc(gl, GFS2_LKS_QCOUNT);
++<<<<<<< HEAD
 +	if (likely(insert_pt == NULL)) {
 +		list_add_tail(&gh->gh_list, &gl->gl_holders);
 +		if (unlikely(gh->gh_flags & LM_FLAG_PRIORITY))
 +			goto do_cancel;
 +		return;
 +	}
 +	list_add_tail(&gh->gh_list, insert_pt);
 +do_cancel:
 +	gh = list_first_entry(&gl->gl_holders, struct gfs2_holder, gh_list);
 +	if (!(gh->gh_flags & LM_FLAG_PRIORITY)) {
 +		spin_unlock(&gl->gl_lockref.lock);
 +		if (sdp->sd_lockstruct.ls_ops->lm_cancel)
 +			sdp->sd_lockstruct.ls_ops->lm_cancel(gl);
 +		spin_lock(&gl->gl_lockref.lock);
 +	}
++=======
+ 	list_add_tail(&gh->gh_list, &gl->gl_holders);
++>>>>>>> 0360faca5d4d (gfs2: Remove more dead code in add_to_queue)
  	return;
  
  trap_recursive:
* Unmerged path fs/gfs2/glock.c
