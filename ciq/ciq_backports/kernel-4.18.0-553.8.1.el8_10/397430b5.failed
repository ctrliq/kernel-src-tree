usbnet: sanity check for maxpacket

jira LE-1907
cve CVE-2021-47495
Rebuild_History Non-Buildable kernel-4.18.0-553.8.1.el8_10
commit-author Oliver Neukum <oneukum@suse.com>
commit 397430b50a363d8b7bdda00522123f82df6adc5e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.8.1.el8_10/397430b5.failed

maxpacket of 0 makes no sense and oopses as we need to divide
by it. Give up.

V2: fixed typo in log and stylistic issues

	Signed-off-by: Oliver Neukum <oneukum@suse.com>
	Reported-by: syzbot+76bb1d34ffa0adc03baa@syzkaller.appspotmail.com
	Reviewed-by: Johan Hovold <johan@kernel.org>
Link: https://lore.kernel.org/r/20211021122944.21816-1-oneukum@suse.com
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 397430b50a363d8b7bdda00522123f82df6adc5e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/usb/usbnet.c
diff --cc drivers/net/usb/usbnet.c
index 6fbdc6cdf184,80432ee0ce69..000000000000
--- a/drivers/net/usb/usbnet.c
+++ b/drivers/net/usb/usbnet.c
@@@ -1780,7 -1787,11 +1780,15 @@@ usbnet_probe (struct usb_interface *ude
  
  	if (!dev->rx_urb_size)
  		dev->rx_urb_size = dev->hard_mtu;
++<<<<<<< HEAD
 +	dev->maxpacket = usb_maxpacket(dev->udev, dev->out);
++=======
+ 	dev->maxpacket = usb_maxpacket (dev->udev, dev->out, 1);
+ 	if (dev->maxpacket == 0) {
+ 		/* that is a broken device */
+ 		goto out4;
+ 	}
++>>>>>>> 397430b50a36 (usbnet: sanity check for maxpacket)
  
  	/* let userspace know we have a random address */
  	if (ether_addr_equal(net->dev_addr, node_id))
* Unmerged path drivers/net/usb/usbnet.c
