usbnet: fix error return code in usbnet_probe()

jira LE-1907
cve CVE-2021-47495
Rebuild_History Non-Buildable kernel-4.18.0-553.8.1.el8_10
commit-author Wang Hai <wanghai38@huawei.com>
commit 6f7c88691191e6c52ef2543d6f1da8d360b27a24
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.8.1.el8_10/6f7c8869.failed

Return error code if usb_maxpacket() returns 0 in usbnet_probe()

Fixes: 397430b50a36 ("usbnet: sanity check for maxpacket")
	Reported-by: Hulk Robot <hulkci@huawei.com>
	Signed-off-by: Wang Hai <wanghai38@huawei.com>
	Reviewed-by: Johan Hovold <johan@kernel.org>
Link: https://lore.kernel.org/r/20211026124015.3025136-1-wanghai38@huawei.com
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 6f7c88691191e6c52ef2543d6f1da8d360b27a24)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/usb/usbnet.c
diff --cc drivers/net/usb/usbnet.c
index 6fbdc6cdf184,a33d7fb82a00..000000000000
--- a/drivers/net/usb/usbnet.c
+++ b/drivers/net/usb/usbnet.c
@@@ -1780,7 -1787,12 +1780,16 @@@ usbnet_probe (struct usb_interface *ude
  
  	if (!dev->rx_urb_size)
  		dev->rx_urb_size = dev->hard_mtu;
++<<<<<<< HEAD
 +	dev->maxpacket = usb_maxpacket(dev->udev, dev->out);
++=======
+ 	dev->maxpacket = usb_maxpacket (dev->udev, dev->out, 1);
+ 	if (dev->maxpacket == 0) {
+ 		/* that is a broken device */
+ 		status = -ENODEV;
+ 		goto out4;
+ 	}
++>>>>>>> 6f7c88691191 (usbnet: fix error return code in usbnet_probe())
  
  	/* let userspace know we have a random address */
  	if (ether_addr_equal(net->dev_addr, node_id))
* Unmerged path drivers/net/usb/usbnet.c
