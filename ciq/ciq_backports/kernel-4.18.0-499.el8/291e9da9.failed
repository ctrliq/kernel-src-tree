ALSA: usb-audio: Always initialize fixed_rate in snd_usb_find_implicit_fb_sync_format()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-499.el8
commit-author Jaroslav Kysela <perex@perex.cz>
commit 291e9da91403e0e628d7692b5ed505100e7b7706
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-499.el8/291e9da9.failed

Handle the fallback code path, too.

Fixes: fd28941cff1c ("ALSA: usb-audio: Add new quirk FIXED_RATE for JBL Quantum810 Wireless")
BugLink: https://lore.kernel.org/alsa-devel/Y7frf3N%2FxzvESEsN@kili/
	Reported-by: Dan Carpenter <error27@gmail.com>
	Cc: <stable@vger.kernel.org>
	Signed-off-by: Jaroslav Kysela <perex@perex.cz>
Link: https://lore.kernel.org/r/20230109141133.335543-1-perex@perex.cz
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 291e9da91403e0e628d7692b5ed505100e7b7706)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/usb/implicit.c
#	sound/usb/pcm.c
diff --cc sound/usb/implicit.c
index f3e8484b3d9c,4727043fd745..000000000000
--- a/sound/usb/implicit.c
+++ b/sound/usb/implicit.c
@@@ -483,6 -485,9 +483,12 @@@ snd_usb_find_implicit_fb_sync_format(st
  		}
  	}
  
++<<<<<<< HEAD
++=======
+  end:
+ 	if (fixed_rate)
+ 		*fixed_rate = snd_usb_pcm_has_fixed_rate(subs);
++>>>>>>> 291e9da91403 (ALSA: usb-audio: Always initialize fixed_rate in snd_usb_find_implicit_fb_sync_format())
  	return sync_fmt;
  }
  
diff --cc sound/usb/pcm.c
index 42f463696ebf,1f72960d0d53..000000000000
--- a/sound/usb/pcm.c
+++ b/sound/usb/pcm.c
@@@ -156,6 -157,33 +156,36 @@@ find_substream_format(struct snd_usb_su
  			   true, subs);
  }
  
++<<<<<<< HEAD
++=======
+ bool snd_usb_pcm_has_fixed_rate(struct snd_usb_substream *subs)
+ {
+ 	const struct audioformat *fp;
+ 	struct snd_usb_audio *chip = subs->stream->chip;
+ 	int rate = -1;
+ 
+ 	if (!subs)
+ 		return false;
+ 	if (!(chip->quirk_flags & QUIRK_FLAG_FIXED_RATE))
+ 		return false;
+ 	list_for_each_entry(fp, &subs->fmt_list, list) {
+ 		if (fp->rates & SNDRV_PCM_RATE_CONTINUOUS)
+ 			return false;
+ 		if (fp->nr_rates < 1)
+ 			continue;
+ 		if (fp->nr_rates > 1)
+ 			return false;
+ 		if (rate < 0) {
+ 			rate = fp->rate_table[0];
+ 			continue;
+ 		}
+ 		if (rate != fp->rate_table[0])
+ 			return false;
+ 	}
+ 	return true;
+ }
+ 
++>>>>>>> 291e9da91403 (ALSA: usb-audio: Always initialize fixed_rate in snd_usb_find_implicit_fb_sync_format())
  static int init_pitch_v1(struct snd_usb_audio *chip, int ep)
  {
  	struct usb_device *dev = chip->dev;
* Unmerged path sound/usb/implicit.c
* Unmerged path sound/usb/pcm.c
