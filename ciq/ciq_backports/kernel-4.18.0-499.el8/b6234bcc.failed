soundwire: intel: add register_dai callback in hw_ops

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-499.el8
commit-author Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
commit b6234bcc6589a0719ec91d810114c0b556a5b88b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-499.el8/b6234bcc.failed

No functionality change, only add indirection for DAI registration
helper.

	Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
	Reviewed-by: Rander Wang <rander.wang@intel.com>
	Signed-off-by: Bard Liao <yung-chuan.liao@linux.intel.com>
Link: https://lore.kernel.org/r/20221111013135.38289-4-yung-chuan.liao@linux.intel.com
	Signed-off-by: Vinod Koul <vkoul@kernel.org>
(cherry picked from commit b6234bcc6589a0719ec91d810114c0b556a5b88b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/soundwire/intel.c
#	drivers/soundwire/intel.h
#	include/linux/soundwire/sdw_intel.h
diff --cc drivers/soundwire/intel.c
index b9cb7e31ddb3,0496eb0d6084..000000000000
--- a/drivers/soundwire/intel.c
+++ b/drivers/soundwire/intel.c
@@@ -1422,6 -1422,33 +1422,36 @@@ static int intel_stop_bus(struct sdw_in
  	return 0;
  }
  
++<<<<<<< HEAD
++=======
+ const struct sdw_intel_hw_ops sdw_intel_cnl_hw_ops = {
+ 	.debugfs_init = intel_debugfs_init,
+ 	.debugfs_exit = intel_debugfs_exit,
+ 
+ 	.register_dai = intel_register_dai,
+ 
+ 	.pre_bank_switch = intel_pre_bank_switch,
+ 	.post_bank_switch = intel_post_bank_switch,
+ };
+ EXPORT_SYMBOL_NS(sdw_intel_cnl_hw_ops, SOUNDWIRE_INTEL);
+ 
+ static int generic_pre_bank_switch(struct sdw_bus *bus)
+ {
+ 	struct sdw_cdns *cdns = bus_to_cdns(bus);
+ 	struct sdw_intel *sdw = cdns_to_intel(cdns);
+ 
+ 	return sdw->link_res->hw_ops->pre_bank_switch(sdw);
+ }
+ 
+ static int generic_post_bank_switch(struct sdw_bus *bus)
+ {
+ 	struct sdw_cdns *cdns = bus_to_cdns(bus);
+ 	struct sdw_intel *sdw = cdns_to_intel(cdns);
+ 
+ 	return sdw->link_res->hw_ops->post_bank_switch(sdw);
+ }
+ 
++>>>>>>> b6234bcc6589 (soundwire: intel: add register_dai callback in hw_ops)
  static int sdw_master_read_intel_prop(struct sdw_bus *bus)
  {
  	struct sdw_master_prop *prop = &bus->prop;
diff --cc drivers/soundwire/intel.h
index cd93a44dba9a,0521cab311a3..000000000000
--- a/drivers/soundwire/intel.h
+++ b/drivers/soundwire/intel.h
@@@ -58,4 -61,27 +58,30 @@@ struct sdw_intel_link_dev 
  #define auxiliary_dev_to_sdw_intel_link_dev(auxiliary_dev) \
  	container_of(auxiliary_dev, struct sdw_intel_link_dev, auxdev)
  
++<<<<<<< HEAD
++=======
+ #define SDW_INTEL_CHECK_OPS(sdw, cb)	((sdw) && (sdw)->link_res && (sdw)->link_res->hw_ops && \
+ 					 (sdw)->link_res->hw_ops->cb)
+ #define SDW_INTEL_OPS(sdw, cb)		((sdw)->link_res->hw_ops->cb)
+ 
+ static inline void sdw_intel_debugfs_init(struct sdw_intel *sdw)
+ {
+ 	if (SDW_INTEL_CHECK_OPS(sdw, debugfs_init))
+ 		SDW_INTEL_OPS(sdw, debugfs_init)(sdw);
+ }
+ 
+ static inline void sdw_intel_debugfs_exit(struct sdw_intel *sdw)
+ {
+ 	if (SDW_INTEL_CHECK_OPS(sdw, debugfs_exit))
+ 		SDW_INTEL_OPS(sdw, debugfs_exit)(sdw);
+ }
+ 
+ static inline int sdw_intel_register_dai(struct sdw_intel *sdw)
+ {
+ 	if (SDW_INTEL_CHECK_OPS(sdw, register_dai))
+ 		return SDW_INTEL_OPS(sdw, register_dai)(sdw);
+ 	return -ENOTSUPP;
+ }
+ 
++>>>>>>> b6234bcc6589 (soundwire: intel: add register_dai callback in hw_ops)
  #endif /* __SDW_INTEL_LOCAL_H */
diff --cc include/linux/soundwire/sdw_intel.h
index 2e9fd91572d4,5be63d4fe62e..000000000000
--- a/include/linux/soundwire/sdw_intel.h
+++ b/include/linux/soundwire/sdw_intel.h
@@@ -292,4 -294,25 +292,28 @@@ irqreturn_t sdw_intel_thread(int irq, v
  
  #define SDW_INTEL_QUIRK_MASK_BUS_DISABLE      BIT(1)
  
++<<<<<<< HEAD
++=======
+ struct sdw_intel;
+ 
+ /* struct intel_sdw_hw_ops - SoundWire ops for Intel platforms.
+  * @debugfs_init: initialize all debugfs capabilities
+  * @debugfs_exit: close and cleanup debugfs capabilities
+  * @register_dai: read all PDI information and register DAIs
+  * @pre_bank_switch: helper for bus management
+  * @post_bank_switch: helper for bus management
+  */
+ struct sdw_intel_hw_ops {
+ 	void (*debugfs_init)(struct sdw_intel *sdw);
+ 	void (*debugfs_exit)(struct sdw_intel *sdw);
+ 
+ 	int (*register_dai)(struct sdw_intel *sdw);
+ 
+ 	int (*pre_bank_switch)(struct sdw_intel *sdw);
+ 	int (*post_bank_switch)(struct sdw_intel *sdw);
+ };
+ 
+ extern const struct sdw_intel_hw_ops sdw_intel_cnl_hw_ops;
+ 
++>>>>>>> b6234bcc6589 (soundwire: intel: add register_dai callback in hw_ops)
  #endif
* Unmerged path drivers/soundwire/intel.c
* Unmerged path drivers/soundwire/intel.h
* Unmerged path include/linux/soundwire/sdw_intel.h
