ASoC: Intel: Skylake: fix possible memory leak in skl_codec_device_init()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-499.el8
commit-author Yang Yingliang <yangyingliang@huawei.com>
commit 0e213813df02da048ffd22a2c4fac041768ca327
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-499.el8/0e213813.failed

If snd_hdac_device_register() fails, 'codec' and name allocated in
dev_set_name() called in snd_hdac_device_init() are leaked. Fix this
by calling put_device(), so they can be freed in snd_hda_codec_dev_release()
and kobject_cleanup().

Fixes: e4746d94d00c ("ASoC: Intel: Skylake: Introduce HDA codec init and exit routines")
	Signed-off-by: Yang Yingliang <yangyingliang@huawei.com>
	Suggested-by: Cezary Rojewski <cezary.rojewski@intel.com>
Link: https://lore.kernel.org/r/20221020105937.1448951-1-yangyingliang@huawei.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 0e213813df02da048ffd22a2c4fac041768ca327)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/intel/skylake/skl.c
diff --cc sound/soc/intel/skylake/skl.c
index 9dc568c7fd2c,3312b57e3c0c..000000000000
--- a/sound/soc/intel/skylake/skl.c
+++ b/sound/soc/intel/skylake/skl.c
@@@ -680,12 -689,7 +680,16 @@@ static void load_codec_module(struct hd
  
  #endif /* CONFIG_SND_SOC_INTEL_SKYLAKE_HDAUDIO_CODEC */
  
++<<<<<<< HEAD
 +static void skl_codec_device_exit(struct device *dev)
 +{
 +	snd_hdac_device_exit(dev_to_hdac_dev(dev));
 +}
 +
 +static __maybe_unused struct hda_codec *skl_codec_device_init(struct hdac_bus *bus, int addr)
++=======
+ static struct hda_codec *skl_codec_device_init(struct hdac_bus *bus, int addr)
++>>>>>>> 0e213813df02 (ASoC: Intel: Skylake: fix possible memory leak in skl_codec_device_init())
  {
  	struct hda_codec *codec;
  	int ret;
* Unmerged path sound/soc/intel/skylake/skl.c
