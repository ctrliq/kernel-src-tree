ipv6: icmp6: add drop reason support to ndisc_redirect_rcv()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-499.el8
commit-author Eric Dumazet <edumazet@google.com>
commit ec993edf05ca4eee5878edf51fdb5ffa2b1decc3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-499.el8/ec993edf.failed

Change ndisc_redirect_rcv() to return a drop reason.

For the moment, return PKT_TOO_SMALL, NOT_SPECIFIED
and values from icmpv6_notify().

More reasons are added later.

	Signed-off-by: Eric Dumazet <edumazet@google.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit ec993edf05ca4eee5878edf51fdb5ffa2b1decc3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/ndisc.c
diff --cc net/ipv6/ndisc.c
index 33b2d2fbbba7,e9776aa6f167..000000000000
--- a/net/ipv6/ndisc.c
+++ b/net/ipv6/ndisc.c
@@@ -1508,12 -1592,17 +1508,10 @@@ out
  	fib6_info_release(rt);
  	if (neigh)
  		neigh_release(neigh);
 -	return reason;
  }
  
- static void ndisc_redirect_rcv(struct sk_buff *skb)
+ static enum skb_drop_reason ndisc_redirect_rcv(struct sk_buff *skb)
  {
- 	u8 *hdr;
- 	struct ndisc_options ndopts;
  	struct rd_msg *msg = (struct rd_msg *)skb_transport_header(skb);
  	u32 ndoptlen = skb_tail_pointer(skb) - (skb_transport_header(skb) +
  				    offsetof(struct rd_msg, opt));
@@@ -1539,8 -1631,8 +1540,13 @@@
  
  	if (!ndopts.nd_opts_rh) {
  		ip6_redirect_no_header(skb, dev_net(skb->dev),
++<<<<<<< HEAD
 +					skb->dev->ifindex, 0);
 +		return;
++=======
+ 					skb->dev->ifindex);
+ 		return reason;
++>>>>>>> ec993edf05ca (ipv6: icmp6: add drop reason support to ndisc_redirect_rcv())
  	}
  
  	hdr = (u8 *)ndopts.nd_opts_rh;
* Unmerged path net/ipv6/ndisc.c
