KVM: SVM: Add helper to perform final AVIC "kick" of single vCPU

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-499.el8
commit-author Sean Christopherson <seanjc@google.com>
commit 1d22a597b3e9fd4d0a7e921ce4d32321bcad8576
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-499.el8/1d22a597.failed

Add a helper to perform the final kick, two instances of the ICR decoding
is one too many.

No functional change intended.

	Signed-off-by: Sean Christopherson <seanjc@google.com>
	Reviewed-by: Maxim Levitsky <mlevitsk@redhat.com>
Message-Id: <20230106011306.85230-17-seanjc@google.com>
	Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
(cherry picked from commit 1d22a597b3e9fd4d0a7e921ce4d32321bcad8576)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kvm/svm/avic.c
diff --cc arch/x86/kvm/svm/avic.c
index f4768bb6d599,76da9f19272e..000000000000
--- a/arch/x86/kvm/svm/avic.c
+++ b/arch/x86/kvm/svm/avic.c
@@@ -435,14 -449,8 +441,19 @@@ static void avic_kick_target_vcpus(stru
  	 */
  	kvm_for_each_vcpu(i, vcpu, kvm) {
  		if (kvm_apic_match_dest(vcpu, source, icrl & APIC_SHORT_MASK,
++<<<<<<< HEAD
 +					GET_APIC_DEST_FIELD(icrh),
 +					icrl & APIC_DEST_MASK)) {
 +			vcpu->arch.apic->irr_pending = true;
 +			svm_complete_interrupt_delivery(vcpu,
 +							icrl & APIC_MODE_MASK,
 +							icrl & APIC_INT_LEVELTRIG,
 +							icrl & APIC_VECTOR_MASK);
 +		}
++=======
+ 					dest, icrl & APIC_DEST_MASK))
+ 			avic_kick_vcpu(vcpu, icrl);
++>>>>>>> 1d22a597b3e9 (KVM: SVM: Add helper to perform final AVIC "kick" of single vCPU)
  	}
  }
  
* Unmerged path arch/x86/kvm/svm/avic.c
