ipv4: use RCU protection in ip_dst_mtu_maybe_forward()

jira KERNEL-619
Rebuild_History Non-Buildable kernel-5.14.0-611.30.1.el9_7
commit-author Eric Dumazet <edumazet@google.com>
commit 071d8012869b6af352acca346ade13e7be90a49f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-5.14.0-611.30.1.el9_7/071d8012.failed

ip_dst_mtu_maybe_forward() must use RCU protection to make
sure the net structure it reads does not disappear.

Fixes: f87c10a8aa1e8 ("ipv4: introduce ip_dst_mtu_maybe_forward and protect forwarding path against pmtu spoofing")
	Signed-off-by: Eric Dumazet <edumazet@google.com>
	Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Link: https://patch.msgid.link/20250205155120.1676781-4-edumazet@google.com
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 071d8012869b6af352acca346ade13e7be90a49f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/net/ip.h
diff --cc include/net/ip.h
index f98661f56cbd,ba7b43447775..000000000000
--- a/include/net/ip.h
+++ b/include/net/ip.h
@@@ -443,10 -470,13 +443,19 @@@ static inline bool ip_sk_ignore_df(cons
  static inline unsigned int ip_dst_mtu_maybe_forward(const struct dst_entry *dst,
  						    bool forwarding)
  {
++<<<<<<< HEAD
 +	const struct rtable *rt = container_of(dst, struct rtable, dst);
 +	struct net *net = dev_net(dst->dev);
 +	unsigned int mtu;
++=======
+ 	const struct rtable *rt = dst_rtable(dst);
+ 	unsigned int mtu, res;
+ 	struct net *net;
++>>>>>>> 071d8012869b (ipv4: use RCU protection in ip_dst_mtu_maybe_forward())
  
+ 	rcu_read_lock();
+ 
+ 	net = dev_net_rcu(dst->dev);
  	if (READ_ONCE(net->ipv4.sysctl_ip_fwd_use_pmtu) ||
  	    ip_mtu_locked(dst) ||
  	    !forwarding) {
* Unmerged path include/net/ip.h
