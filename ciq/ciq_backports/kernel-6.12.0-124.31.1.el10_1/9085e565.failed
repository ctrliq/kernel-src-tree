ipv6: use RCU in ip6_xmit()

jira KERNEL-572
cve CVE-2025-40135
Rebuild_History Non-Buildable kernel-6.12.0-124.31.1.el10_1
commit-author Eric Dumazet <edumazet@google.com>
commit 9085e56501d93af9f2d7bd16f7fcfacdde47b99c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-6.12.0-124.31.1.el10_1/9085e565.failed

Use RCU in ip6_xmit() in order to use dst_dev_rcu() to prevent
possible UAF.

Fixes: 4a6ce2b6f2ec ("net: introduce a new function dst_dev_put()")
	Signed-off-by: Eric Dumazet <edumazet@google.com>
	Reviewed-by: David Ahern <dsahern@kernel.org>
Link: https://patch.msgid.link/20250828195823.3958522-4-edumazet@google.com
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 9085e56501d93af9f2d7bd16f7fcfacdde47b99c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/ip6_output.c
diff --cc net/ipv6/ip6_output.c
index 5a364b352115,e234640433d6..000000000000
--- a/net/ipv6/ip6_output.c
+++ b/net/ipv6/ip6_output.c
@@@ -270,8 -271,6 +270,10 @@@ int ip6_xmit(const struct sock *sk, str
  	const struct ipv6_pinfo *np = inet6_sk(sk);
  	struct in6_addr *first_hop = &fl6->daddr;
  	struct dst_entry *dst = skb_dst(skb);
++<<<<<<< HEAD
 +	struct net_device *dev = dst->dev;
++=======
++>>>>>>> 9085e56501d9 (ipv6: use RCU in ip6_xmit())
  	struct inet6_dev *idev = ip6_dst_idev(dst);
  	struct hop_jumbo_hdr *hop_jumbo;
  	int hoplen = sizeof(*hop_jumbo);
* Unmerged path net/ipv6/ip6_output.c
