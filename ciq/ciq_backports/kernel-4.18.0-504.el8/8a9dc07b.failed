netfilter: conntrack: gre: don't set assured flag for clash entries

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-504.el8
commit-author Florian Westphal <fw@strlen.de>
commit 8a9dc07ba92497a81f1ff65d25c2ba7b6f9a8bdc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-504.el8/8a9dc07b.failed

Now that conntrack core is allowd to insert clashing entries, make sure
GRE won't set assured flag on NAT_CLASH entries, just like UDP.

Doing so prevents early_drop logic for these entries.

Fixes: d671fd82eaa9 ("netfilter: conntrack: allow insertion clash of gre protocol")
	Signed-off-by: Florian Westphal <fw@strlen.de>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit 8a9dc07ba92497a81f1ff65d25c2ba7b6f9a8bdc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/nf_conntrack_proto_gre.c
diff --cc net/netfilter/nf_conntrack_proto_gre.c
index 728a76723299,af369e686fc5..000000000000
--- a/net/netfilter/nf_conntrack_proto_gre.c
+++ b/net/netfilter/nf_conntrack_proto_gre.c
@@@ -219,8 -205,7 +219,12 @@@ int nf_conntrack_gre_packet(struct nf_c
  			    enum ip_conntrack_info ctinfo,
  			    const struct nf_hook_state *state)
  {
++<<<<<<< HEAD
 +	if (state->pf != NFPROTO_IPV4)
 +		return -NF_ACCEPT;
++=======
+ 	unsigned long status;
++>>>>>>> 8a9dc07ba924 (netfilter: conntrack: gre: don't set assured flag for clash entries)
  
  	if (!nf_ct_is_confirmed(ct)) {
  		unsigned int *timeouts = nf_ct_timeout_lookup(ct);
* Unmerged path net/netfilter/nf_conntrack_proto_gre.c
