crypto: fips - make proc files report fips module name and version

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-425.3.1.el8
commit-author Vladis Dronov <vdronov@redhat.com>
commit 5a44749f65b2342d43dea82024e4febdac33c78d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-425.3.1.el8/5a44749f.failed

FIPS 140-3 introduced a requirement for the FIPS module to return
information about itself, specifically a name and a version. These
values must match the values reported on FIPS certificates.

This patch adds two files to read a name and a version from:

/proc/sys/crypto/fips_name
/proc/sys/crypto/fips_version

v2: removed redundant parentheses in config entries.
v3: move FIPS_MODULE_* defines to fips.c where they are used.
v4: return utsrelease.h inclusion

	Signed-off-by: Simo Sorce <simo@redhat.com>
	Signed-off-by: Vladis Dronov <vdronov@redhat.com>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit 5a44749f65b2342d43dea82024e4febdac33c78d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	crypto/fips.c
diff --cc crypto/fips.c
index 9d627c1cf8bc,b05d3c7b3ca5..000000000000
--- a/crypto/fips.c
+++ b/crypto/fips.c
@@@ -16,6 -11,8 +16,11 @@@
  #include <linux/module.h>
  #include <linux/kernel.h>
  #include <linux/sysctl.h>
++<<<<<<< HEAD
++=======
+ #include <linux/notifier.h>
+ #include <generated/utsrelease.h>
++>>>>>>> 5a44749f65b2 (crypto: fips - make proc files report fips module name and version)
  
  int fips_enabled;
  EXPORT_SYMBOL_GPL(fips_enabled);
diff --git a/crypto/Kconfig b/crypto/Kconfig
index eda77a68b6f8..0b070615f8ef 100644
--- a/crypto/Kconfig
+++ b/crypto/Kconfig
@@ -32,6 +32,27 @@ config CRYPTO_FIPS
 	  certification.  You should say no unless you know what
 	  this is.
 
+config CRYPTO_FIPS_NAME
+	string "FIPS Module Name"
+	default "Linux Kernel Cryptographic API"
+	depends on CRYPTO_FIPS
+	help
+	  This option sets the FIPS Module name reported by the Crypto API via
+	  the /proc/sys/crypto/fips_name file.
+
+config CRYPTO_FIPS_CUSTOM_VERSION
+	bool "Use Custom FIPS Module Version"
+	depends on CRYPTO_FIPS
+	default n
+
+config CRYPTO_FIPS_VERSION
+	string "FIPS Module Version"
+	default "(none)"
+	depends on CRYPTO_FIPS_CUSTOM_VERSION
+	help
+	  This option provides the ability to override the FIPS Module Version.
+	  By default the KERNELRELEASE value is used.
+
 config CRYPTO_ALGAPI
 	tristate
 	select CRYPTO_ALGAPI2
* Unmerged path crypto/fips.c
