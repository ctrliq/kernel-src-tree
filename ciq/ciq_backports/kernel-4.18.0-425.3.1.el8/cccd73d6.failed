iosys-map: Add offset to iosys_map_memcpy_to()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-425.3.1.el8
commit-author Lucas De Marchi <lucas.demarchi@intel.com>
commit cccd73d607fee52f35b4b030408fa5f6c21ef503
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-425.3.1.el8/cccd73d6.failed

In certain situations it's useful to be able to write to an
offset of the mapping. Add a dst_offset to iosys_map_memcpy_to().

	Cc: Sumit Semwal <sumit.semwal@linaro.org>
	Cc: Christian König <christian.koenig@amd.com>
	Cc: Thomas Zimmermann <tzimmermann@suse.de>
	Cc: dri-devel@lists.freedesktop.org
	Cc: linux-kernel@vger.kernel.org
	Signed-off-by: Lucas De Marchi <lucas.demarchi@intel.com>
	Reviewed-by: Christian König <christian.koenig@amd.com>
	Reviewed-by: Thomas Zimmermann <tzimmermann@suse.de>
Link: https://patchwork.freedesktop.org/patch/msgid/20220216174147.3073235-2-lucas.demarchi@intel.com
(cherry picked from commit cccd73d607fee52f35b4b030408fa5f6c21ef503)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/drm_cache.c
#	drivers/gpu/drm/drm_fb_helper.c
#	include/linux/iosys-map.h
diff --cc drivers/gpu/drm/drm_cache.c
index 546599f19a93,4b0da6baff78..000000000000
--- a/drivers/gpu/drm/drm_cache.c
+++ b/drivers/gpu/drm/drm_cache.c
@@@ -221,7 -221,7 +221,11 @@@ static void memcpy_fallback(struct dma_
  	if (!dst->is_iomem && !src->is_iomem) {
  		memcpy(dst->vaddr, src->vaddr, len);
  	} else if (!src->is_iomem) {
++<<<<<<< HEAD
 +		dma_buf_map_memcpy_to(dst, src->vaddr, len);
++=======
+ 		iosys_map_memcpy_to(dst, 0, src->vaddr, len);
++>>>>>>> cccd73d607fe (iosys-map: Add offset to iosys_map_memcpy_to())
  	} else if (!dst->is_iomem) {
  		memcpy_fromio(dst->vaddr, src->vaddr_iomem, len);
  	} else {
diff --cc drivers/gpu/drm/drm_fb_helper.c
index 338304a52115,6f72627369f8..000000000000
--- a/drivers/gpu/drm/drm_fb_helper.c
+++ b/drivers/gpu/drm/drm_fb_helper.c
@@@ -382,11 -382,11 +382,16 @@@ static void drm_fb_helper_damage_blit_r
  	size_t len = (clip->x2 - clip->x1) * cpp;
  	unsigned int y;
  
 -	iosys_map_incr(dst, offset); /* go to first pixel within clip rect */
 +	dma_buf_map_incr(dst, offset); /* go to first pixel within clip rect */
  
  	for (y = clip->y1; y < clip->y2; y++) {
++<<<<<<< HEAD
 +		dma_buf_map_memcpy_to(dst, src, len);
 +		dma_buf_map_incr(dst, fb->pitches[0]);
++=======
+ 		iosys_map_memcpy_to(dst, 0, src, len);
+ 		iosys_map_incr(dst, fb->pitches[0]);
++>>>>>>> cccd73d607fe (iosys-map: Add offset to iosys_map_memcpy_to())
  		src += fb->pitches[0];
  	}
  }
* Unmerged path include/linux/iosys-map.h
* Unmerged path drivers/gpu/drm/drm_cache.c
* Unmerged path drivers/gpu/drm/drm_fb_helper.c
* Unmerged path include/linux/iosys-map.h
