scsi: iscsi: Fix HW conn removal use after free

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-425.3.1.el8
commit-author Mike Christie <michael.christie@oracle.com>
commit c577ab7ba5f3bf9062db8a58b6e89d4fe370447e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-425.3.1.el8/c577ab7b.failed

If qla4xxx doesn't remove the connection before the session, the iSCSI
class tries to remove the connection for it. We were doing a
iscsi_put_conn() in the iter function which is not needed and will result
in a use after free because iscsi_remove_conn() will free the connection.

Link: https://lore.kernel.org/r/20220616222738.5722-2-michael.christie@oracle.com
	Tested-by: Nilesh Javali <njavali@marvell.com>
	Reviewed-by: Lee Duncan <lduncan@suse.com>
	Reviewed-by: Nilesh Javali <njavali@marvell.com>
	Signed-off-by: Mike Christie <michael.christie@oracle.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit c577ab7ba5f3bf9062db8a58b6e89d4fe370447e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/scsi_transport_iscsi.c
diff --cc drivers/scsi/scsi_transport_iscsi.c
index 7a59fb3b2ec0,888f9f7472f2..000000000000
--- a/drivers/scsi/scsi_transport_iscsi.c
+++ b/drivers/scsi/scsi_transport_iscsi.c
@@@ -2141,7 -2136,9 +2141,13 @@@ static int iscsi_iter_destroy_conn_fn(s
  {
  	if (!iscsi_is_conn_dev(dev))
  		return 0;
++<<<<<<< HEAD
 +	return iscsi_destroy_conn(iscsi_dev_to_conn(dev));
++=======
+ 
+ 	iscsi_remove_conn(iscsi_dev_to_conn(dev));
+ 	return 0;
++>>>>>>> c577ab7ba5f3 (scsi: iscsi: Fix HW conn removal use after free)
  }
  
  void iscsi_remove_session(struct iscsi_cls_session *session)
* Unmerged path drivers/scsi/scsi_transport_iscsi.c
