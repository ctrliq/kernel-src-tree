PM: domains: use dev_err_probe() to simplify error handling

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-425.3.1.el8
commit-author Ahmad Fatoum <a.fatoum@pengutronix.de>
commit 9a6582b839281ee0e874621f1a2139d2aeb9489e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-425.3.1.el8/9a6582b8.failed

dev_err_probe() can reduce code size, makes the code easier to read
and has the added benefit of recording the defer reason for later
read out. Use it where appropriate.

This also fixes an issue, where an error message in __genpd_dev_pm_attach
was not terminated by a line break.

	Signed-off-by: Ahmad Fatoum <a.fatoum@pengutronix.de>
	Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
	Acked-by: Ulf Hansson <ulf.hansson@linaro.org>
	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit 9a6582b839281ee0e874621f1a2139d2aeb9489e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/base/power/domain.c
diff --cc drivers/base/power/domain.c
index 9b9e00dee573,c0d9ad01b32c..000000000000
--- a/drivers/base/power/domain.c
+++ b/drivers/base/power/domain.c
@@@ -2271,11 -2267,8 +2271,16 @@@ int of_genpd_add_provider_simple(struc
  	/* Parse genpd OPP table */
  	if (genpd->set_performance_state) {
  		ret = dev_pm_opp_of_add_table(&genpd->dev);
++<<<<<<< HEAD
 +		if (ret) {
 +			dev_err(&genpd->dev, "Failed to add OPP table: %d\n",
 +				ret);
 +			return ret;
 +		}
++=======
+ 		if (ret)
+ 			return dev_err_probe(&genpd->dev, ret, "Failed to add OPP table\n");
++>>>>>>> 9a6582b83928 (PM: domains: use dev_err_probe() to simplify error handling)
  
  		/*
  		 * Save table for faster processing while setting performance
@@@ -2334,8 -2327,8 +2339,13 @@@ int of_genpd_add_provider_onecell(struc
  		if (genpd->set_performance_state) {
  			ret = dev_pm_opp_of_add_table_indexed(&genpd->dev, i);
  			if (ret) {
++<<<<<<< HEAD
 +				dev_err(&genpd->dev, "Failed to add OPP table for index %d: %d\n",
 +					i, ret);
++=======
+ 				dev_err_probe(&genpd->dev, ret,
+ 					      "Failed to add OPP table for index %d\n", i);
++>>>>>>> 9a6582b83928 (PM: domains: use dev_err_probe() to simplify error handling)
  				goto error;
  			}
  
* Unmerged path drivers/base/power/domain.c
