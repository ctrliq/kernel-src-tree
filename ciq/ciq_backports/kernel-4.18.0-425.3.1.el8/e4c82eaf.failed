selinux: add proper NULL termination to the secclass_map permissions

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-425.3.1.el8
commit-author Paul Moore <paul@paul-moore.com>
commit e4c82eafb609c2badc56f4e11bc50fcf44b8e9eb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-425.3.1.el8/e4c82eaf.failed

This patch adds the missing NULL termination to the "bpf" and
"perf_event" object class permission lists.

This missing NULL termination should really only affect the tools
under scripts/selinux, with the most important being genheaders.c,
although in practice this has not been an issue on any of my dev/test
systems.  If the problem were to manifest itself it would likely
result in bogus permissions added to the end of the object class;
thankfully with no access control checks using these bogus
permissions and no policies defining these permissions the impact
would likely be limited to some noise about undefined permissions
during policy load.

	Cc: stable@vger.kernel.org
Fixes: ec27c3568a34 ("selinux: bpf: Add selinux check for eBPF syscall operations")
Fixes: da97e18458fb ("perf_event: Add support for LSM and SELinux checks")
	Signed-off-by: Paul Moore <paul@paul-moore.com>

(cherry picked from commit e4c82eafb609c2badc56f4e11bc50fcf44b8e9eb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	security/selinux/include/classmap.h
diff --cc security/selinux/include/classmap.h
index b42a22ef7f7b,62d19bccf3de..000000000000
--- a/security/selinux/include/classmap.h
+++ b/security/selinux/include/classmap.h
@@@ -249,7 -247,11 +250,15 @@@ struct security_class_mapping secclass_
  	{ "xdp_socket",
  	  { COMMON_SOCK_PERMS, NULL } },
  	{ "perf_event",
++<<<<<<< HEAD
 +	  {"open", "cpu", "kernel", "tracepoint", "read", "write"} },
++=======
+ 	  { "open", "cpu", "kernel", "tracepoint", "read", "write", NULL } },
+ 	{ "lockdown",
+ 	  { "integrity", "confidentiality", NULL } },
+ 	{ "anon_inode",
+ 	  { COMMON_FILE_PERMS, NULL } },
++>>>>>>> e4c82eafb609 (selinux: add proper NULL termination to the secclass_map permissions)
  	{ NULL }
    };
  
* Unmerged path security/selinux/include/classmap.h
