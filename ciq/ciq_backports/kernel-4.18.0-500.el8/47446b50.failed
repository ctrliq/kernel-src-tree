firmware_loader: fix up to_fw_sysfs() to preserve const

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-500.el8
commit-author Greg Kroah-Hartman <gregkh@linuxfoundation.org>
commit 47446b50ad2549af4fcc93f82a148ab107e6ef6a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-500.el8/47446b50.failed

to_fw_sysfs() was changed in commit 23680f0b7d7f ("driver core: make
struct class.dev_uevent() take a const *") to pass in a const pointer
but not pass it back out to handle some changes in the driver core.
That isn't the best idea as it could cause problems if used incorrectly,
so switch to use the container_of_const() macro instead which will
preserve the const status of the pointer and enforce it by the compiler.

Fixes: 23680f0b7d7f ("driver core: make struct class.dev_uevent() take a const *")
	Cc: Luis Chamberlain <mcgrof@kernel.org>
	Reviewed-by: Sakari Ailus <sakari.ailus@linux.intel.com>
	Reviewed-by: Jason Gunthorpe <jgg@nvidia.com>
	Acked-by: Russ Weight <russell.h.weight@intel.com>
	Acked-by: Rafael J. Wysocki <rafael@kernel.org>
Link: https://lore.kernel.org/r/20221205121206.166576-4-gregkh@linuxfoundation.org
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 47446b50ad2549af4fcc93f82a148ab107e6ef6a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/base/firmware_loader/sysfs.h
diff --cc drivers/base/firmware_loader/sysfs.h
index 172e77559b12,2060add8ef81..000000000000
--- a/drivers/base/firmware_loader/sysfs.h
+++ b/drivers/base/firmware_loader/sysfs.h
@@@ -63,11 -80,7 +63,15 @@@ struct fw_sysfs 
  	struct firmware *fw;
  	void *fw_upload_priv;
  };
++<<<<<<< HEAD
 +
 +static inline struct fw_sysfs *to_fw_sysfs(struct device *dev)
 +{
 +	return container_of(dev, struct fw_sysfs, dev);
 +}
++=======
+ #define to_fw_sysfs(__dev)	container_of_const(__dev, struct fw_sysfs, dev)
++>>>>>>> 47446b50ad25 (firmware_loader: fix up to_fw_sysfs() to preserve const)
  
  void __fw_load_abort(struct fw_priv *fw_priv);
  
* Unmerged path drivers/base/firmware_loader/sysfs.h
