usb: host: Add ability to build new Broadcom STB USB drivers

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-500.el8
commit-author Al Cooper <alcooperx@gmail.com>
commit c33f4f24b888236b725a9972e0fe5ac6575c68ec
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-500.el8/c33f4f24.failed

Add the build system changes needed to get the Broadcom STB XHCI,
EHCI and OHCI functionality working. The OHCI support does not
require anything unique to Broadcom so the standard ohci-platform
driver is being used. Also update MAINTAINERS.

	Signed-off-by: Al Cooper <alcooperx@gmail.com>
	Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
Link: https://lore.kernel.org/r/20200512150019.25903-6-alcooperx@gmail.com
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit c33f4f24b888236b725a9972e0fe5ac6575c68ec)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	MAINTAINERS
diff --cc MAINTAINERS
index c002a3dc78ae,f71212eb845e..000000000000
--- a/MAINTAINERS
+++ b/MAINTAINERS
@@@ -3048,6 -3473,22 +3048,25 @@@ S:	Supporte
  F:	Documentation/devicetree/bindings/gpio/brcm,brcmstb-gpio.txt
  F:	drivers/gpio/gpio-brcmstb.c
  
++<<<<<<< HEAD
++=======
+ BROADCOM BRCMSTB I2C DRIVER
+ M:	Kamal Dasu <kdasu.kdev@gmail.com>
+ L:	linux-i2c@vger.kernel.org
+ L:	bcm-kernel-feedback-list@broadcom.com
+ S:	Supported
+ F:	Documentation/devicetree/bindings/i2c/brcm,brcmstb-i2c.yaml
+ F:	drivers/i2c/busses/i2c-brcmstb.c
+ 
+ BROADCOM BRCMSTB USB EHCI DRIVER
+ M:	Al Cooper <alcooperx@gmail.com>
+ L:	linux-usb@vger.kernel.org
+ L:	bcm-kernel-feedback-list@broadcom.com
+ S:	Maintained
+ F:	Documentation/devicetree/bindings/usb/brcm,bcm7445-ehci.yaml
+ F:	drivers/usb/host/ehci-brcm.*
+ 
++>>>>>>> c33f4f24b888 (usb: host: Add ability to build new Broadcom STB USB drivers)
  BROADCOM BRCMSTB USB2 and USB3 PHY DRIVER
  M:	Al Cooper <alcooperx@gmail.com>
  L:	linux-kernel@vger.kernel.org
* Unmerged path MAINTAINERS
diff --git a/drivers/usb/host/Kconfig b/drivers/usb/host/Kconfig
index ed68cbf223e3..f2474eda5659 100644
--- a/drivers/usb/host/Kconfig
+++ b/drivers/usb/host/Kconfig
@@ -97,6 +97,26 @@ config USB_XHCI_TEGRA
 
 endif # USB_XHCI_HCD
 
+config USB_EHCI_BRCMSTB
+       tristate
+
+config USB_BRCMSTB
+	tristate "Broadcom STB USB support"
+	depends on (ARCH_BRCMSTB && PHY_BRCM_USB) || COMPILE_TEST
+	select USB_OHCI_HCD_PLATFORM if USB_OHCI_HCD
+	select USB_EHCI_BRCMSTB if USB_EHCI_HCD
+	select USB_XHCI_PLATFORM if USB_XHCI_HCD
+	help
+	  Enables support for XHCI, EHCI and OHCI host controllers
+	  found in Broadcom STB SoC's.
+
+	  To compile these drivers as modules, choose M here: the
+	  modules will be called ohci-platform.ko, ehci-brcm.ko and
+	  xhci-plat-hcd.ko
+
+	  Disabling this will keep the controllers and corresponding
+	  PHYs powered down.
+
 config USB_EHCI_HCD
 	tristate "EHCI HCD (USB 2.0) support"
 	depends on HAS_DMA && HAS_IOMEM
diff --git a/drivers/usb/host/Makefile b/drivers/usb/host/Makefile
index d87fce62d130..a05107c24180 100644
--- a/drivers/usb/host/Makefile
+++ b/drivers/usb/host/Makefile
@@ -49,6 +49,7 @@ obj-$(CONFIG_USB_EHCI_HCD_STI)	+= ehci-st.o
 obj-$(CONFIG_USB_EHCI_EXYNOS)	+= ehci-exynos.o
 obj-$(CONFIG_USB_EHCI_HCD_AT91) += ehci-atmel.o
 obj-$(CONFIG_USB_EHCI_TEGRA)	+= ehci-tegra.o
+obj-$(CONFIG_USB_EHCI_BRCMSTB)	+= ehci-brcm.o
 
 obj-$(CONFIG_USB_OXU210HP_HCD)	+= oxu210hp-hcd.o
 obj-$(CONFIG_USB_ISP116X_HCD)	+= isp116x-hcd.o
