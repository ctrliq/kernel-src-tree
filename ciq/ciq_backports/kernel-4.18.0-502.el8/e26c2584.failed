r8152: Add MAC passthrough support for Lenovo Travel Hub

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-502.el8
commit-author André Apitzsch <git@apitzsch.eu>
commit e26c258434b8b85705884dd838cae89b5c1af2be
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-502.el8/e26c2584.failed

The Lenovo USB-C Travel Hub supports MAC passthrough.

	Signed-off-by: André Apitzsch <git@apitzsch.eu>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit e26c258434b8b85705884dd838cae89b5c1af2be)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/usb/r8152.c
diff --cc drivers/net/usb/r8152.c
index 35e98590e253,a51d8ded60f3..000000000000
--- a/drivers/net/usb/r8152.c
+++ b/drivers/net/usb/r8152.c
@@@ -679,12 -767,15 +679,17 @@@ enum rtl8152_flags 
  	PHY_RESET,
  	SCHEDULE_TASKLET,
  	GREEN_ETHERNET,
 -	RX_EPROTO,
 +	DELL_TB_RX_AGG_BUG,
 +	LENOVO_MACPASSTHRU,
  };
  
++<<<<<<< HEAD
++=======
+ #define DEVICE_ID_LENOVO_USB_C_TRAVEL_HUB		0x721e
+ #define DEVICE_ID_THINKPAD_ONELINK_PLUS_DOCK		0x3054
++>>>>>>> e26c258434b8 (r8152: Add MAC passthrough support for Lenovo Travel Hub)
  #define DEVICE_ID_THINKPAD_THUNDERBOLT3_DOCK_GEN2	0x3082
 -#define DEVICE_ID_THINKPAD_USB_C_DONGLE			0x720c
  #define DEVICE_ID_THINKPAD_USB_C_DOCK_GEN2		0xa387
 -#define DEVICE_ID_THINKPAD_USB_C_DOCK_GEN3		0x3062
  
  struct tally_counter {
  	__le64	tx_packets;
@@@ -6817,6 -9579,31 +6822,34 @@@ u8 rtl8152_get_version(struct usb_inter
  }
  EXPORT_SYMBOL_GPL(rtl8152_get_version);
  
++<<<<<<< HEAD
++=======
+ static bool rtl8152_supports_lenovo_macpassthru(struct usb_device *udev)
+ {
+ 	int parent_vendor_id = le16_to_cpu(udev->parent->descriptor.idVendor);
+ 	int product_id = le16_to_cpu(udev->descriptor.idProduct);
+ 	int vendor_id = le16_to_cpu(udev->descriptor.idVendor);
+ 
+ 	if (vendor_id == VENDOR_ID_LENOVO) {
+ 		switch (product_id) {
+ 		case DEVICE_ID_LENOVO_USB_C_TRAVEL_HUB:
+ 		case DEVICE_ID_THINKPAD_ONELINK_PLUS_DOCK:
+ 		case DEVICE_ID_THINKPAD_THUNDERBOLT3_DOCK_GEN2:
+ 		case DEVICE_ID_THINKPAD_USB_C_DOCK_GEN2:
+ 		case DEVICE_ID_THINKPAD_USB_C_DOCK_GEN3:
+ 		case DEVICE_ID_THINKPAD_USB_C_DONGLE:
+ 			return 1;
+ 		}
+ 	} else if (vendor_id == VENDOR_ID_REALTEK && parent_vendor_id == VENDOR_ID_LENOVO) {
+ 		switch (product_id) {
+ 		case 0x8153:
+ 			return 1;
+ 		}
+ 	}
+ 	return 0;
+ }
+ 
++>>>>>>> e26c258434b8 (r8152: Add MAC passthrough support for Lenovo Travel Hub)
  static int rtl8152_probe(struct usb_interface *intf,
  			 const struct usb_device_id *id)
  {
* Unmerged path drivers/net/usb/r8152.c
