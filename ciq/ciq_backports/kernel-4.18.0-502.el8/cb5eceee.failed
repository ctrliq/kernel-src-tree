platform/x86/intel/ifs: Remove memory allocation from load path

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-502.el8
commit-author Jithu Joseph <jithu.joseph@intel.com>
commit cb5eceee816bf05667089869d822b9cbc919465a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-502.el8/cb5eceee.failed

IFS requires tests to be authenticated once for each CPU socket on a
system.

scan_chunks_sanity_check() was dynamically allocating memory to store
the state of whether tests have been authenticated on each socket for
every load operation.

Move the memory allocation to init path and store the pointer in
ifs_data struct.

Also rearrange the adjacent error checking in init for a more simplified
and natural flow.

	Suggested-by: Borislav Petkov <bp@alien8.de>
	Signed-off-by: Jithu Joseph <jithu.joseph@intel.com>
	Signed-off-by: Borislav Petkov <bp@suse.de>
	Reviewed-by: Tony Luck <tony.luck@intel.com>
	Reviewed-by: Hans de Goede <hdegoede@redhat.com>
Link: https://lore.kernel.org/r/20221117195957.28225-1-jithu.joseph@intel.com
(cherry picked from commit cb5eceee816bf05667089869d822b9cbc919465a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/platform/x86/intel/ifs/core.c
#	drivers/platform/x86/intel/ifs/ifs.h
#	drivers/platform/x86/intel/ifs/load.c
* Unmerged path drivers/platform/x86/intel/ifs/core.c
* Unmerged path drivers/platform/x86/intel/ifs/ifs.h
* Unmerged path drivers/platform/x86/intel/ifs/load.c
* Unmerged path drivers/platform/x86/intel/ifs/core.c
* Unmerged path drivers/platform/x86/intel/ifs/ifs.h
* Unmerged path drivers/platform/x86/intel/ifs/load.c
