ACPI: video: Refactor acpi_video_get_backlight_type() a bit

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-529.el8
commit-author Hans de Goede <hdegoede@redhat.com>
commit b39be9f441f9d7320e6020bdf8ec1522d6c81d1e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-529.el8/b39be9f4.failed

Refactor acpi_video_get_backlight_type() so that the heuristics /
detection steps are stricly in order of descending precedence.

Also move the comments describing the steps to when the various steps are
actually done, to avoid the comments getting out of sync with the code.

	Acked-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
	Signed-off-by: Hans de Goede <hdegoede@redhat.com>
(cherry picked from commit b39be9f441f9d7320e6020bdf8ec1522d6c81d1e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/acpi/video_detect.c
diff --cc drivers/acpi/video_detect.c
index 80ecaaa158cf,cc9d0d91e268..000000000000
--- a/drivers/acpi/video_detect.c
+++ b/drivers/acpi/video_detect.c
@@@ -567,14 -570,25 +562,33 @@@ static enum acpi_backlight_type __acpi_
  	if (acpi_backlight_dmi != acpi_backlight_undef)
  		return acpi_backlight_dmi;
  
- 	if (!(video_caps & ACPI_VIDEO_BACKLIGHT))
- 		return acpi_backlight_vendor;
+ 	/* On systems with ACPI video use either native or ACPI video. */
+ 	if (video_caps & ACPI_VIDEO_BACKLIGHT) {
+ 		/*
+ 		 * Windows 8 and newer no longer use the ACPI video interface,
+ 		 * so it often does not work. If the ACPI tables are written
+ 		 * for win8 and native brightness ctl is available, use that.
+ 		 *
+ 		 * The native check deliberately is inside the if acpi-video
+ 		 * block on older devices without acpi-video support native
+ 		 * is usually not the best choice.
+ 		 */
+ 		if (acpi_osi_is_win8() && native_available)
+ 			return acpi_backlight_native;
+ 		else
+ 			return acpi_backlight_video;
+ 	}
  
++<<<<<<< HEAD
 +	if (acpi_osi_is_win8() &&
 +	    (native_available || backlight_device_get_by_type(BACKLIGHT_RAW)))
 +		return acpi_backlight_native;
 +
 +	return acpi_backlight_video;
++=======
+ 	/* No ACPI video (old hw), use vendor specific fw methods. */
+ 	return acpi_backlight_vendor;
++>>>>>>> b39be9f441f9 (ACPI: video: Refactor acpi_video_get_backlight_type() a bit)
  }
  
  enum acpi_backlight_type acpi_video_get_backlight_type(void)
* Unmerged path drivers/acpi/video_detect.c
