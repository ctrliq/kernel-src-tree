drm/vmwgfx: Fix src/dst_pitch confusion

jira LE-1907
cve CVE-2023-5633
Rebuild_History Non-Buildable kernel-4.18.0-529.el8
commit-author Zack Rusin <zackr@vmware.com>
commit 328839ff93709a517e89ba1de1132c5d138e5dcb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-529.el8/328839ff.failed

The src/dst_pitch got mixed up during the rework of the function, make
sure the offset's refer to the correct one.

Spotted by clang:
Clang warns (or errors with CONFIG_WERROR):

  drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c:509:29: error: variable 'dst_pitch' is uninitialized when used here [-Werror,-Wuninitialized]
          src_offset = ddirty->top * dst_pitch + ddirty->left * stdu->cpp;
                                     ^~~~~~~~~
  drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c:492:26: note: initialize the variable 'dst_pitch' to silence this warning
          s32 src_pitch, dst_pitch;
                                  ^
                                   = 0
  1 error generated.

	Signed-off-by: Zack Rusin <zackr@vmware.com>
	Reported-by: Nathan Chancellor <nathan@kernel.org>
	Reported-by: Dave Airlie <airlied@gmail.com>
Link: https://github.com/ClangBuiltLinux/linux/issues/1811
Fixes: 39985eea5a6d ("drm/vmwgfx: Abstract placement selection")
	Reviewed-by: Nathan Chancellor <nathan@kernel.org>
	Reviewed-by: Martin Krastev <krastevm@vmware.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20230314211445.1363828-1-zack@kde.org
(cherry picked from commit 328839ff93709a517e89ba1de1132c5d138e5dcb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c
diff --cc drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c
index 0090abe89254,ba0c0e12cfe9..000000000000
--- a/drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c
+++ b/drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c
@@@ -597,20 -504,13 +597,30 @@@ static void vmw_stdu_bo_cpu_commit(stru
  		return;
  
  	/* Assume we are blitting from Guest (bo) to Host (display_srf) */
++<<<<<<< HEAD
 +	dst_pitch = stdu->display_srf->metadata.base_size.width * stdu->cpp;
 +	dst_bo = &stdu->display_srf->res.backup->base;
 +	dst_offset = ddirty->top * dst_pitch + ddirty->left * stdu->cpp;
 +
 +	src_pitch = ddirty->pitch;
 +	src_bo = &ddirty->buf->base;
 +	src_offset = ddirty->fb_top * src_pitch + ddirty->fb_left * stdu->cpp;
 +
 +	/* Swap src and dst if the assumption was wrong. */
 +	if (ddirty->transfer != SVGA3D_WRITE_HOST_VRAM) {
 +		swap(dst_pitch, src_pitch);
 +		swap(dst_bo, src_bo);
 +		swap(src_offset, dst_offset);
 +	}
++=======
+ 	src_pitch = stdu->display_srf->metadata.base_size.width * stdu->cpp;
+ 	src_bo = &stdu->display_srf->res.guest_memory_bo->tbo;
+ 	src_offset = ddirty->top * src_pitch + ddirty->left * stdu->cpp;
+ 
+ 	dst_pitch = ddirty->pitch;
+ 	dst_bo = &ddirty->buf->tbo;
+ 	dst_offset = ddirty->fb_top * dst_pitch + ddirty->fb_left * stdu->cpp;
++>>>>>>> 328839ff9370 (drm/vmwgfx: Fix src/dst_pitch confusion)
  
  	(void) vmw_bo_cpu_blit(dst_bo, dst_offset, dst_pitch,
  			       src_bo, src_offset, src_pitch,
* Unmerged path drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c
