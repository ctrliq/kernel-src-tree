efi: runtime: Fix potential overflow of soft-reserved region size

jira LE-1907
cve CVE-2024-26843
Rebuild_History Non-Buildable kernel-4.18.0-553.16.1.el8_10
commit-author Andrew Bresticker <abrestic@rivosinc.com>
commit de1034b38a346ef6be25fe8792f5d1e0684d5ff4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.16.1.el8_10/de1034b3.failed

md_size will have been narrowed if we have >= 4GB worth of pages in a
soft-reserved region.

	Signed-off-by: Andrew Bresticker <abrestic@rivosinc.com>
	Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
(cherry picked from commit de1034b38a346ef6be25fe8792f5d1e0684d5ff4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/firmware/efi/riscv-runtime.c
* Unmerged path drivers/firmware/efi/riscv-runtime.c
diff --git a/drivers/firmware/efi/arm-runtime.c b/drivers/firmware/efi/arm-runtime.c
index 1b7d5b30e238..fd9313ad8864 100644
--- a/drivers/firmware/efi/arm-runtime.c
+++ b/drivers/firmware/efi/arm-runtime.c
@@ -128,7 +128,7 @@ static int __init arm_enable_runtime_services(void)
 		efi_memory_desc_t *md;
 
 		for_each_efi_memory_desc(md) {
-			int md_size = md->num_pages << EFI_PAGE_SHIFT;
+			u64 md_size = md->num_pages << EFI_PAGE_SHIFT;
 			struct resource *res;
 
 			if (!(md->attribute & EFI_MEMORY_SP))
* Unmerged path drivers/firmware/efi/riscv-runtime.c
