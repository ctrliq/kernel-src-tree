cifs: introduce new helper for cifs_reconnect()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-553.16.1.el8_10
commit-author Paulo Alcantara <pc@cjr.nz>
commit 43b459aa5e222cb6610dac8723b40c19532ea00d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-553.16.1.el8_10/43b459aa.failed

Create cifs_mark_tcp_ses_conns_for_reconnect() helper to mark all
sessions and tcons for reconnect when reconnecting tcp server.

	Signed-off-by: Paulo Alcantara (SUSE) <pc@cjr.nz>
	Reviewed-by: Shyam Prasad N <sprasad@microsoft.com>
	Signed-off-by: Steve French <stfrench@microsoft.com>
(cherry picked from commit 43b459aa5e222cb6610dac8723b40c19532ea00d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/cifs/connect.c
diff --cc fs/cifs/connect.c
index 13237453ae19,03126e7993be..000000000000
--- a/fs/cifs/connect.c
+++ b/fs/cifs/connect.c
@@@ -278,12 -216,12 +227,21 @@@ static void cifs_mark_tcp_ses_conns_for
  	server->max_read = 0;
  
  	cifs_dbg(FYI, "Mark tcp session as need reconnect\n");
++<<<<<<< HEAD
 +	trace_smb3_reconnect(server->CurrentMid, server->hostname);
 +
 +	/* before reconnecting the tcp session, mark the smb session (uid)
 +		and the tid bad so they are not used until reconnected */
 +	cifs_dbg(FYI, "%s: marking sessions and tcons for reconnect\n",
 +		 __func__);
++=======
+ 	trace_smb3_reconnect(server->CurrentMid, server->conn_id, server->hostname);
+ 	/*
+ 	 * before reconnecting the tcp session, mark the smb session (uid) and the tid bad so they
+ 	 * are not used until reconnected.
+ 	 */
+ 	cifs_dbg(FYI, "%s: marking sessions and tcons for reconnect\n", __func__);
++>>>>>>> 43b459aa5e22 (cifs: introduce new helper for cifs_reconnect())
  	spin_lock(&cifs_tcp_ses_lock);
  	list_for_each(tmp, &server->smb_ses_list) {
  		ses = list_entry(tmp, struct cifs_ses, smb_ses_list);
* Unmerged path fs/cifs/connect.c
