Bluetooth: btmtksdio: handle runtime pm only when sdio_func is available

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-509.el8
commit-author Sean Wang <sean.wang@mediatek.com>
commit 4b4b2228f521c338030b1f310a5dee73fd7d8f26
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-509.el8/4b4b2228.failed

Runtime pm ops is not aware the sdio_func status that is probably
being disabled by btmtksdio_close. Thus, we are only able to access the
sdio_func for the runtime pm operations only when the sdio_func is
available.

Fixes: 7f3c563c575e7 ("Bluetooth: btmtksdio: Add runtime PM support to SDIO based Bluetooth")
Co-developed-by: Mark-yw Chen <mark-yw.chen@mediatek.com>
	Signed-off-by: Mark-yw Chen <mark-yw.chen@mediatek.com>
	Signed-off-by: Sean Wang <sean.wang@mediatek.com>
	Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
(cherry picked from commit 4b4b2228f521c338030b1f310a5dee73fd7d8f26)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/bluetooth/btmtksdio.c
diff --cc drivers/bluetooth/btmtksdio.c
index 9bc3e3bd14e8,fc6317e519e9..000000000000
--- a/drivers/bluetooth/btmtksdio.c
+++ b/drivers/bluetooth/btmtksdio.c
@@@ -91,25 -98,8 +91,30 @@@ MODULE_DEVICE_TABLE(sdio, btmtksdio_tab
  #define MTK_SDIO_BLOCK_SIZE	256
  
  #define BTMTKSDIO_TX_WAIT_VND_EVT	1
++<<<<<<< HEAD
 +
 +enum {
 +	MTK_WMT_PATCH_DWNLD = 0x1,
 +	MTK_WMT_TEST = 0x2,
 +	MTK_WMT_WAKEUP = 0x3,
 +	MTK_WMT_HIF = 0x4,
 +	MTK_WMT_FUNC_CTRL = 0x6,
 +	MTK_WMT_RST = 0x7,
 +	MTK_WMT_SEMAPHORE = 0x17,
 +};
 +
 +enum {
 +	BTMTK_WMT_INVALID,
 +	BTMTK_WMT_PATCH_UNDONE,
 +	BTMTK_WMT_PATCH_DONE,
 +	BTMTK_WMT_ON_UNDONE,
 +	BTMTK_WMT_ON_DONE,
 +	BTMTK_WMT_ON_PROGRESS,
 +};
++=======
+ #define BTMTKSDIO_HW_TX_READY		2
+ #define BTMTKSDIO_FUNC_ENABLED		3
++>>>>>>> 4b4b2228f521 (Bluetooth: btmtksdio: handle runtime pm only when sdio_func is available)
  
  struct mtkbtsdio_hdr {
  	__le16	len;
* Unmerged path drivers/bluetooth/btmtksdio.c
