ethtool: Fix set RXNFC command with symmetric RSS hash

jira LE-4018
Rebuild_History Non-Buildable kernel-5.14.0-570.37.1.el9_6
commit-author Gal Pressman <gal@nvidia.com>
commit 4f5a52adeb1ad675ca33f1e1eacd9c0bbaf393d4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-5.14.0-570.37.1.el9_6/4f5a52ad.failed

The sanity check that both source and destination are set when symmetric
RSS hash is requested is only relevant for ETHTOOL_SRXFH (rx-flow-hash),
it should not be performed on any other commands (e.g.
ETHTOOL_SRXCLSRLINS/ETHTOOL_SRXCLSRLDEL).

This resolves accessing uninitialized 'info.data' field, and fixes false
errors in rule insertion:
  # ethtool --config-ntuple eth2 flow-type ip4 dst-ip 255.255.255.255 action -1 loc 0
  rmgr: Cannot insert RX class rule: Invalid argument
  Cannot insert classification rule

Fixes: 13e59344fb9d ("net: ethtool: add support for symmetric-xor RSS hash")
	Cc: Ahmed Zaki <ahmed.zaki@intel.com>
	Reviewed-by: Tariq Toukan <tariqt@nvidia.com>
	Signed-off-by: Gal Pressman <gal@nvidia.com>
	Reviewed-by: Michal Swiatkowski <michal.swiatkowski@linux.intel.com>
	Reviewed-by: Edward Cree <ecree.xilinx@gmail.com>
	Reviewed-by: Ahmed Zaki <ahmed.zaki@intel.com>
Link: https://patch.msgid.link/20250126191845.316589-1-gal@nvidia.com
	Signed-off-by: Paolo Abeni <pabeni@redhat.com>

(cherry picked from commit 4f5a52adeb1ad675ca33f1e1eacd9c0bbaf393d4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ethtool/ioctl.c
diff --cc net/ethtool/ioctl.c
index 65cfe76dafbe,34bee42e1247..000000000000
--- a/net/ethtool/ioctl.c
+++ b/net/ethtool/ioctl.c
@@@ -992,7 -992,13 +992,17 @@@ static noinline_for_stack int ethtool_s
  	if (rc)
  		return rc;
  
++<<<<<<< HEAD
 +	if (ops->get_rxfh) {
++=======
+ 	/* Nonzero ring with RSS only makes sense if NIC adds them together */
+ 	if (cmd == ETHTOOL_SRXCLSRLINS && info.flow_type & FLOW_RSS &&
+ 	    !ops->cap_rss_rxnfc_adds &&
+ 	    ethtool_get_flow_spec_ring(info.fs.ring_cookie))
+ 		return -EINVAL;
+ 
+ 	if (cmd == ETHTOOL_SRXFH && ops->get_rxfh) {
++>>>>>>> 4f5a52adeb1a (ethtool: Fix set RXNFC command with symmetric RSS hash)
  		struct ethtool_rxfh_param rxfh = {};
  
  		rc = ops->get_rxfh(dev, &rxfh);
* Unmerged path net/ethtool/ioctl.c
