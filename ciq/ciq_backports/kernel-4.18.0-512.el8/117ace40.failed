wifi: brcmfmac: pcie: Add IDs/properties for BCM4387

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-512.el8
commit-author Hector Martin <marcan@marcan.st>
commit 117ace4014cce3fb78b40eb8028bb0f4fc37dd6f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-512.el8/117ace40.failed

This chip is present on Apple M1 Pro/Max (t600x) platforms:

* maldives   (apple,j314s): MacBook Pro (14-inch, M1 Pro, 2021)
* maldives   (apple,j314c): MacBook Pro (14-inch, M1 Max, 2021)
* madagascar (apple,j316s): MacBook Pro (16-inch, M1 Pro, 2021)
* madagascar (apple,j316c): MacBook Pro (16-inch, M1 Max, 2021)

	Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
	Reviewed-by: Arend van Spriel <arend.vanspriel@broadcom.com>
	Signed-off-by: Hector Martin <marcan@marcan.st>
	Signed-off-by: Kalle Valo <kvalo@kernel.org>
Link: https://lore.kernel.org/r/20230214092423.15175-7-marcan@marcan.st
(cherry picked from commit 117ace4014cce3fb78b40eb8028bb0f4fc37dd6f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/broadcom/brcm80211/brcmfmac/pcie.c
#	drivers/net/wireless/broadcom/brcm80211/include/brcm_hw_ids.h
diff --cc drivers/net/wireless/broadcom/brcm80211/brcmfmac/pcie.c
index 0e06bff87a1b,d2dad5414f39..000000000000
--- a/drivers/net/wireless/broadcom/brcm80211/brcmfmac/pcie.c
+++ b/drivers/net/wireless/broadcom/brcm80211/brcmfmac/pcie.c
@@@ -2662,7 -2669,7 +2669,11 @@@ static const struct pci_device_id brcmf
  	BRCMF_PCIE_DEVICE(BRCM_PCIE_43596_DEVICE_ID, CYW),
  	BRCMF_PCIE_DEVICE(BRCM_PCIE_4377_DEVICE_ID, WCC),
  	BRCMF_PCIE_DEVICE(BRCM_PCIE_4378_DEVICE_ID, WCC),
++<<<<<<< HEAD
 +	BRCMF_PCIE_DEVICE(CY_PCIE_89459_RAW_DEVICE_ID, CYW),
++=======
+ 	BRCMF_PCIE_DEVICE(BRCM_PCIE_4387_DEVICE_ID, WCC),
++>>>>>>> 117ace4014cc (wifi: brcmfmac: pcie: Add IDs/properties for BCM4387)
  
  	{ /* end: all zeroes */ }
  };
diff --cc drivers/net/wireless/broadcom/brcm80211/include/brcm_hw_ids.h
index b228672cfdce,44684bf1b9ac..000000000000
--- a/drivers/net/wireless/broadcom/brcm80211/include/brcm_hw_ids.h
+++ b/drivers/net/wireless/broadcom/brcm80211/include/brcm_hw_ids.h
@@@ -95,7 -96,7 +96,11 @@@
  #define BRCM_PCIE_43596_DEVICE_ID	0x4415
  #define BRCM_PCIE_4377_DEVICE_ID	0x4488
  #define BRCM_PCIE_4378_DEVICE_ID	0x4425
++<<<<<<< HEAD
 +#define CY_PCIE_89459_RAW_DEVICE_ID     0x4355
++=======
+ #define BRCM_PCIE_4387_DEVICE_ID	0x4433
++>>>>>>> 117ace4014cc (wifi: brcmfmac: pcie: Add IDs/properties for BCM4387)
  
  /* brcmsmac IDs */
  #define BCM4313_D11N2G_ID	0x4727	/* 4313 802.11n 2.4G device */
diff --git a/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c b/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c
index 50e0c015cf43..9f9bf08a70bb 100644
--- a/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c
+++ b/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c
@@ -743,6 +743,8 @@ static u32 brcmf_chip_tcm_rambase(struct brcmf_chip_priv *ci)
 		return 0x170000;
 	case BRCM_CC_4378_CHIP_ID:
 		return 0x352000;
+	case BRCM_CC_4387_CHIP_ID:
+		return 0x740000;
 	default:
 		brcmf_err("unknown chip: %s\n", ci->pub.name);
 		break;
* Unmerged path drivers/net/wireless/broadcom/brcm80211/brcmfmac/pcie.c
* Unmerged path drivers/net/wireless/broadcom/brcm80211/include/brcm_hw_ids.h
