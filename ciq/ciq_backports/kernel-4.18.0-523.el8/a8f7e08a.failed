x86/sev-es: Fix SEV-ES OUT/IN immediate opcode vc handling

jira LE-1907
cve CVE-2023-46813
Rebuild_History Non-Buildable kernel-4.18.0-523.el8
commit-author Peter Gonda <pgonda@google.com>
commit a8f7e08a81708920a928664a865208fdf451c49f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-523.el8/a8f7e08a.failed

The IN and OUT instructions with port address as an immediate operand
only use an 8-bit immediate (imm8). The current VC handler uses the
entire 32-bit immediate value but these instructions only set the first
bytes.

Cast the operand to an u8 for that.

 [ bp: Massage commit message. ]

Fixes: 25189d08e5168 ("x86/sev-es: Add support for handling IOIO exceptions")
	Signed-off-by: Peter Gonda <pgonda@google.com>
	Signed-off-by: Borislav Petkov <bp@suse.de>
	Acked-by: David Rientjes <rientjes@google.com>
Link: https://lkml.kernel.org/r/20210105163311.221490-1-pgonda@google.com
(cherry picked from commit a8f7e08a81708920a928664a865208fdf451c49f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/sev-es-shared.c
* Unmerged path arch/x86/kernel/sev-es-shared.c
* Unmerged path arch/x86/kernel/sev-es-shared.c
