mxser: don't allocate MXSER_PORTS + 1

jira LE-1907
cve CVE-2023-6546
Rebuild_History Non-Buildable kernel-4.18.0-541.el8
commit-author Jiri Slaby <jslaby@suse.cz>
commit 389fc82e475be8f6c1745f804470bea5e3bf7dc1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-541.el8/389fc82e.failed

The MXSER_PORTS's tty_device is never registered and neither its
tty_port instance exists. Hence, it's quite pointless to allocate it.

It used to be used for global information fetches via ioctls. We have
just removed these as non-existent tty_device+tty_port was exactly the
reason to remove the ioctls.

It would be peculiar to add this "virtual" port as we require a backing
tty_port since commit ecbbfd44a08f (TTY: move tty buffers to tty_port)
in 2012.

	Signed-off-by: Jiri Slaby <jslaby@suse.cz>
Link: https://lore.kernel.org/r/20210618061516.662-33-jslaby@suse.cz
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 389fc82e475be8f6c1745f804470bea5e3bf7dc1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/tty/mxser.c
diff --cc drivers/tty/mxser.c
index ff7a0e941388,007137c3b5c9..000000000000
--- a/drivers/tty/mxser.c
+++ b/drivers/tty/mxser.c
@@@ -1793,9 -1419,6 +1779,12 @@@ static int mxser_ioctl(struct tty_struc
  	unsigned long flags;
  	void __user *argp = (void __user *)arg;
  
++<<<<<<< HEAD
 +	if (tty->index == MXSER_PORTS)
 +		return mxser_ioctl_special(cmd, argp);
 +
++=======
++>>>>>>> 389fc82e475b (mxser: don't allocate MXSER_PORTS + 1)
  	if (cmd == MOXA_SET_OP_MODE || cmd == MOXA_GET_OP_MODE) {
  		int p;
  		unsigned long opmode;
@@@ -2786,12 -2192,9 +2775,12 @@@ static struct pci_driver mxser_driver 
  
  static int __init mxser_module_init(void)
  {
 +	struct mxser_board *brd;
 +	struct device *tty_dev;
 +	unsigned int b, i, m;
  	int retval;
  
- 	mxvar_sdriver = alloc_tty_driver(MXSER_PORTS + 1);
+ 	mxvar_sdriver = alloc_tty_driver(MXSER_PORTS);
  	if (!mxvar_sdriver)
  		return -ENOMEM;
  
* Unmerged path drivers/tty/mxser.c
