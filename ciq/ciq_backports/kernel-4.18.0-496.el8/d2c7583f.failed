scsi: smartpqi: Add sysfs entry for NUMA node in /sys/block/sdX/device

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-496.el8
commit-author Don Brace <don.brace@microchip.com>
commit d2c7583f27cc138354a1cd3c990923de7fd2126a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-496.el8/d2c7583f.failed

Although NUMA node is a PCIe device level attribute, it was requested the
NUMA node be added for each exposed device similar to NVMe disks.

Example for NVMe:

  /sys/block/nvme1c1n1/device/numa_node

Example for smartpqi:

  /sys/block/sdh/device/numa_node

  cat /sys/block/sdh/device/numa_node
  0

	Reviewed-by: David Strahan <david.strahan@microchip.com>
	Reviewed-by: Mike McGowen <mike.mcgowen@microchip.com>
	Reviewed-by: Kevin Barnett <kevin.barnett@microchip.com>
	Signed-off-by: Don Brace <don.brace@microchip.com>
Link: https://lore.kernel.org/r/20230428153712.297638-11-don.brace@microchip.com
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit d2c7583f27cc138354a1cd3c990923de7fd2126a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/smartpqi/smartpqi_init.c
diff --cc drivers/scsi/smartpqi/smartpqi_init.c
index 9a67f84758ff,ec5506a00cc2..000000000000
--- a/drivers/scsi/smartpqi/smartpqi_init.c
+++ b/drivers/scsi/smartpqi/smartpqi_init.c
@@@ -7323,16 -7337,18 +7335,30 @@@ static DEVICE_ATTR(raid_level, 0444, pq
  static DEVICE_ATTR(raid_bypass_cnt, 0444, pqi_raid_bypass_cnt_show, NULL);
  static DEVICE_ATTR(sas_ncq_prio_enable, 0644,
  		pqi_sas_ncq_prio_enable_show, pqi_sas_ncq_prio_enable_store);
+ static DEVICE_ATTR(numa_node, 0444, pqi_numa_node_show, NULL);
  
++<<<<<<< HEAD
 +static struct device_attribute *pqi_sdev_attrs[] = {
 +	&dev_attr_lunid,
 +	&dev_attr_unique_id,
 +	&dev_attr_path_info,
 +	&dev_attr_sas_address,
 +	&dev_attr_ssd_smart_path_enabled,
 +	&dev_attr_raid_level,
 +	&dev_attr_raid_bypass_cnt,
 +	&dev_attr_sas_ncq_prio_enable,
++=======
+ static struct attribute *pqi_sdev_attrs[] = {
+ 	&dev_attr_lunid.attr,
+ 	&dev_attr_unique_id.attr,
+ 	&dev_attr_path_info.attr,
+ 	&dev_attr_sas_address.attr,
+ 	&dev_attr_ssd_smart_path_enabled.attr,
+ 	&dev_attr_raid_level.attr,
+ 	&dev_attr_raid_bypass_cnt.attr,
+ 	&dev_attr_sas_ncq_prio_enable.attr,
+ 	&dev_attr_numa_node.attr,
++>>>>>>> d2c7583f27cc (scsi: smartpqi: Add sysfs entry for NUMA node in /sys/block/sdX/device)
  	NULL
  };
  
diff --git a/drivers/scsi/smartpqi/smartpqi.h b/drivers/scsi/smartpqi/smartpqi.h
index 5ca1a54a5a24..f139ff92fbbf 100644
--- a/drivers/scsi/smartpqi/smartpqi.h
+++ b/drivers/scsi/smartpqi/smartpqi.h
@@ -1358,6 +1358,7 @@ struct pqi_ctrl_info {
 	u32		max_write_raid_5_6;
 	u32		max_write_raid_1_10_2drive;
 	u32		max_write_raid_1_10_3drive;
+	int		numa_node;
 
 	struct list_head scsi_device_list;
 	spinlock_t	scsi_device_list_lock;
* Unmerged path drivers/scsi/smartpqi/smartpqi_init.c
