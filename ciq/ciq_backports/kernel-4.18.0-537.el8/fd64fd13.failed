net/mlx5: Decouple PHC .adjtime and .adjphase implementations

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-537.el8
commit-author Rahul Rameshbabu <rrameshbabu@nvidia.com>
commit fd64fd13c49a53012ce9170449dcd9eb71c11284
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-537.el8/fd64fd13.failed

When running a phase adjustment operation, the free running clock should
not be modified at all. The phase control keyword is intended to trigger an
internal servo on the device that will converge to the provided delta. A
free running counter cannot implement phase adjustment.

Fixes: 8e11a68e2e8a ("net/mlx5: Add adjphase function to support hardware-only offset control")
	Signed-off-by: Rahul Rameshbabu <rrameshbabu@nvidia.com>
	Reviewed-by: Tariq Toukan <tariqt@nvidia.com>
	Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
Link: https://lore.kernel.org/r/20231114215846.5902-5-saeed@kernel.org
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit fd64fd13c49a53012ce9170449dcd9eb71c11284)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
index 66dadd6c5182,0c83ef174275..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
@@@ -361,10 -389,7 +361,14 @@@ static int mlx5_ptp_adjphase(struct ptp
  
  	mdev = container_of(clock, struct mlx5_core_dev, clock);
  
++<<<<<<< HEAD
 +	if (!mlx5_is_mtutc_time_adj_cap(mdev, delta))
 +		return -ERANGE;
 +
 +	return mlx5_ptp_adjtime(ptp, delta);
++=======
+ 	return mlx5_ptp_adjtime_real_time(mdev, delta);
++>>>>>>> fd64fd13c49a (net/mlx5: Decouple PHC .adjtime and .adjphase implementations)
  }
  
  static int mlx5_ptp_freq_adj_real_time(struct mlx5_core_dev *mdev, long scaled_ppm)
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
