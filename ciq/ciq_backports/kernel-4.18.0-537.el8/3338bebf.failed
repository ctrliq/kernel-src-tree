net/mlx5: Increase size of irq name buffer

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-537.el8
commit-author Rahul Rameshbabu <rrameshbabu@nvidia.com>
commit 3338bebfc26a1e2cebbba82a1cf12c0159608e73
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-537.el8/3338bebf.failed

Without increased buffer size, will trigger -Wformat-truncation with W=1
for the snprintf operation writing to the buffer.

    drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c: In function 'mlx5_irq_alloc':
    drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c:296:7: error: '@pci:' directive output may be truncated writing 5 bytes into a region of size between 1 and 32 [-Werror=format-truncation=]
      296 |    "%s@pci:%s", name, pci_name(dev->pdev));
          |       ^~~~~
    drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c:295:2: note: 'snprintf' output 6 or more bytes (assuming 37) into a destination of size 32
      295 |  snprintf(irq->name, MLX5_MAX_IRQ_NAME,
          |  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      296 |    "%s@pci:%s", name, pci_name(dev->pdev));
          |    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Fixes: ada9f5d00797 ("IB/mlx5: Fix eq names to display nicely in /proc/interrupts")
Link: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6d4ab2e97dcfbcd748ae71761a9d8e5e41cc732c
	Signed-off-by: Rahul Rameshbabu <rrameshbabu@nvidia.com>
	Reviewed-by: Dragos Tatulea <dtatulea@nvidia.com>
	Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
Link: https://lore.kernel.org/r/20231114215846.5902-13-saeed@kernel.org
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 3338bebfc26a1e2cebbba82a1cf12c0159608e73)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c
index 75dab94f4c94,4dcf995cb1a2..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c
@@@ -25,11 -28,11 +25,11 @@@
  struct mlx5_irq {
  	struct atomic_notifier_head nh;
  	cpumask_var_t mask;
- 	char name[MLX5_MAX_IRQ_NAME];
+ 	char name[MLX5_MAX_IRQ_FORMATTED_NAME];
  	struct mlx5_irq_pool *pool;
  	int refcount;
 -	struct msi_map map;
 -	u32 pool_index;
 +	u32 index;
 +	int irqn;
  };
  
  struct mlx5_irq_table {
@@@ -222,9 -292,9 +222,15 @@@ struct mlx5_irq *mlx5_irq_alloc(struct 
  	else
  		irq_sf_set_name(pool, name, i);
  	ATOMIC_INIT_NOTIFIER_HEAD(&irq->nh);
++<<<<<<< HEAD
 +	snprintf(irq->name, MLX5_MAX_IRQ_NAME,
 +		 "%s@pci:%s", name, pci_name(dev->pdev));
 +	err = request_irq(irq->irqn, irq_int_handler, 0, irq->name,
++=======
+ 	snprintf(irq->name, MLX5_MAX_IRQ_FORMATTED_NAME,
+ 		 MLX5_IRQ_NAME_FORMAT_STR, name, pci_name(dev->pdev));
+ 	err = request_irq(irq->map.virq, irq_int_handler, 0, irq->name,
++>>>>>>> 3338bebfc26a (net/mlx5: Increase size of irq name buffer)
  			  &irq->nh);
  	if (err) {
  		mlx5_core_err(dev, "Failed to request irq. err = %d\n", err);
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/pci_irq.c
diff --git a/drivers/net/ethernet/mellanox/mlx5/core/pci_irq.h b/drivers/net/ethernet/mellanox/mlx5/core/pci_irq.h
index 5c7e68bee43a..4047179307c4 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/pci_irq.h
+++ b/drivers/net/ethernet/mellanox/mlx5/core/pci_irq.h
@@ -7,6 +7,9 @@
 #include <linux/mlx5/driver.h>
 
 #define MLX5_MAX_IRQ_NAME (32)
+#define MLX5_IRQ_NAME_FORMAT_STR ("%s@pci:%s")
+#define MLX5_MAX_IRQ_FORMATTED_NAME \
+	(MLX5_MAX_IRQ_NAME + sizeof(MLX5_IRQ_NAME_FORMAT_STR))
 /* max irq_index is 2047, so four chars */
 #define MLX5_MAX_IRQ_IDX_CHARS (4)
 #define MLX5_EQ_REFS_PER_IRQ (2)
