ASoC: rt5682: Fix crash due to out of scope stack vars

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Rob Clark <robdclark@chromium.org>
commit 4999d703c0e66f9f196b6edc0b8fdeca8846b8b6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/4999d703.failed

Move the declaration of temporary arrays to somewhere that won't go out
of scope before the devm_clk_hw_register() call, lest we be at the whim
of the compiler for whether those stack variables get overwritten.

Fixes a crash seen with gcc version 11.2.1 20210728 (Red Hat 11.2.1-1)

Fixes: edbd24ea1e5c ("ASoC: rt5682: Drop usage of __clk_get_name()")
	Signed-off-by: Rob Clark <robdclark@chromium.org>
	Reviewed-by: Stephen Boyd <swboyd@chromium.org>
Link: https://lore.kernel.org/r/20211118010453.843286-1-robdclark@gmail.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 4999d703c0e66f9f196b6edc0b8fdeca8846b8b6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/codecs/rt5682.c
diff --cc sound/soc/codecs/rt5682.c
index b7793ac1d9f7,5224123d0d3b..000000000000
--- a/sound/soc/codecs/rt5682.c
+++ b/sound/soc/codecs/rt5682.c
@@@ -2857,25 -2857,27 +2857,44 @@@ static int rt5682_register_dai_clks(str
  	int i, ret;
  
  	for (i = 0; i < RT5682_DAI_NUM_CLKS; ++i) {
++<<<<<<< HEAD
++=======
+ 		struct clk_init_data init = { };
+ 		struct clk_parent_data parent_data;
+ 		const struct clk_hw *parent;
+ 
++>>>>>>> 4999d703c0e6 (ASoC: rt5682: Fix crash due to out of scope stack vars)
  		dai_clk_hw = &rt5682->dai_clks_hw[i];
  
  		switch (i) {
  		case RT5682_DAI_WCLK_IDX:
  			/* Make MCLK the parent of WCLK */
  			if (rt5682->mclk) {
++<<<<<<< HEAD
 +				parent_name = __clk_get_name(rt5682->mclk);
 +				init.parent_names = &parent_name;
++=======
+ 				parent_data = (struct clk_parent_data){
+ 					.fw_name = "mclk",
+ 				};
+ 				init.parent_data = &parent_data;
++>>>>>>> 4999d703c0e6 (ASoC: rt5682: Fix crash due to out of scope stack vars)
  				init.num_parents = 1;
 +			} else {
 +				init.parent_names = NULL;
 +				init.num_parents = 0;
  			}
  			break;
  		case RT5682_DAI_BCLK_IDX:
  			/* Make WCLK the parent of BCLK */
++<<<<<<< HEAD
 +			parent_name = __clk_get_name(
 +				rt5682->dai_clks[RT5682_DAI_WCLK_IDX]);
 +			init.parent_names = &parent_name;
++=======
+ 			parent = &rt5682->dai_clks_hw[RT5682_DAI_WCLK_IDX];
+ 			init.parent_hws = &parent;
++>>>>>>> 4999d703c0e6 (ASoC: rt5682: Fix crash due to out of scope stack vars)
  			init.num_parents = 1;
  			break;
  		default:
* Unmerged path sound/soc/codecs/rt5682.c
