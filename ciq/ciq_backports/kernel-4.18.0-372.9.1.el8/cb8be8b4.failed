driver core: platform: Drop of_device_node_put() wrapper

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Rob Herring <robh@kernel.org>
commit cb8be8b4b27f6eea88268d6991175df1a27e557e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/cb8be8b4.failed

of_device_node_put() is just a wrapper for of_node_put(). The platform
driver core is already polluted with of_node pointers and the only 'get'
already uses of_node_get() (though typically the get would happen in
of_device_alloc()).

	Cc: "Rafael J. Wysocki" <rafael@kernel.org>
	Cc: Frank Rowand <frowand.list@gmail.com>
	Signed-off-by: Rob Herring <robh@kernel.org>
	Reviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Link: https://lore.kernel.org/r/20210211232745.1498137-3-robh@kernel.org
(cherry picked from commit cb8be8b4b27f6eea88268d6991175df1a27e557e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/of_device.h
diff --cc include/linux/of_device.h
index 07ca187fc5e4,1d7992a02e36..000000000000
--- a/include/linux/of_device.h
+++ b/include/linux/of_device.h
@@@ -97,9 -89,7 +92,13 @@@ static inline int of_device_uevent_moda
  	return -ENODEV;
  }
  
++<<<<<<< HEAD
 +static inline void of_device_node_put(struct device *dev) { }
 +
 +static inline const struct of_device_id *__of_match_device(
++=======
+ static inline const struct of_device_id *of_match_device(
++>>>>>>> cb8be8b4b27f (driver core: platform: Drop of_device_node_put() wrapper)
  		const struct of_device_id *matches, const struct device *dev)
  {
  	return NULL;
diff --git a/drivers/base/platform.c b/drivers/base/platform.c
index 08d99bdbfa6d..5808aa7eecf0 100644
--- a/drivers/base/platform.c
+++ b/drivers/base/platform.c
@@ -480,7 +480,7 @@ static void platform_device_release(struct device *dev)
 	struct platform_object *pa = container_of(dev, struct platform_object,
 						  pdev.dev);
 
-	of_device_node_put(&pa->pdev.dev);
+	of_node_put(pa->pdev.dev.of_node);
 	kfree(pa->pdev.dev.platform_data);
 	kfree(pa->pdev.mfd_cell);
 	kfree(pa->pdev.resource);
* Unmerged path include/linux/of_device.h
