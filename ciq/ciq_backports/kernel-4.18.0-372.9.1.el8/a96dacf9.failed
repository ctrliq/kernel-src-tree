arm64: take fetching compat reg out of pt_regs into a new helper

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Al Viro <viro@zeniv.linux.org.uk>
commit a96dacf98884151f6a738a98aab50f35391455ca
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/a96dacf9.failed

	Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
(cherry picked from commit a96dacf98884151f6a738a98aab50f35391455ca)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/arm64/kernel/ptrace.c
diff --cc arch/arm64/kernel/ptrace.c
index 75b1a69a377c,5b837741ab76..000000000000
--- a/arch/arm64/kernel/ptrace.c
+++ b/arch/arm64/kernel/ptrace.c
@@@ -1253,22 -1271,7 +1269,26 @@@ static int compat_gpr_get(struct task_s
  		return -EIO;
  
  	for (i = 0; i < num_regs; ++i) {
++<<<<<<< HEAD
 +		unsigned int idx = start + i;
 +		compat_ulong_t reg;
 +
 +		switch (idx) {
 +		case 15:
 +			reg = task_pt_regs(target)->pc;
 +			break;
 +		case 16:
 +			reg = task_pt_regs(target)->pstate;
 +			break;
 +		case 17:
 +			reg = task_pt_regs(target)->orig_x0;
 +			break;
 +		default:
 +			reg = task_pt_regs(target)->regs[idx];
 +		}
++=======
+ 		compat_ulong_t reg = compat_get_user_reg(target, start + i);
++>>>>>>> a96dacf98884 (arm64: take fetching compat reg out of pt_regs into a new helper)
  
  		if (kbuf) {
  			memcpy(kbuf, &reg, sizeof(reg));
* Unmerged path arch/arm64/kernel/ptrace.c
