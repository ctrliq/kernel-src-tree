memremap: rename MEMORY_DEVICE_DEVDAX to MEMORY_DEVICE_GENERIC

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Roger Pau Monne <roger.pau@citrix.com>
commit 4533d3aed857c558d6aabd00d0cb04100c5a2258
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/4533d3ae.failed

This is in preparation for the logic behind MEMORY_DEVICE_DEVDAX also
being used by non DAX devices.

No functional change intended.

	Signed-off-by: Roger Pau Monn√© <roger.pau@citrix.com>
	Reviewed-by: Ira Weiny <ira.weiny@intel.com>
	Acked-by: Andrew Morton <akpm@linux-foundation.org>
	Reviewed-by: Pankaj Gupta <pankaj.gupta.linux@gmail.com>
Link: https://lore.kernel.org/r/20200901083326.21264-3-roger.pau@citrix.com
	Signed-off-by: Juergen Gross <jgross@suse.com>
(cherry picked from commit 4533d3aed857c558d6aabd00d0cb04100c5a2258)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/memremap.h
diff --cc include/linux/memremap.h
index ecd38ce53a36,e5862746751b..000000000000
--- a/include/linux/memremap.h
+++ b/include/linux/memremap.h
@@@ -67,20 -58,11 +66,24 @@@ struct vmem_altmap 
  enum memory_type {
  	/* 0 is reserved to catch uninitialized type fields */
  	MEMORY_DEVICE_PRIVATE = 1,
 +	MEMORY_DEVICE_PUBLIC,
  	MEMORY_DEVICE_FS_DAX,
++<<<<<<< HEAD
++=======
+ 	MEMORY_DEVICE_GENERIC,
++>>>>>>> 4533d3aed857 (memremap: rename MEMORY_DEVICE_DEVDAX to MEMORY_DEVICE_GENERIC)
  	MEMORY_DEVICE_PCI_P2PDMA,
 +#ifndef __GENKSYMS__
 +	MEMORY_DEVICE_DEVDAX,
 +#endif /* __GENKSYMS__ */
  };
  
 +typedef int (*dev_page_fault_t)(struct vm_area_struct *vma,
 +				unsigned long addr,
 +				const struct page *page,
 +				unsigned int flags,
 +				pmd_t *pmdp);
 +typedef void (*dev_page_free_t)(struct page *page, void *data);
  struct dev_pagemap_ops {
  	/*
  	 * Called once the page refcount reaches 1.  (ZONE_DEVICE pages never
diff --git a/drivers/dax/device.c b/drivers/dax/device.c
index 1af823b2fe6b..d402d7e794e0 100644
--- a/drivers/dax/device.c
+++ b/drivers/dax/device.c
@@ -428,7 +428,7 @@ int dev_dax_probe(struct device *dev)
 		return -EBUSY;
 	}
 
-	dev_dax->pgmap.type = MEMORY_DEVICE_DEVDAX;
+	dev_dax->pgmap.type = MEMORY_DEVICE_GENERIC;
 	addr = devm_memremap_pages(dev, &dev_dax->pgmap);
 	if (IS_ERR(addr))
 		return PTR_ERR(addr);
* Unmerged path include/linux/memremap.h
diff --git a/mm/memremap.c b/mm/memremap.c
index 6bc3fa8cccb8..178a1f3aa887 100644
--- a/mm/memremap.c
+++ b/mm/memremap.c
@@ -216,7 +216,7 @@ void *memremap_pages(struct dev_pagemap *pgmap, int nid)
 			return ERR_PTR(-EINVAL);
 		}
 		break;
-	case MEMORY_DEVICE_DEVDAX:
+	case MEMORY_DEVICE_GENERIC:
 		need_devmap_managed = false;
 		break;
 	case MEMORY_DEVICE_PCI_P2PDMA:
