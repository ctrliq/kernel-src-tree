ALSA: cmi8328: Allocate resources with device-managed APIs

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Takashi Iwai <tiwai@suse.de>
commit d9fd7397a70e201800307f83eb3941f4d28fef81
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/d9fd7397.failed

This patch converts the resource management in ISA cmi8328 driver with
devres as a clean up.  Each manual resource management is converted
with the corresponding devres helper.

This should give no user-visible functional changes.

Link: https://lore.kernel.org/r/20210715075941.23332-60-tiwai@suse.de
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit d9fd7397a70e201800307f83eb3941f4d28fef81)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/isa/cmi8328.c
diff --cc sound/isa/cmi8328.c
index faca5dd95bfe,8902cfb830f7..000000000000
--- a/sound/isa/cmi8328.c
+++ b/sound/isa/cmi8328.c
@@@ -397,13 -394,9 +394,9 @@@ static int snd_cmi8328_probe(struct dev
  	}
  #endif
  	return 0;
- error:
- 	snd_card_free(card);
- 
- 	return err;
  }
  
 -static void snd_cmi8328_remove(struct device *pdev, unsigned int dev)
 +static int snd_cmi8328_remove(struct device *pdev, unsigned int dev)
  {
  	struct snd_card *card = dev_get_drvdata(pdev);
  	struct snd_cmi8328 *cmi = card->private_data;
@@@ -419,8 -409,6 +409,11 @@@
  	snd_cmi8328_cfg_write(cmi->port, CFG1, CFG1_SB_DISABLE);
  	snd_cmi8328_cfg_write(cmi->port, CFG2, 0);
  	snd_cmi8328_cfg_write(cmi->port, CFG3, 0);
++<<<<<<< HEAD
 +	snd_card_free(card);
 +	return 0;
++=======
++>>>>>>> d9fd7397a70e (ALSA: cmi8328: Allocate resources with device-managed APIs)
  }
  
  #ifdef CONFIG_PM
* Unmerged path sound/isa/cmi8328.c
