net/mlx5e: Remove lro_param from mlx5e_build_indir_tir_ctx_common()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Maxim Mikityanskiy <maximmi@nvidia.com>
commit a402e3a7470d4c6b7792552e1a510ce72fda9f3e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/a402e3a7.failed

In order to reduce the list of parameters and to define clearer
responsibility for mlx5e_build_indir_tir_ctx_common(), stop passing
lro_param and instead call mlx5e_build_tir_ctx_lro() directly where
needed.

	Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
	Reviewed-by: Tariq Toukan <tariqt@nvidia.com>
	Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
(cherry picked from commit a402e3a7470d4c6b7792552e1a510ce72fda9f3e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_main.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index 15e30d82e985,69a4a9336615..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@@ -3182,30 -3129,23 +3182,44 @@@ static void mlx5e_cleanup_nic_tx(struc
  	mlx5e_destroy_tises(priv);
  }
  
++<<<<<<< HEAD
 +static void mlx5e_build_indir_tir_ctx_common(struct mlx5e_priv *priv,
++=======
+ static void mlx5e_build_indir_tir_ctx_common(struct mlx5_core_dev *mdev,
+ 					     bool inner_ft_support,
++>>>>>>> a402e3a7470d (net/mlx5e: Remove lro_param from mlx5e_build_indir_tir_ctx_common())
  					     u32 rqtn, u32 *tirc)
  {
 -	MLX5_SET(tirc, tirc, transport_domain, mdev->mlx5e_res.hw_objs.td.tdn);
 +	MLX5_SET(tirc, tirc, transport_domain, priv->mdev->mlx5e_res.hw_objs.td.tdn);
  	MLX5_SET(tirc, tirc, disp_type, MLX5_TIRC_DISP_TYPE_INDIRECT);
  	MLX5_SET(tirc, tirc, indirect_table, rqtn);
++<<<<<<< HEAD
 +	MLX5_SET(tirc, tirc, tunneled_offload_en,
 +		 priv->channels.params.tunneled_offload_en);
 +
 +	mlx5e_build_tir_ctx_lro(&priv->channels.params, tirc);
++=======
+ 	MLX5_SET(tirc, tirc, tunneled_offload_en, inner_ft_support);
++>>>>>>> a402e3a7470d (net/mlx5e: Remove lro_param from mlx5e_build_indir_tir_ctx_common())
 +}
 +
 +static void mlx5e_build_indir_tir_ctx(struct mlx5e_priv *priv,
 +				      enum mlx5e_traffic_types tt,
 +				      u32 *tirc)
 +{
++<<<<<<< HEAD
 +	mlx5e_build_indir_tir_ctx_common(priv, priv->indir_rqt.rqtn, tirc);
 +	mlx5e_build_indir_tir_ctx_hash(&priv->rss_params,
 +				       &tirc_default_config[tt], tirc, false);
  }
  
 -static void mlx5e_build_direct_tir_ctx(struct mlx5_core_dev *mdev,
 -				       struct mlx5e_lro_param *lro_param,
 -				       bool inner_ft_support,
 -				       u32 rqtn, u32 *tirc)
 +static void mlx5e_build_direct_tir_ctx(struct mlx5e_priv *priv, u32 rqtn, u32 *tirc)
  {
 +	mlx5e_build_indir_tir_ctx_common(priv, rqtn, tirc);
++=======
+ 	mlx5e_build_indir_tir_ctx_common(mdev, inner_ft_support, rqtn, tirc);
+ 	mlx5e_build_tir_ctx_lro(lro_param, tirc);
++>>>>>>> a402e3a7470d (net/mlx5e: Remove lro_param from mlx5e_build_indir_tir_ctx_common())
  	MLX5_SET(tirc, tirc, rx_hash_fn, MLX5_RX_HASH_FN_INVERTED_XOR8);
  }
  
@@@ -3233,11 -3167,20 +3247,21 @@@ int mlx5e_create_indirect_tirs(struct m
  	if (!in)
  		return -ENOMEM;
  
 -	lro_param = mlx5e_get_lro_param(&priv->channels.params);
 -	indir_rqtn = mlx5e_rqt_get_rqtn(&priv->rx_res->indir_rqt);
 -
  	for (tt = 0; tt < MLX5E_NUM_INDIR_TIRS; tt++) {
  		memset(in, 0, inlen);
 -		tir = &res->rss[tt].indir_tir;
 +		tir = &priv->indir_tir[tt];
  		tirc = MLX5_ADDR_OF(create_tir_in, in, ctx);
++<<<<<<< HEAD
 +		mlx5e_build_indir_tir_ctx(priv, tt, tirc);
++=======
+ 		mlx5e_build_indir_tir_ctx_common(priv->mdev,
+ 						 priv->channels.params.tunneled_offload_en,
+ 						 indir_rqtn, tirc);
+ 		mlx5e_build_tir_ctx_lro(&lro_param, tirc);
+ 		mlx5e_build_indir_tir_ctx_hash(&priv->rx_res->rss_params,
+ 					       &tirc_default_config[tt], tirc, false);
+ 
++>>>>>>> a402e3a7470d (net/mlx5e: Remove lro_param from mlx5e_build_indir_tir_ctx_common())
  		err = mlx5e_create_tir(priv->mdev, tir, in);
  		if (err) {
  			mlx5_core_warn(priv->mdev, "create indirect tirs failed, %d\n", err);
@@@ -3250,9 -3193,14 +3274,18 @@@
  
  	for (i = 0; i < MLX5E_NUM_INDIR_TIRS; i++) {
  		memset(in, 0, inlen);
 -		tir = &res->rss[i].inner_indir_tir;
 +		tir = &priv->inner_indir_tir[i];
  		tirc = MLX5_ADDR_OF(create_tir_in, in, ctx);
++<<<<<<< HEAD
 +		mlx5e_build_inner_indir_tir_ctx(priv, i, tirc);
++=======
+ 		mlx5e_build_indir_tir_ctx_common(priv->mdev,
+ 						 priv->channels.params.tunneled_offload_en,
+ 						 indir_rqtn, tirc);
+ 		mlx5e_build_tir_ctx_lro(&lro_param, tirc);
+ 		mlx5e_build_indir_tir_ctx_hash(&priv->rx_res->rss_params,
+ 					       &tirc_default_config[i], tirc, true);
++>>>>>>> a402e3a7470d (net/mlx5e: Remove lro_param from mlx5e_build_indir_tir_ctx_common())
  		err = mlx5e_create_tir(priv->mdev, tir, in);
  		if (err) {
  			mlx5_core_warn(priv->mdev, "create inner indirect tirs failed, %d\n", err);
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_main.c
