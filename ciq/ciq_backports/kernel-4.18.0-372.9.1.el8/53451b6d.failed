ALSA: usb-audio: Less restriction for low-latency playback mode

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Takashi Iwai <tiwai@suse.de>
commit 53451b6da8271905941eb1eb369db152c4bd92f2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/53451b6d.failed

The recent support for the improved low-latency playback mode applied
the SNDRV_PCM_INFO_EXPLICIT_SYNC flag for the target streams, but this
was a slight overkill.  The use of the flag above disables effectively
both PCM status and control mmaps, while basically what we want to
track is only about the appl_ptr update.

For less restriction, use a more proper flag,
SNDRV_PCM_INFO_SYNC_APPLPTR instead, which disables only the control
mmap.

Fixes: d5f871f89e21 ("ALSA: usb-audio: Improved lowlatency playback support")
Link: https://lore.kernel.org/r/20211011103650.10182-1-tiwai@suse.de
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 53451b6da8271905941eb1eb369db152c4bd92f2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/usb/pcm.c
diff --cc sound/usb/pcm.c
index bb6ca8e81598,95ec8eec1bb0..000000000000
--- a/sound/usb/pcm.c
+++ b/sound/usb/pcm.c
@@@ -1066,6 -1099,10 +1066,13 @@@ static int snd_usb_pcm_open(struct snd_
  	int ret;
  
  	runtime->hw = snd_usb_hardware;
++<<<<<<< HEAD
++=======
+ 	/* need an explicit sync to catch applptr update in low-latency mode */
+ 	if (direction == SNDRV_PCM_STREAM_PLAYBACK &&
+ 	    as->chip->lowlatency)
+ 		runtime->hw.info |= SNDRV_PCM_INFO_SYNC_APPLPTR;
++>>>>>>> 53451b6da827 (ALSA: usb-audio: Less restriction for low-latency playback mode)
  	runtime->private_data = subs;
  	subs->pcm_substream = substream;
  	/* runtime PM is also done there */
* Unmerged path sound/usb/pcm.c
