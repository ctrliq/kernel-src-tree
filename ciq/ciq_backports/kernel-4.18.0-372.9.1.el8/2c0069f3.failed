ice: Fix MAC address setting

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-372.9.1.el8
commit-author Ivan Vecera <ivecera@redhat.com>
commit 2c0069f3f91f125b1b2ce66cc6bea8eb134723c3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.9.1.el8/2c0069f3.failed

Commit 2ccc1c1ccc671b ("ice: Remove excess error variables") merged
the usage of 'status' and 'err' variables into single one in
function ice_set_mac_address(). Unfortunately this causes
a regression when call of ice_fltr_add_mac() returns -EEXIST because
this return value does not indicate an error in this case but
value of 'err' remains to be -EEXIST till the end of the function
and is returned to caller.

Prior mentioned commit this does not happen because return value of
ice_fltr_add_mac() was stored to 'status' variable first and
if it was -EEXIST then 'err' remains to be zero.

Fix the problem by reset 'err' to zero when ice_fltr_add_mac()
returns -EEXIST.

Fixes: 2ccc1c1ccc671b ("ice: Remove excess error variables")
	Signed-off-by: Ivan Vecera <ivecera@redhat.com>
	Reviewed-by: Jacob Keller <jacob.e.keller@intel.com>
	Acked-by: Alexander Lobakin <alexandr.lobakin@intel.com>
	Signed-off-by: Alice Michael <alice.michael@intel.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 2c0069f3f91f125b1b2ce66cc6bea8eb134723c3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/ice/ice_main.c
diff --cc drivers/net/ethernet/intel/ice/ice_main.c
index 117c78a3d4bd,d755ce07869f..000000000000
--- a/drivers/net/ethernet/intel/ice/ice_main.c
+++ b/drivers/net/ethernet/intel/ice/ice_main.c
@@@ -5239,17 -5474,20 +5239,29 @@@ static int ice_set_mac_address(struct n
  	}
  
  	/* Add filter for new MAC. If filter exists, return success */
++<<<<<<< HEAD
 +	status = ice_fltr_add_mac(vsi, mac, ICE_FWD_TO_VSI);
 +	if (status == ICE_ERR_ALREADY_EXISTS)
++=======
+ 	err = ice_fltr_add_mac(vsi, mac, ICE_FWD_TO_VSI);
+ 	if (err == -EEXIST) {
++>>>>>>> 2c0069f3f91f (ice: Fix MAC address setting)
  		/* Although this MAC filter is already present in hardware it's
  		 * possible in some cases (e.g. bonding) that dev_addr was
  		 * modified outside of the driver and needs to be restored back
  		 * to this value.
  		 */
  		netdev_dbg(netdev, "filter for MAC %pM already exists\n", mac);
++<<<<<<< HEAD
 +	else if (status)
++=======
+ 
+ 		return 0;
+ 	} else if (err) {
++>>>>>>> 2c0069f3f91f (ice: Fix MAC address setting)
  		/* error if the new filter addition failed */
  		err = -EADDRNOTAVAIL;
+ 	}
  
  err_update_filters:
  	if (err) {
* Unmerged path drivers/net/ethernet/intel/ice/ice_main.c
