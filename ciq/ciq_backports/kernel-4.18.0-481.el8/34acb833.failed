RDMA/irdma: Validate udata inlen and outlen

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-481.el8
commit-author Shiraz Saleem <shiraz.saleem@intel.com>
commit 34acb833cc83bdea912a160ff99b537e62bb4cf3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-481.el8/34acb833.failed

Currently ib_copy_from_udata and ib_copy_to_udata could underfill
the request and response buffer if the user-space passes an undersized
value for udata->inlen or udata->outlen respectively [1]
This could lead to undesirable behavior.

Zero initing the buffer only goes as far as preventing using the buffer
uninitialized.

Validate udata->inlen and udata->outlen passed from user-space to ensure
they are at least the required minimum size.

[1] https://lore.kernel.org/linux-rdma/MWHPR11MB0029F37D40D9D4A993F8F549E9D79@MWHPR11MB0029.namprd11.prod.outlook.com/

Fixes: b48c24c2d710 ("RDMA/irdma: Implement device supported verb APIs")
	Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
	Signed-off-by: Shiraz Saleem <shiraz.saleem@intel.com>
Link: https://lore.kernel.org/r/20220907191324.1173-3-shiraz.saleem@intel.com
	Signed-off-by: Leon Romanovsky <leon@kernel.org>
(cherry picked from commit 34acb833cc83bdea912a160ff99b537e62bb4cf3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/irdma/verbs.c
diff --cc drivers/infiniband/hw/irdma/verbs.c
index 1723ca349510,ba403cc25aa9..000000000000
--- a/drivers/infiniband/hw/irdma/verbs.c
+++ b/drivers/infiniband/hw/irdma/verbs.c
@@@ -2734,7 -2806,10 +2780,14 @@@ static struct ib_mr *irdma_reg_user_mr(
  	if (len > iwdev->rf->sc_dev.hw_attrs.max_mr_size)
  		return ERR_PTR(-EINVAL);
  
++<<<<<<< HEAD
 +	region = ib_umem_get(udata, start, len, access);
++=======
+ 	if (udata->inlen < IRDMA_MEM_REG_MIN_REQ_LEN)
+ 		return ERR_PTR(-EINVAL);
+ 
+ 	region = ib_umem_get(pd->device, start, len, access);
++>>>>>>> 34acb833cc83 (RDMA/irdma: Validate udata inlen and outlen)
  
  	if (IS_ERR(region)) {
  		ibdev_dbg(&iwdev->ibdev,
* Unmerged path drivers/infiniband/hw/irdma/verbs.c
