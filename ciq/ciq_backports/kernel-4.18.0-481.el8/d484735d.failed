net: virtio: switch to netif_napi_add_weight()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-481.el8
commit-author Jakub Kicinski <kuba@kernel.org>
commit d484735dcf923e7872d5e353aacfaa4f42dea1d4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-481.el8/d484735d.failed

virtio netdev driver uses a custom napi weight, switch to the new
API for setting custom weight.

	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
	Reviewed-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
	Acked-by: Jason Wang <jasowang@redhat.com>
	Acked-by: Michael S. Tsirkin <mst@redhat.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit d484735dcf923e7872d5e353aacfaa4f42dea1d4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/virtio_net.c
diff --cc drivers/net/virtio_net.c
index 21f7c211dc16,db05b5e930be..000000000000
--- a/drivers/net/virtio_net.c
+++ b/drivers/net/virtio_net.c
@@@ -2900,10 -3313,11 +2900,18 @@@ static int virtnet_alloc_queues(struct 
  	INIT_DELAYED_WORK(&vi->refill, refill_work);
  	for (i = 0; i < vi->max_queue_pairs; i++) {
  		vi->rq[i].pages = NULL;
++<<<<<<< HEAD
 +		netif_napi_add(vi->dev, &vi->rq[i].napi, virtnet_poll,
 +			       napi_weight);
 +		netif_tx_napi_add(vi->dev, &vi->sq[i].napi, virtnet_poll_tx,
 +				  napi_tx ? napi_weight : 0);
++=======
+ 		netif_napi_add_weight(vi->dev, &vi->rq[i].napi, virtnet_poll,
+ 				      napi_weight);
+ 		netif_napi_add_tx_weight(vi->dev, &vi->sq[i].napi,
+ 					 virtnet_poll_tx,
+ 					 napi_tx ? napi_weight : 0);
++>>>>>>> d484735dcf92 (net: virtio: switch to netif_napi_add_weight())
  
  		sg_init_table(vi->rq[i].sg, ARRAY_SIZE(vi->rq[i].sg));
  		ewma_pkt_len_init(&vi->rq[i].mrg_avg_pkt_len);
* Unmerged path drivers/net/virtio_net.c
