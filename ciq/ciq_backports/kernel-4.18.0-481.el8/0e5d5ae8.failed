arm64: Add AMPERE1 to the Spectre-BHB affected list

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-481.el8
commit-author D Scott Phillips <scott@os.amperecomputing.com>
commit 0e5d5ae837c8ce04d2ddb874ec5f920118bd9d31
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-481.el8/0e5d5ae8.failed

Per AmpereOne erratum AC03_CPU_12, "Branch history may allow control of
speculative execution across software contexts," the AMPERE1 core needs the
bhb clearing loop to mitigate Spectre-BHB, with a loop iteration count of
11.

	Signed-off-by: D Scott Phillips <scott@os.amperecomputing.com>
Link: https://lore.kernel.org/r/20221011022140.432370-1-scott@os.amperecomputing.com
	Reviewed-by: James Morse <james.morse@arm.com>
	Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>
(cherry picked from commit 0e5d5ae837c8ce04d2ddb874ec5f920118bd9d31)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/arm64/include/asm/cputype.h
#	arch/arm64/kernel/proton-pack.c
diff --cc arch/arm64/include/asm/cputype.h
index d543694ad9b8,abc418650fec..000000000000
--- a/arch/arm64/include/asm/cputype.h
+++ b/arch/arm64/include/asm/cputype.h
@@@ -70,6 -59,8 +70,11 @@@
  #define ARM_CPU_IMP_NVIDIA		0x4E
  #define ARM_CPU_IMP_FUJITSU		0x46
  #define ARM_CPU_IMP_HISI		0x48
++<<<<<<< HEAD
++=======
+ #define ARM_CPU_IMP_APPLE		0x61
+ #define ARM_CPU_IMP_AMPERE		0xC0
++>>>>>>> 0e5d5ae837c8 (arm64: Add AMPERE1 to the Spectre-BHB affected list)
  
  #define ARM_CPU_PART_AEM_V8		0xD0F
  #define ARM_CPU_PART_FOUNDATION		0xD00
@@@ -117,6 -117,15 +122,18 @@@
  
  #define HISI_CPU_PART_TSV110		0xD01
  
++<<<<<<< HEAD
++=======
+ #define APPLE_CPU_PART_M1_ICESTORM	0x022
+ #define APPLE_CPU_PART_M1_FIRESTORM	0x023
+ #define APPLE_CPU_PART_M1_ICESTORM_PRO	0x024
+ #define APPLE_CPU_PART_M1_FIRESTORM_PRO	0x025
+ #define APPLE_CPU_PART_M1_ICESTORM_MAX	0x028
+ #define APPLE_CPU_PART_M1_FIRESTORM_MAX	0x029
+ 
+ #define AMPERE_CPU_PART_AMPERE1		0xAC3
+ 
++>>>>>>> 0e5d5ae837c8 (arm64: Add AMPERE1 to the Spectre-BHB affected list)
  #define MIDR_CORTEX_A53 MIDR_CPU_MODEL(ARM_CPU_IMP_ARM, ARM_CPU_PART_CORTEX_A53)
  #define MIDR_CORTEX_A57 MIDR_CPU_MODEL(ARM_CPU_IMP_ARM, ARM_CPU_PART_CORTEX_A57)
  #define MIDR_CORTEX_A72 MIDR_CPU_MODEL(ARM_CPU_IMP_ARM, ARM_CPU_PART_CORTEX_A72)
@@@ -152,6 -169,13 +169,16 @@@
  #define MIDR_NVIDIA_CARMEL MIDR_CPU_MODEL(ARM_CPU_IMP_NVIDIA, NVIDIA_CPU_PART_CARMEL)
  #define MIDR_FUJITSU_A64FX MIDR_CPU_MODEL(ARM_CPU_IMP_FUJITSU, FUJITSU_CPU_PART_A64FX)
  #define MIDR_HISI_TSV110 MIDR_CPU_MODEL(ARM_CPU_IMP_HISI, HISI_CPU_PART_TSV110)
++<<<<<<< HEAD
++=======
+ #define MIDR_APPLE_M1_ICESTORM MIDR_CPU_MODEL(ARM_CPU_IMP_APPLE, APPLE_CPU_PART_M1_ICESTORM)
+ #define MIDR_APPLE_M1_FIRESTORM MIDR_CPU_MODEL(ARM_CPU_IMP_APPLE, APPLE_CPU_PART_M1_FIRESTORM)
+ #define MIDR_APPLE_M1_ICESTORM_PRO MIDR_CPU_MODEL(ARM_CPU_IMP_APPLE, APPLE_CPU_PART_M1_ICESTORM_PRO)
+ #define MIDR_APPLE_M1_FIRESTORM_PRO MIDR_CPU_MODEL(ARM_CPU_IMP_APPLE, APPLE_CPU_PART_M1_FIRESTORM_PRO)
+ #define MIDR_APPLE_M1_ICESTORM_MAX MIDR_CPU_MODEL(ARM_CPU_IMP_APPLE, APPLE_CPU_PART_M1_ICESTORM_MAX)
+ #define MIDR_APPLE_M1_FIRESTORM_MAX MIDR_CPU_MODEL(ARM_CPU_IMP_APPLE, APPLE_CPU_PART_M1_FIRESTORM_MAX)
+ #define MIDR_AMPERE1 MIDR_CPU_MODEL(ARM_CPU_IMP_AMPERE, AMPERE_CPU_PART_AMPERE1)
++>>>>>>> 0e5d5ae837c8 (arm64: Add AMPERE1 to the Spectre-BHB affected list)
  
  /* Fujitsu Erratum 010001 affects A64FX 1.0 and 1.1, (v0r0 and v1r0) */
  #define MIDR_FUJITSU_ERRATUM_010001		MIDR_FUJITSU_A64FX
* Unmerged path arch/arm64/kernel/proton-pack.c
* Unmerged path arch/arm64/include/asm/cputype.h
* Unmerged path arch/arm64/kernel/proton-pack.c
