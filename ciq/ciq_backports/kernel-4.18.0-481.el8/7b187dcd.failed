powerpc/bpf: Cleanup bpf_jit.h

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-481.el8
commit-author Naveen N. Rao <naveen.n.rao@linux.vnet.ibm.com>
commit 7b187dcdb5d348aa916dcda769313512c08e85a5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-481.el8/7b187dcd.failed

- PPC_EX32() is only used by ppc32 JIT. Move it to bpf_jit_comp32.c
- PPC_LI64() is only valid in ppc64. #ifdef it
- PPC_FUNC_ADDR() is not used anymore. Remove it.

	Signed-off-by: Naveen N. Rao <naveen.n.rao@linux.vnet.ibm.com>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
Link: https://lore.kernel.org/r/58f5b66b2f8546bbbee620f62103a8e97a63eb7c.1644834730.git.naveen.n.rao@linux.vnet.ibm.com

(cherry picked from commit 7b187dcdb5d348aa916dcda769313512c08e85a5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/net/bpf_jit.h
#	arch/powerpc/net/bpf_jit_comp32.c
diff --cc arch/powerpc/net/bpf_jit.h
index d22140878361,42a9adda31eb..000000000000
--- a/arch/powerpc/net/bpf_jit.h
+++ b/arch/powerpc/net/bpf_jit.h
@@@ -49,6 -59,7 +49,10 @@@
  				EMIT(PPC_RAW_ORI(d, d, IMM_L(i)));	      \
  		} } while(0)
  
++<<<<<<< HEAD
++=======
+ #ifdef CONFIG_PPC64
++>>>>>>> 7b187dcdb5d3 (powerpc/bpf: Cleanup bpf_jit.h)
  #define PPC_LI64(d, i)		do {					      \
  		if ((long)(i) >= -2147483648 &&				      \
  				(long)(i) < 2147483648)			      \
@@@ -71,18 -82,8 +75,13 @@@
  				EMIT(PPC_RAW_ORI(d, d, (uintptr_t)(i) &       \
  							0xffff));             \
  		} } while (0)
- 
- #ifdef CONFIG_PPC64
- #define PPC_FUNC_ADDR(d,i) do { PPC_LI64(d, i); } while(0)
- #else
- #define PPC_FUNC_ADDR(d,i) do { PPC_LI32(d, i); } while(0)
  #endif
  
 +static inline bool is_nearbranch(int offset)
 +{
 +	return (offset < 32768) && (offset >= -32768);
 +}
 +
  /*
   * The fly in the ointment of code size changing from pass to pass is
   * avoided by padding the short branch case with a NOP.	 If code size differs
* Unmerged path arch/powerpc/net/bpf_jit_comp32.c
* Unmerged path arch/powerpc/net/bpf_jit.h
* Unmerged path arch/powerpc/net/bpf_jit_comp32.c
