crypto: s390/aes - drop redundant xts key check

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-481.el8
commit-author Vladis Dronov <vdronov@redhat.com>
commit b6f5278003c4b250f19499a6561d6437b2c94c8e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-481.el8/b6f52780.failed

xts_fallback_setkey() in xts_aes_set_key() will now enforce key size
rule in FIPS mode when setting up the fallback algorithm keys, which
makes the check in xts_aes_set_key() redundant or unreachable. So just
drop this check.

xts_fallback_setkey() now makes a key size check in xts_verify_key():

xts_fallback_setkey()
  crypto_skcipher_setkey() [ skcipher_setkey_unaligned() ]
    cipher->setkey() { .setkey = xts_setkey }
      xts_setkey()
        xts_verify_key()

	Signed-off-by: Vladis Dronov <vdronov@redhat.com>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit b6f5278003c4b250f19499a6561d6437b2c94c8e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/s390/crypto/aes_s390.c
diff --cc arch/s390/crypto/aes_s390.c
index 83d5c2d9e597,c773820e4af9..000000000000
--- a/arch/s390/crypto/aes_s390.c
+++ b/arch/s390/crypto/aes_s390.c
@@@ -515,12 -398,6 +515,15 @@@ static int xts_aes_set_key(struct crypt
  	if (err)
  		return err;
  
++<<<<<<< HEAD
 +	/* In fips mode only 128 bit or 256 bit keys are valid */
 +	if (fips_enabled && key_len != 32 && key_len != 64) {
 +		tfm->crt_flags |= CRYPTO_TFM_RES_BAD_KEY_LEN;
 +		return -EINVAL;
 +	}
 +
++=======
++>>>>>>> b6f5278003c4 (crypto: s390/aes - drop redundant xts key check)
  	/* Pick the correct function code based on the key length */
  	fc = (key_len == 32) ? CPACF_KM_XTS_128 :
  	     (key_len == 64) ? CPACF_KM_XTS_256 : 0;
* Unmerged path arch/s390/crypto/aes_s390.c
