x86/entry: Remove skip_r11rcx

jira LE-1907
cve CVE-2022-23825
cve CVE-2022-29901
cve CVE-2022-29900
cve CVE-2022-23816
Rebuild_History Non-Buildable kernel-4.18.0-372.32.1.el8_6
commit-author Peter Zijlstra <peterz@infradead.org>
commit 1b331eeea7b8676fc5dbdf80d0a07e41be226177
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-372.32.1.el8_6/1b331eee.failed

Yes, r11 and rcx have been restored previously, but since they're being
popped anyway (into rsi) might as well pop them into their own regs --
setting them to the value they already are.

Less magical code.

	Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
	Signed-off-by: Borislav Petkov <bp@suse.de>
Link: https://lore.kernel.org/r/20220506121631.365070674@infradead.org
(cherry picked from commit 1b331eeea7b8676fc5dbdf80d0a07e41be226177)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/entry/calling.h
#	arch/x86/entry/entry_64.S
diff --cc arch/x86/entry/calling.h
index d7bba29aa91d,a97cc78ecb92..000000000000
--- a/arch/x86/entry/calling.h
+++ b/arch/x86/entry/calling.h
@@@ -146,7 -115,12 +146,16 @@@ For 32-bit we have the following conven
  
  .endm
  
++<<<<<<< HEAD
 +.macro POP_REGS pop_rdi=1 skip_r11rcx=0
++=======
+ .macro PUSH_AND_CLEAR_REGS rdx=%rdx rax=%rax save_ret=0
+ 	PUSH_REGS rdx=\rdx, rax=\rax, save_ret=\save_ret
+ 	CLEAR_REGS
+ .endm
+ 
+ .macro POP_REGS pop_rdi=1
++>>>>>>> 1b331eeea7b8 (x86/entry: Remove skip_r11rcx)
  	popq %r15
  	popq %r14
  	popq %r13
diff --cc arch/x86/entry/entry_64.S
index 0d0bf32551bd,3a1e3f215617..000000000000
--- a/arch/x86/entry/entry_64.S
+++ b/arch/x86/entry/entry_64.S
@@@ -215,9 -191,7 +215,13 @@@ SYM_INNER_LABEL(entry_SYSCALL_64_after_
  	 * perf profiles. Nothing jumps here.
  	 */
  syscall_return_via_sysret:
++<<<<<<< HEAD
 +	/* rcx and r11 are already restored (see code above) */
 +	IBRS_EXIT
 +	POP_REGS pop_rdi=0 skip_r11rcx=1
++=======
+ 	POP_REGS pop_rdi=0
++>>>>>>> 1b331eeea7b8 (x86/entry: Remove skip_r11rcx)
  
  	/*
  	 * Now all regs are restored except RSP and RDI.
* Unmerged path arch/x86/entry/calling.h
* Unmerged path arch/x86/entry/entry_64.S
